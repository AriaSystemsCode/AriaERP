//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using DevExpress.ExpressApp.DC;
using DevExpress.Persistent.Base;
using DevExpress.Persistent.BaseImpl;
using DevExpress.Xpo;
using DevExpress.Persistent.Validation;
using DevExpress.ExpressApp.ConditionalAppearance;
using DevExpress.ExpressApp.Editors;
using DevExpress.Data.Filtering;
using System.Collections;
using DevExpress.ExpressApp;
using DevExpress.Persistent.Base.General;
using System.ComponentModel;
namespace Aria5SystemAdmin.Module.BusinessObjects
{
  //ATA
  //,USECASE,TESTCASE,PROJECTENTITY
  //ATA
  /*== #01/01/0001#"*/// [Appearance("ProjectTemplate", AppearanceItemType = "ViewItem", TargetItems = "ProjectTemplate,Application_T", Criteria = "ProjectTemplate!=null", Context = "DetailView", Enabled = false)]
  //ATA to fix error that the object is modified by another user 
  [DefaultClassOptions]
  [XafDefaultProperty("Title")]
  [RelatedEntity("Aria5-SystemAdmin-Requirement")]
  [Appearance("ProjectTemplate", AppearanceItemType = "ViewItem", TargetItems = "RequirementType", Criteria = "Enddate <'@CurrentDate' AND Enddate is not null", Context = "DetailView", Enabled = false)]
  [Appearance("EndDate", AppearanceItemType = "ViewItem", TargetItems = "Enddate", Criteria = "!IsCurrentUserInRole('IterationAdmin')", Context = "DetailView", Enabled = false)]
  [Appearance("RequirementType", AppearanceItemType = "ViewItem", TargetItems = "Needs", Criteria = "RequirementType.Name!='Feature'", Context = "DetailView", Visibility = ViewItemVisibility.Hide)]
  //ATA hide the feature tab if the type of the requirement is feature 3/20/2017[Start]
    [Appearance("Featuretab", AppearanceItemType = "ViewItem", TargetItems = "Features", Criteria = "RequirementType.Name =='Feature'", Context = "DetailView", Visibility = ViewItemVisibility.Hide)]
    //ATA hide the feature tab if the type of the requirement is feature 3/20/2017[End]

  [OptimisticLocking(OptimisticLockingBehavior.NoLocking)]
  public partial class Requirement : DevExpress.Persistent.BaseImpl.BaseObject, ISupportNotifications
  {
    private System.String _newProperty;
    private System.String _proposalSolution;
    private Aria5SystemAdmin.Module.BusinessObjects.Requirement _needs;
    private Aria5SystemAdmin.Module.BusinessObjects.QAUseCase _qAUseCase;
    private Aria5SystemAdmin.Module.BusinessObjects.QAProjectEntity _qAProjectEntity;
    private Aria5SystemAdmin.Module.BusinessObjects.Application_T _application_T;
    private Moscow? _requirementMoscow;
    private RequirmentsStatus? _requirementStatus;
    private Priority? _requirementPriorty;
    private Aria5SystemAdmin.Module.BusinessObjects.ProjectTemplate _projectTemplate;
    private Aria5SystemAdmin.Module.BusinessObjects.RequirementType _requirementType;
    //ATA , 1 , 4/5/2016 [start]
    private Account _account;
    //ATA , 1 , 4/5/2016 [end]
    private System.String _description;
    private System.String _title;
    private System.String _refrence;
    /*ATA ,1,23/3/2016, Baselineflag , add new property  to calcuate end date,[start] 
    */private System.DateTime _enddate;
    //[NonPersistent]
    //[DevExpress.Persistent.Base.VisibleInDetailViewAttribute(false)]
    //[DevExpress.Persistent.Base.VisibleInListViewAttribute(false)]
    //[DevExpress.Persistent.Base.VisibleInLookupListViewAttribute(false)]
    //public string LoginUser { get; set; }
    /*ATA ,1,23/3/2016, Baselineflag , add new property  to calcuate end date  [end] 
     * 
   *///ATA 10 /5 / 2015 [start]
    private System.Boolean _usecase;
    private System.Boolean _pentity;
    private System.Boolean _tcase;
    // ATA 10/5/2016 [end] 
    public Requirement(DevExpress.Xpo.Session session)
      : base(session)
    {
      //ATA get login user ,14/3/2016
      //LoginUser = SecuritySystem.CurrentUserName.Trim().ToUpper();
       
      //ATA , end 
      //ATA 10/5/2016 [start]
      //today = DateTime.Today;
      //ATA [end]
    }
    [Size(200)]
    public System.String Refrence
    {
      get
      {
        return _refrence;
      }
      set
      {
        SetPropertyValue("Refrence", ref _refrence, value);
      }
    }
    [RuleRequiredField]
    [Size(200)]
    public System.String Title
    {
      get
      {
        return _title;
      }
      set
      {
        SetPropertyValue("Title", ref _title, value);
      }
    }
    [DevExpress.Xpo.SizeAttribute(4000)]
    [RuleRequiredField]
    [DevExpress.Persistent.Base.VisibleInLookupListViewAttribute(false)]
    public System.String Description
    {
      get
      {
        return _description;
      }
      set
      {
        SetPropertyValue("Description", ref _description, value);
      }
    }
    [DevExpress.Xpo.AssociationAttribute("Commentses-Requirement")]
    public XPCollection<Aria5SystemAdmin.Module.BusinessObjects.Comments> Comments
    {
      get
      {
        return GetCollection<Aria5SystemAdmin.Module.BusinessObjects.Comments>("Comments");
      }
    }
    //  [RuleRequiredField]
    [Appearance("Needs", Visibility = ViewItemVisibility.Hide, Criteria = "RequirementType.Name!='Feature'", Context = "DetailView")]
    [DataSourceCriteria("RequirementType.Name!='Feature")]
    [Association("RequirementParen-Childs")]
    public Aria5SystemAdmin.Module.BusinessObjects.Requirement Needs
    {
      get
      {
        return _needs;
      }
      set
      {
        SetPropertyValue("Needs", ref _needs, value);
       //ATA Enhancement in the requirement screen if the req type feature take it's need app and account  3/20/2017[start]
          if (_needs != null)
        {
            this.Application_T = _needs.Application_T;
            this.Account = _needs.Account;
        }
          //ATA Enhancement in the requirement screen if the req type feature take it's need app and account 3/20/2017[End]

      }
    }
    [DevExpress.Xpo.AssociationAttribute("TestCases-Requirement")]
    public XPCollection<Aria5SystemAdmin.Module.BusinessObjects.TestCase> TestCases
    {
      get
      {
        return GetCollection<Aria5SystemAdmin.Module.BusinessObjects.TestCase>("TestCases");
      }
    }
    [ImmediatePostData]
    [RuleRequiredField]
    public Aria5SystemAdmin.Module.BusinessObjects.RequirementType RequirementType
    {
      get
      {
        return _requirementType;
      }
      set
      {
        SetPropertyValue("RequirementType", ref _requirementType, value);
        //if (_requirementType == value)
        //  return;
        //Aria5SystemAdmin.Module.BusinessObjects.RequirementType prevRequirementType = _requirementType;
        //_requirementType = value;
        //if (IsLoading)
        //  return;
        //if (prevRequirementType != null && prevRequirementType.Requirement == this)
        //  prevRequirementType.Requirement = null;
        //if (_requirementType != null)
        //  _requirementType.Requirement = this;
        //OnChanged("RequirementType");
      }
    }
    // [RuleRequiredField]
    [DevExpress.Xpo.AssociationAttribute("Requirements-ProjectTemplate")]
    [DevExpress.Persistent.Base.ImmediatePostDataAttribute]
    public Aria5SystemAdmin.Module.BusinessObjects.ProjectTemplate ProjectTemplate
    {
      get
      {
        if (_projectTemplate != null)
        {
          this.Application_T = _projectTemplate.Application;
          //ATA, 1,23/3/2016,check if _enddate not calculated and it is assign to a project then calculate it according to project type [start]
          if (this._enddate == DateTime.MinValue)
          {
            if (_projectTemplate.Type.ToString() == "Key")
            {
              //this._enddate = CalcEnddate(_projectTemplate.StartDate,2);
              this._enddate = CalcEndate.CalcEnddate(_projectTemplate.StartDate, 2);
            }
            else
            {
              this._enddate = _projectTemplate.EndDate;
            }
          }
          //ATA, 1,23/3/2016,check if _enddate not calculated and it is assign to a project then calculate it according to project type [end]
        }
        return _projectTemplate;
      }
      set
      {
        SetPropertyValue("ProjectTemplate", ref _projectTemplate, value);
      }
    }
    [Association("RequirementParen-Childs")]
    [DataSourceCriteria("RequirementType.Name =='Feature")]
    public XPCollection<Requirement> Features
    {
      get
      {
        return GetCollection<Requirement>("Features");
      }
    }
    //ATA set the default of enum field to be null and required in all iteration screen 1/11/2017 [start]
    [RuleRequiredField]
    public Moscow? RequirementMoscow
    {
      //ATA set the default of enum field to be null and required in all iteration screen 1/11/2017 [End]
      get
      {
        return _requirementMoscow;
      }
      set
      {
        SetPropertyValue("RequirementMoscow", ref _requirementMoscow, value);
      }
    }
    [RuleRequiredField]
    public RequirmentsStatus? RequirementStatus
    {
      get
      {
        return _requirementStatus;
      }
      set
      {
        SetPropertyValue("RequirementStatus", ref _requirementStatus, value);
      }
    }
    private ApproveStatu _approvestatus;
    public ApproveStatu ApproveStatus
    {
      get
      {
        return _approvestatus;
      }
      set
      {
        SetPropertyValue("ApproveStatus", ref _approvestatus, value);
      }
    }
    public enum ApproveStatu
    {
      New,
      Ready
    }
    //ATA set the default of enum field to be null and required in all iteration screen 1/11/2017 [start]
    [RuleRequiredField]
    public Priority? RequirementPriorty
    {
      //ATA set the default of enum field to be null and required in all iteration screen 1/11/2017 [End]
      get
      {
        return _requirementPriorty;
      }
      set
      {
        SetPropertyValue("RequirementPriorty", ref _requirementPriorty, value);
      }
    }
    public enum Moscow
    {
      MustHave,
      ShoudHave,
      CouldHave,
      WouldLiketoHave
    }
    public enum RequirmentsStatus
    {
      New,
      InWork,
      Passed,
      failed,
      canceled // as pr hesham 24-11-2015 add canceled status
      ,
      ClarificationRequired,
      Moved,
      Transfered,
      PartlyPassed
    }
    public enum Priority
    {
      //ATA 8/6/2016 enhancement Attention instead Attension [start]
      Special_Attention,
      Urgent,
      High,
      Meduim,
      Low,
      //ATA 8/6/2016 enhancement Attention instead Attension [end]
    }
    [DevExpress.Xpo.AssociationAttribute("Requirements-Application_T")]
    [DevExpress.Persistent.Base.ImmediatePostDataAttribute]
    [RuleRequiredField]
    public Aria5SystemAdmin.Module.BusinessObjects.Application_T Application_T
    {
      get
      {
        return _application_T;
      }
      set
      {
        SetPropertyValue("Application_T", ref _application_T, value);
      }
    }
    /// <summary>
    /// </summary>
    [DevExpress.Xpo.AssociationAttribute("Requirements-QAProjectEntity")]
    public Aria5SystemAdmin.Module.BusinessObjects.QAProjectEntity _QAProjectEntity
    {
      get
      {
        return _qAProjectEntity;
      }
      set
      {
        SetPropertyValue("QAProjectEntity", ref _qAProjectEntity, value);
      }
    }
    [DevExpress.Xpo.AssociationAttribute("Attachements-Requirement")]
    public XPCollection<Aria5SystemAdmin.Module.BusinessObjects.QAAttachement> Attachements
    {
      get
      {
        return GetCollection<Aria5SystemAdmin.Module.BusinessObjects.QAAttachement>("Attachements");
      }
    }
    [DevExpress.Xpo.AssociationAttribute("QAUseCases-Requirement")]
    [DevExpress.Persistent.Base.ImmediatePostDataAttribute]
    public XPCollection<Aria5SystemAdmin.Module.BusinessObjects.QAUseCase> Usecases
    {
      get
      {
        return GetCollection<Aria5SystemAdmin.Module.BusinessObjects.QAUseCase>("Usecases");
      }
    }
    private XPCollection<AuditDataItemPersistent> changeHistory;
    public XPCollection<AuditDataItemPersistent> ChangeHistory
    {
      get
      {
        if (changeHistory == null)
        {
          changeHistory = AuditedObjectWeakReference.GetAuditTrail(Session, this);
        }
        return changeHistory;
      }
    }
    //ATA as per quality enancement 20/3/2017 [Start]
    private string _seqNum;

    public string SequenceNum
    {
        get { return _seqNum; }
        set { _seqNum = value; }
    }

    [Browsable(false)]
    //ATA as per quality enancement 20/3/2017 [End]
    [DevExpress.Persistent.Base.VisibleInLookupListViewAttribute(false)]
    [DevExpress.Xpo.SizeAttribute(4000)]
     

    public System.String proposalSolution
    {
      get
      {
        return _proposalSolution;
      }
      set
      {
        SetPropertyValue("proposalSolution", ref _proposalSolution, value);
      }
    }
    public System.String NewProperty
    {
      get
      {
        return _newProperty;
      }
      set
      {
        SetPropertyValue("NewProperty", ref _newProperty, value);
      }
    }
    //ATA,1 13/3/2016  [6251] add new property to show each project entities related to each use cases [Start]
    // uses this requirment as it's requirment 
    [DevExpress.Xpo.AssociationAttribute("QAProjectEntities-Requirement")]
    public XPCollection<Aria5SystemAdmin.Module.BusinessObjects.QAProjectEntity> QAProjectEntities
    {
      get
      {
        return GetCollection<Aria5SystemAdmin.Module.BusinessObjects.QAProjectEntity>("QAProjectEntities");
      }
    }
    private XPCollection<Aria5SystemAdmin.Module.BusinessObjects.QAProjectEntity> _ProjectEntities;
    public XPCollection<Aria5SystemAdmin.Module.BusinessObjects.QAProjectEntity> ProjectEntities
    {
      get
      {
        if (this.Usecases.Count > 0)
        {
          //IList collection = new List<QAProjectEntity>();
          // XPCollection collection = new XPCollection(typeof(QAProjectEntity));
          XPCollection<QAProjectEntity> collection = CreateCollection<QAProjectEntity>(ClassInfo.GetMember("QAProjectEntities"));
          // IObjectSpace.creatcollection        
          foreach (QAUseCase usecase in this.Usecases)
          {
            if (usecase != null && usecase.ProjectEntities != null && usecase.ProjectEntities.Count > 0)
            {
              //_QAProjectEntities.Add(usecase.ProjectEntities[0]);
              //bool flag = false;
              //IList<QAProjectEntity> groupofprojectentity = usecase.ProjectEntities;
              foreach (QAProjectEntity new_project in usecase.ProjectEntities)
              {
                if (collection.Contains(new_project) == false)
                {
                  collection.Add(new_project);
                }
                //if (_QAProjectEntities.Contains(new_project) == false)
                //{
                // _QAProjectEntities.Add(new_project);
                //}
              }
            }
          }
          if (collection != null)
          {
            //foreach (QAProjectEntity entity in collection)
            // {
            _ProjectEntities = new XPCollection<QAProjectEntity>(collection);
            // }
          }
          else
          {
            _ProjectEntities = null;
          }
        }
        else
        {
          _ProjectEntities = null;
        }
        return _ProjectEntities;
      }
    }
    //ATA,1 13/3/2016 [6251]add new property to show each project entities related to each use cases [End]
    //ATA ,1,23/3/2016 add new property end date to calculate the edit end date for this usecase [start]
    public System.DateTime Enddate
    {
      get
      {
        return _enddate;
      }
      set
      {
        SetPropertyValue("Enddate", ref _enddate, value);
      }
    }
    //ATA ,1,23/3/2016 add new property end date to calculate the edit end date for this usecase [End]
    //ATA , 1 , 4/5/2016 [start]
    public Account Account
    {
      get
      {
        return _account;
      }
      set
      {
        SetPropertyValue("Account", ref _account, value);
      }
    }
    //ATA , 1 , 4/5/2016 [end]
    //ATA ,iteration 5 [start]
    public System.Boolean USECASE
    {
      get
      {
        return _usecase;
      }
      set
      {
        SetPropertyValue("USECASE", ref _usecase, value);
      }
    }
    public System.Boolean PROJECTENTITY
    {
      get
      {
        return _pentity;
      }
      set
      {
        SetPropertyValue("PROJECTENTITY", ref _pentity, value);
      }
    }
    public System.Boolean TESTCASE
    {
      get
      {
        return _tcase;
      }
      set
      {
        SetPropertyValue("TESTCASE", ref _tcase, value);
      }
    }
    //ATA iteration 5 [end]
    //ATA 14/7/2016 start notification task
    private DateTime? alarmTime;
    [Browsable(false)]
    public DateTime? AlarmTime
    {
      get
      {
        return alarmTime;
      }
      set
      {
        alarmTime = value;
        if (value == null)
        {
          RemindIn = null;
          IsPostponed = false;
        }
      }
    }
    [Browsable(false)]
    public bool IsPostponed { get; set; }
    private string _notificationmessage;
    [Browsable(false)]
    public string NotificationMessage
    {
      get
      {
        return _notificationmessage;
      }
      set
      {
        SetPropertyValue("NotificationMessage", ref _notificationmessage, value);
      }
    }
    [Browsable(false)]
    public TimeSpan? RemindIn { get; set; }
    [Browsable(false)]
    public object UniqueId
    {
      get
      {
        return Oid;
      }
    }
    //ATA 14/7/2016 end 
  }
}
