*       *********************************************************
*       *                                                         
*       * 11/16/2004            ICEDIT.SPR               12:45:49 
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (c) 2004 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This program was automatically generated by GENSCRN.    
*       *                                                         
*       *********************************************************


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       *********************************************************
*       *                                                         
*       *               Windows Window definitions                
*       *                                                         
*       *********************************************************
*

lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
IF NOT WEXIST("icedit") ;   
	OR UPPER(WTITLE("ICEDIT")) == "ICEDIT.PJX";
	OR UPPER(WTITLE("ICEDIT")) == "ICEDIT.SCX";      
	OR UPPER(WTITLE("ICEDIT")) == "ICEDIT.MNX";      
	OR UPPER(WTITLE("ICEDIT")) == "ICEDIT.PRG";
	OR UPPER(WTITLE("ICEDIT")) == "ICEDIT.FRX";
	OR UPPER(WTITLE("ICEDIT")) == "ICEDIT.QPR"      
	DEFINE WINDOW icedit ;
		AT 0.000, 0.000 ;
		SIZE 29.500,78.750 ;
		TITLE "The Average Sales Per Week" ;
		FONT "FoxFont", 9 ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		SYSTEM ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW FNDATION
	MOVE WINDOW icedit CENTER
ENDIF

IF NOT WEXIST("icedit1") ;   
	OR UPPER(WTITLE("ICEDIT1")) == "ICEDIT1.PJX";
	OR UPPER(WTITLE("ICEDIT1")) == "ICEDIT1.SCX";      
	OR UPPER(WTITLE("ICEDIT1")) == "ICEDIT1.MNX";      
	OR UPPER(WTITLE("ICEDIT1")) == "ICEDIT1.PRG";
	OR UPPER(WTITLE("ICEDIT1")) == "ICEDIT1.FRX";
	OR UPPER(WTITLE("ICEDIT1")) == "ICEDIT1.QPR"      
	DEFINE WINDOW icedit1 ;
		AT 0.750, 1.000 ;
		SIZE 4.667,76.625 ;
		FONT "FoxFont", 9 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW ICEDIT
ENDIF

IF NOT WEXIST("icedit2") ;   
	OR UPPER(WTITLE("ICEDIT2")) == "ICEDIT2.PJX";
	OR UPPER(WTITLE("ICEDIT2")) == "ICEDIT2.SCX";      
	OR UPPER(WTITLE("ICEDIT2")) == "ICEDIT2.MNX";      
	OR UPPER(WTITLE("ICEDIT2")) == "ICEDIT2.PRG";
	OR UPPER(WTITLE("ICEDIT2")) == "ICEDIT2.FRX";
	OR UPPER(WTITLE("ICEDIT2")) == "ICEDIT2.QPR"      
	DEFINE WINDOW icedit2 ;
		AT 6.000, 1.000 ;
		SIZE 16.538,119.000 ;
		FONT "MS Sans Serif", 9 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW ICEDIT
ENDIF

IF NOT WEXIST("icedit3") ;   
	OR UPPER(WTITLE("ICEDIT3")) == "ICEDIT3.PJX";
	OR UPPER(WTITLE("ICEDIT3")) == "ICEDIT3.SCX";      
	OR UPPER(WTITLE("ICEDIT3")) == "ICEDIT3.MNX";      
	OR UPPER(WTITLE("ICEDIT3")) == "ICEDIT3.PRG";
	OR UPPER(WTITLE("ICEDIT3")) == "ICEDIT3.FRX";
	OR UPPER(WTITLE("ICEDIT3")) == "ICEDIT3.QPR"      
	DEFINE WINDOW icedit3 ;
		AT 25.250, 1.000 ;
		SIZE 4.167,76.875 ;
		FONT "FoxFont", 9 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW ICEDIT
ENDIF


*       *********************************************************
*       *                                                         
*       *          ICEDIT/Windows Setup Code - SECTION 2          
*       *                                                         
*       *********************************************************
*

#REGION 1
=lfDisBrow2()

*       *********************************************************
*       *                                                         
*       *         ICEDIT1/Windows Setup Code - SECTION 2          
*       *                                                         
*       *********************************************************
*

#REGION 2


*       *********************************************************
*       *                                                         
*       *         ICEDIT3/Windows Setup Code - SECTION 2          
*       *                                                         
*       *********************************************************
*

#REGION 4


*       *********************************************************
*       *                                                         
*       *              ICEDIT/Windows Screen Layout               
*       *                                                         
*       *********************************************************
*

#REGION 1
IF WVISIBLE("icedit")
	ACTIVATE WINDOW icedit SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW icedit NOSHOW
    llSayCnt=.T.   
ENDIF
IF llSayCnt
  DO _1DP0RCMP3 
ENDIF

lcWindNoGr = ''




*       *********************************************************
*       *                                                         
*       *              ICEDIT1/Windows Screen Layout              
*       *                                                         
*       *********************************************************
*

#REGION 2
IF WVISIBLE("icedit1")
	ACTIVATE WINDOW icedit1 SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW icedit1 NOSHOW
    llSayCnt=.T.   
ENDIF
IF llSayCnt
  DO _1DP0RCMR7 
ENDIF

  @ 3.167,75.750 GET ibDisMul ;
  	  PICTURE "@*IHN " ;
	  SIZE 0,0,1.000 ;
	  DEFAULT 0 ;
	FONT "FoxFont", 9 ;
	WHEN _1dp0rcmrt() ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)

lcWindNoGr = ''




*       *********************************************************
*       *                                                         
*       *              ICEDIT2/Windows Screen Layout              
*       *                                                         
*       *********************************************************
*

#REGION 3
IF .F.
IF WVISIBLE("icedit2")
	ACTIVATE WINDOW icedit2 SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW icedit2 NOSHOW
    llSayCnt=.T.   
ENDIF
ENDIF

lcWindNoGr = ''




*       *********************************************************
*       *                                                         
*       *              ICEDIT3/Windows Screen Layout              
*       *                                                         
*       *********************************************************
*

#REGION 4
IF WVISIBLE("icedit3")
	ACTIVATE WINDOW icedit3 SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW icedit3 NOSHOW
    llSayCnt=.T.   
ENDIF

  @ 1.833,75.000 GET IbMulDist ;
  	  PICTURE "@*IHN " ;
	  SIZE 0,0,1.000 ;
	  DEFAULT 0 ;
	FONT "FoxFont", 9 ;
	WHEN _1dp0rcmtt() ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)
IF llSayCnt
  DO _1DP0RCMTS 
ENDIF

  @ 0.500,13.625 GET pbOk ;
	  PICTURE "@*HT \<Ok" ;
	  SIZE 2.077,12.000,0.667 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID _1dp0rcmuf()

  @ 0.583,53.125 GET pbCan ;
	  PICTURE "@*HT \<Cancel" ;
	  SIZE 2.077,12.000,0.667 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID _1dp0rcmuz()

lcWindNoGr = ''

IF NOT WVISIBLE("icedit3")
	ACTIVATE WINDOW icedit3 
ENDIF
IF .F.
IF NOT WVISIBLE("icedit2")
	ACTIVATE WINDOW icedit2 
ENDIF
ENDIF
IF NOT WVISIBLE("icedit1")
	ACTIVATE WINDOW icedit1 
ENDIF
IF NOT WVISIBLE("icedit")
	ACTIVATE WINDOW icedit 
ENDIF


READ CYCLE MODAL ;
	ACTIVATE lfAriaAct() ;
	SHOW _1dp0rcmt8()

  RELEASE WINDOW icedit
  RELEASE WINDOW icedit1
  RELEASE WINDOW icedit2
  RELEASE WINDOW icedit3

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       *********************************************************
*       *                                                         
*       * ICEDIT/Windows Says Function defined by aria generator  
*       *                                                         
*       *********************************************************
*

PROCEDURE _1DP0RCMP3

  @ 0.000,0.000 TO 0.000,78.750 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.333,0.500 TO 0.333,78.250 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.000,78.625 TO 29.500,78.625 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.333,78.125 TO 29.166,78.125 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.000,0.000 TO 29.500,0.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.333,0.500 TO 29.166,0.500 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 29.083,0.500 TO 29.083,78.250 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 29.417,0.000 TO 29.417,78.750 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

*       *********************************************************
*       *                                                         
*       * ICEDIT1/Windows Says Function defined by aria generator 
*       *                                                         
*       *********************************************************
*

PROCEDURE _1DP0RCMR7

  @ 0.000,0.000 TO 4.417,76.500 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,,,,)

  @ 0.000,0.125 TO 4.500,76.625 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 2.000,1.250 TO 2.000,22.500 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.083,1.250 TO 3.416,1.250 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 3.250,1.500 TO 3.250,22.375 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.083,22.125 TO 3.416,22.125 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.000,23.250 TO 2.000,56.125 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 3.250,23.375 TO 3.250,56.125 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.083,23.250 TO 3.333,23.250 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.083,55.875 TO 3.333,55.875 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.750,23.375 SAY "Description"  ;
	FONT "Courier", 10 ;
	 STYLE "B"

  @ 2.167,1.625 SAY LCMAJOR ;
	SIZE 1.000,20.375 ;
	FONT "Courier", 10 ;
	   COLOR  &gcObjColor

  @ 2.167,23.500 SAY STYLE.Desc1 ;
	SIZE 1.000,51.600 ;
	FONT "MS Sans Serif", 9 ;
	   COLOR  &gcObjColor

  @ 0.667,1.375 SAY " Style"  ;
	FONT "Courier", 10 ;
	 STYLE "B"

*       *********************************************************
*       *                                                         
*       * ICEDIT2/Windows Says Function defined by aria generator 
*       *                                                         
*       *********************************************************
*

PROCEDURE _1DP0RCMTA

*       *********************************************************
*       *                                                         
*       * ICEDIT3/Windows Says Function defined by aria generator 
*       *                                                         
*       *********************************************************
*

PROCEDURE _1DP0RCMTS

  @ 0.000,0.000 TO 3.167,76.500 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,,,,)

  @ 0.083,0.125 TO 3.250,76.625 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

*!************************************************************************
*! This Code Generated By Aria Code Generator to refresh the Says Only
*! with out needing to use the show gets
*!************************************************************************
FUNCTION lfRefresh
PARAMETERS lcWindRef
      DO _1dp0rcmt8 WITH lcWindRef
*********************** End of Aria Refresh Says Code ***********************  

*!************************************************************************
*! This Code Generated By Aria Code Generator to refresh the Says Only
*! with out needing to use the show gets
*!************************************************************************
FUNCTION lfRefresh
PARAMETERS lcWindRef
      DO _1dp0rcmt8 WITH lcWindRef
*********************** End of Aria Refresh Says Code ***********************  

*!************************************************************************
*! This Code Generated By Aria Code Generator to refresh the Says Only
*! with out needing to use the show gets
*!************************************************************************
FUNCTION lfRefresh
PARAMETERS lcWindRef
      DO _1dp0rcmt8 WITH lcWindRef
*********************** End of Aria Refresh Says Code ***********************  


*       *********************************************************
*       *                                                         
*       * _1DP0RCMRT           ibDisMul WHEN                      
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         ICEDIT1,     Record Number:    4   
*       * Variable:            ibDisMul                           
*       * Called By:           WHEN Clause                        
*       * Snippet Number:      1                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1dp0rcmrt     &&  ibDisMul WHEN
#REGION 2
IF .T.
  KEYBOARD "{ALT+B}" CLEAR
  RETURN
ENDIF
RETURN .F.

*       *********************************************************
*       *                                                         
*       * _1DP0RCMTT           IbMulDist WHEN                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         ICEDIT3,     Record Number:    2   
*       * Variable:            IbMulDist                          
*       * Called By:           WHEN Clause                        
*       * Snippet Number:      2                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1dp0rcmtt     &&  IbMulDist WHEN
#REGION 4
IF .T.
  KEYBOARD "{ALT+B}" CLEAR
  RETURN
ENDIF
RETURN .F.

*       *********************************************************
*       *                                                         
*       * _1DP0RCMUF           pbOk VALID                         
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         ICEDIT3,     Record Number:    5   
*       * Variable:            pbOk                               
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      3                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1dp0rcmuf     &&  pbOk VALID
#REGION 4
llOk = .T.

*       *********************************************************
*       *                                                         
*       * _1DP0RCMUZ           pbCan VALID                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         ICEDIT3,     Record Number:    6   
*       * Variable:            pbCan                              
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      4                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1dp0rcmuz     &&  pbCan VALID
#REGION 4
llOk = .F.

*       *********************************************************
*       *                                                         
*       * LFARIAACT           Read Level Activate                 
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         Multiple Screens                   
*       * Called By:           READ Statement                     
*       * Snippet Number:      5                                  
*       *                                                         
*       *********************************************************
*
FUNCTION lfAriaAct     && Read Level Activate
IF TYPE('lcWindNoGr') = 'C' AND !EMPTY(lcWindNoGr)
  DO CASE
    CASE WONTOP() $ lcWindNoGr
      MODIFY WINDOW (WONTOP()) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WONTOP())
    CASE WPARENT(WONTOP()) $ lcWindNoGr
      MODIFY WINDOW (WPARENT(WONTOP())) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WPARENT(WONTOP()))
  ENDCASE
ENDIF

*       *********************************************************
*       *                                                         
*       * LFVY2K           Valid 1900 year                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         Multiple Screens                   
*       * Called By:           READ Statement                     
*       * Snippet Number:      6                                  
*       *                                                         
*       *********************************************************
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)

*       *********************************************************
*       *                                                         
*       * _1DP0RCMT8           Read Level Show                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         Multiple Screens                   
*       * Called By:           READ Statement                     
*       * Snippet Number:      7                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1dp0rcmt8     && Read Level Show
PARAMETERS lcShowWin
lcShowWin=IIF(PARAM()>0 AND TYPE('lcShowWin')='C',lcShowWin,'')
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: ICEDIT
*
#REGION 1
IF ((SYS(2016) = UPPER("icedit") OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER("icedit") $ UPPER(lcShowWin)         
  _1DP0RCMV6=IIF(WVISIBLE("icedit"),'SAME','NOSHOW')
	ACTIVATE WINDOW icedit &_1DP0RCMV6
ENDIF
*
* Show Code from screen: ICEDIT1
*
#REGION 2
IF ((SYS(2016) = UPPER("icedit1") OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER("icedit1") $ UPPER(lcShowWin)         
  _1DP0RCMV8=IIF(WVISIBLE("icedit1"),'SAME','NOSHOW')
	ACTIVATE WINDOW icedit1 &_1DP0RCMV8

  @ 2.167,1.625 SAY LCMAJOR ;
	SIZE 1.000,20.375, 0.000 ;
		FONT "Courier", 10 ;
		   COLOR  &gcObjColor

  @ 2.167,23.500 SAY STYLE.Desc1 ;
	SIZE 1.000,51.600, 0.000 ;
		FONT "MS Sans Serif", 9 ;
		   COLOR  &gcObjColor
ENDIF
IF NOT EMPTY(currwind)
  _1DP0RCMVN=IIF(WVISIBLE(currwind),'SAME','NOSHOW')
	ACTIVATE WINDOW (currwind) &_1DP0RCMVN   
ENDIF