LCCTR = ''
WAIT WINDOW NOWAIT 'Collecting Data ... Please Wait.'
LNDATEPOS = ASUBSCRIPT(LAOGFXFLT,ASCAN(LAOGFXFLT,'CUTTKTL.DATE'),1)
LCREPRNGF = LEFT(LAOGFXFLT(LNDATEPOS,6),10)
LCREPRNGT = RIGHT(LAOGFXFLT(LNDATEPOS,6),10)
LCDTFLT = '.T.'
DO CASE
   CASE  .NOT. EMPTY(CTOD(LCREPRNGF)) .AND.  .NOT. EMPTY(CTOD(LCREPRNGT))
      LCDTFLT = "BETWEEN(ALLTRIM(DTOS(CUTTKTL.DATE)),'"+ALLTRIM(DTOS(CTOD(LCREPRNGF)))+"','"+ALLTRIM(DTOS(CTOD(LCREPRNGT)))+"')"
   CASE EMPTY(CTOD(LCREPRNGF)) .AND.  .NOT. EMPTY(CTOD(LCREPRNGT))
      LCREPRNGT = ALLTRIM(DTOS(CTOD(LCREPRNGT)))
      LCREPRNGF = ''
      LCDTFLT = 'ALLTRIM(DTOS(CUTTKTL.DATE)) < "'+LCREPRNGT+'"'
   CASE EMPTY(CTOD(LCREPRNGF)) .AND. EMPTY(CTOD(LCREPRNGT))
      LCREPRNGF = ''
      LCREPRNGT = ''
      LCDTFLT = '.T.'
ENDCASE
LNCNTPOS = ASUBSCRIPT(LAOGFXFLT,ASCAN(LAOGFXFLT,'MFGOPRHD.CCONTCODE'),1)
IF EMPTY(LAOGFXFLT(LNCNTPOS,6))
   LCCRFLT = '.T.'
ELSE
   *LCCNTRG = STRTRAN(LAOGFXFLT(LNCNTPOS,6),'|',',')
   LCCNTRG = STRTRAN(LAOGFXFLT(LNCNTPOS,6),"|","','")
   
   LCCRFLT = "INLIST(MFGOPRHD.CCONTCODE,'"+LCCNTRG+"')"
ENDIF
= LFCRTMP()
SELECT CUTTKTH
LNCTPOS = ASUBSCRIPT(LAOGFXFLT,ASCAN(LAOGFXFLT,'CUTTKTH.CUTTKT'),1)
IF USED(LAOGFXFLT(LNCTPOS,6))
   GOTO IN (LAOGFXFLT(LNCTPOS,6)) TOP
   IF  .NOT. EOF(LAOGFXFLT(LNCTPOS,6))
      SELECT LAOGFXFLT(LNCTPOS,6)
      SET RELATION TO CUTTKT INTO CUTTKTH
   ENDIF
ENDIF
SET RELATION TO 'M'+CUTTKT INTO MFGOPRHD, CUTTKT INTO CUTTKTL ADDITIVE
SCAN
   M.ENTERED = CUTTKTH.ENTERED
   M.COMPLETE = CUTTKTH.COMPLETE
   IF  .NOT. EOF('MFGOPRHD')
      SELECT MFGOPRHD
      IF EVALUATE(LCCRFLT)
         LCCTR = CCONTCODE
      ENDIF
      LCOPRSEQ = COPERSEQ
      SCAN WHILE CIMTYP+CTKTNO='M'+CUTTKTH.CUTTKT
         IF VAL(COPERSEQ)>VAL(LCOPRSEQ) .AND. EVALUATE(LCCRFLT)
            LCCTR = CCONTCODE
         ENDIF
      ENDSCAN
   ENDIF
   LLCTR = (LCCRFLT='.T.' .OR.  .NOT. EMPTY(LCCTR))
   IF LLCTR
      SELECT CUTTKTL
      SCAN WHILE CUTTKT = CUTTKTH.CUTTKT for trancd = "2" .AND. &lcDtFlt
         SCATTER MEMO MEMVAR
         WAIT WINDOW NOWAIT 'Selecting Cut Ticket #'+CUTTKTH.CUTTKT+', Style# '+M.STYLE
         M.CONTRACT = LCCTR
         M.TTLLAND = M.NLAN_CST1+M.NLAN_CST2+M.NLAN_CST3+M.NLAN_CST4+M.NLAN_CST5
         M.TLTCOST = M.TOTQTY*M.TTLLAND
         M.ESTCOST = (CUTTKTH.NEST_COST1+CUTTKTH.NEST_COST2+CUTTKTH.NEST_COST3+CUTTKTH.NEST_COST4+CUTTKTH.NEST_COST5)/CUTTKTH.PCS_BUD
         M.DIFF = M.ESTCOST-M.TTLLAND
         M.VAR = ROUND(M.DIFF/M.ESTCOST,2)
         M.DATEVAR = M.COMPLETE-M.DATE
         INSERT INTO &LCWORKFILE FROM MEMVAR
      ENDSCAN
   ENDIF
ENDSCAN
WAIT CLEAR
SELECT (LCWORKFILE)
GOTO TOP
IF EOF()
   = GFMODALGEN('TRM00052B40011','ALERT')
   RETURN
ENDIF
DO GFDISPRE WITH EVALUATE('lcRpForm')
IF USED(LCWORKFILE)
   SELECT (LCWORKFILE)
   SET RELATION TO
   USE IN (LCWORKFILE)
ENDIF
ERASE (GCWORKDIR+(LCWORKFILE)+'.DBF')
ERASE (GCWORKDIR+(LCWORKFILE)+'.CDX')
RETURN

PROCEDURE LFCRTMP
DIMENSION LATEMPSTRU[ 1, 4]
LATEMPSTRU = ''
SELECT CUTTKTL
= AFIELDS(LATEMPSTRU)
LNARRLEN = ALEN(LATEMPSTRU,1)
DIMENSION LATEMPSTRU[ LNARRLEN+8, 4]
LATEMPSTRU[ LNARRLEN, 1] = 'CONTRACT'
LATEMPSTRU[ LNARRLEN, 2] = 'C'
LATEMPSTRU[ LNARRLEN, 3] = 8
LATEMPSTRU[ LNARRLEN, 4] = 0
LATEMPSTRU[ LNARRLEN+1, 1] = 'TTLLAND'
LATEMPSTRU[ LNARRLEN+1, 2] = 'N'
LATEMPSTRU[ LNARRLEN+1, 3] = 15
LATEMPSTRU[ LNARRLEN+1, 4] = 6
LATEMPSTRU[ LNARRLEN+2, 1] = 'TLTCOST'
LATEMPSTRU[ LNARRLEN+2, 2] = 'N'
LATEMPSTRU[ LNARRLEN+2, 3] = 15
LATEMPSTRU[ LNARRLEN+2, 4] = 6
LATEMPSTRU[ LNARRLEN+3, 1] = 'ESTCOST'
LATEMPSTRU[ LNARRLEN+3, 2] = 'N'
LATEMPSTRU[ LNARRLEN+3, 3] = 15
LATEMPSTRU[ LNARRLEN+3, 4] = 6
LATEMPSTRU[ LNARRLEN+4, 1] = 'DIFF'
LATEMPSTRU[ LNARRLEN+4, 2] = 'N'
LATEMPSTRU[ LNARRLEN+4, 3] = 15
LATEMPSTRU[ LNARRLEN+4, 4] = 6
LATEMPSTRU[ LNARRLEN+5, 1] = 'VAR'
LATEMPSTRU[ LNARRLEN+5, 2] = 'N'
LATEMPSTRU[ LNARRLEN+5, 3] = 9
LATEMPSTRU[ LNARRLEN+5, 4] = 2
LATEMPSTRU[ LNARRLEN+6, 1] = 'ENTERED'
LATEMPSTRU[ LNARRLEN+6, 2] = 'D'
LATEMPSTRU[ LNARRLEN+6, 3] = 8
LATEMPSTRU[ LNARRLEN+6, 4] = 0
LATEMPSTRU[ LNARRLEN+7, 1] = 'COMPLETE'
LATEMPSTRU[ LNARRLEN+7, 2] = 'D'
LATEMPSTRU[ LNARRLEN+7, 3] = 8
LATEMPSTRU[ LNARRLEN+7, 4] = 0
LATEMPSTRU[ LNARRLEN+8, 1] = 'DATEVAR'
LATEMPSTRU[ LNARRLEN+8, 2] = 'N'
LATEMPSTRU[ LNARRLEN+8, 3] = 4
LATEMPSTRU[ LNARRLEN+8, 4] = 0
CREATE DBF (GCWORKDIR+LCWORKFILE) FROM ARRAY LATEMPSTRU
SELECT (LCWORKFILE)
DO CASE
   CASE LCRPSORTBY='S'
      INDEX ON STYLE+DTOS(DATE)  TAG &LCWORKFILE
   CASE LCRPSORTBY='D'
      INDEX ON DTOS(DATE)+STYLE  TAG &LCWORKFILE
   CASE LCRPSORTBY='V'
      INDEX ON STR(VAR)+STYLE+DTOS(DATE)  TAG &LCWORKFILE
   CASE LCRPSORTBY='C'
      INDEX ON CONTRACT+STYLE  TAG &LCWORKFILE
   CASE LCRPSORTBY='T'
      INDEX ON CUTTKT+DTOS(DATE)  TAG &LCWORKFILE
   CASE LCRPSORTBY='P'
      INDEX ON STR(DATEVAR)+STYLE  TAG &LCWORKFILE
ENDCASE

PROCEDURE LFWREPWHEN
RETURN

PROCEDURE LFVCONT
SELECT APVENDOR
SET ORDER TO VenCode
LCOBJNAME = SYS(18)
LCOBJVAL = EVALUATE(SYS(18))
IF '?'$LCOBJVAL .OR. ( .NOT. EMPTY(LCOBJVAL) .AND.  .NOT. SEEK(LCOBJVAL,'APVENDOR'))
   = GFAPVNBROW(@LCOBJVAL)
   LCOBJVAL = IIF( .NOT. EMPTY(LCOBJVAL),LCOBJVAL,LAOLDVAL)
   &lcObjName = lcObjVal
ENDIF
*
