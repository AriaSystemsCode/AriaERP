*       *********************************************************
*       *                                                         
*       * 07/18/2006           MFMODOPR.SPR              18:26:34 
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (c) 2006 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This program was automatically generated by GENSCRN.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *         MFMODOPR/Windows Setup Code - SECTION 1         
*       *                                                         
*       *********************************************************
*

#REGION 1
*B#803082,1 SSH 06/03/00 Allow enabling cont/dept even if AP not installed
*lcDisStat = IIF(!llInHouse .AND. 'AP' $ gcCmpModules,'ENABLE','DISABLE')
*lcNameStat= IIF(!llInHouse .AND. 'AP' $ gcCmpModules,'DISABLE','ENABLE')
lcDisStat = IIF(!llInHouse ,'ENABLE','DISABLE')
lcNameStat= IIF(!llInHouse ,'DISABLE','ENABLE')

*B#803082,1 SSH (End)

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       *********************************************************
*       *                                                         
*       *               Windows Window definitions                
*       *                                                         
*       *********************************************************
*

lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
IF NOT WEXIST("mfmodopr") ;   
	OR UPPER(WTITLE("MFMODOPR")) == "MFMODOPR.PJX";
	OR UPPER(WTITLE("MFMODOPR")) == "MFMODOPR.SCX";      
	OR UPPER(WTITLE("MFMODOPR")) == "MFMODOPR.MNX";      
	OR UPPER(WTITLE("MFMODOPR")) == "MFMODOPR.PRG";
	OR UPPER(WTITLE("MFMODOPR")) == "MFMODOPR.FRX";
	OR UPPER(WTITLE("MFMODOPR")) == "MFMODOPR.QPR"      
	DEFINE WINDOW mfmodopr ;
		AT  0.000, 0.000  ;
		SIZE 12.308,121.000 ;
		TITLE "Modify Operation" ;
		FONT "MS Sans Serif", 8 ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		DOUBLE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW FNDATION
	MOVE WINDOW mfmodopr CENTER
ENDIF


*       *********************************************************
*       *                                                         
*       *             MFMODOPR/Windows Screen Layout              
*       *                                                         
*       *********************************************************
*

#REGION 1
IF WVISIBLE("mfmodopr")
	ACTIVATE WINDOW mfmodopr SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW mfmodopr NOSHOW
    llSayCnt=.T.   
ENDIF
IF llSayCnt
  DO _1UP13J2HS 
ENDIF

  @ 1.615,111.400 GET lcOperSeq ;
	SIZE 1.000,5.000 ;
	DEFAULT " " ;
	FONT "MS Sans Serif", 8 ;
	PICTURE "@!" ;
	  VALID lfvOprSeq() ;
	MESSAGE '' &lcModSeq ;
	   COLOR  &gcObjColor

  @ 3.923,20.400 GET lcOprComnt ;
	SIZE 1.000,74.200 ;
	DEFAULT " " ;
	FONT "MS Sans Serif", 8 ;
	   COLOR  &gcObjColor

  @ 3.769,97.000 GET llInHouse ;
	  PICTURE "@*C \<In House" ;
	  SIZE 1.308,14.167 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  VALID _1up13j2hv()

  @ 6.000,20.000 GET ibContCode ;
	  PICTURE "@*BVN " + ;
		  lcKey ;
	  SIZE 1.538,4.400,0.923 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	WHEN MDOWN() ;
	  VALID gfvActBrow('lcContCode') ;
	MESSAGE '' &lcDisStat

  @ 6.231,26.400 GET lcContCode ;
	SIZE 1.000,19.000 ;
	DEFAULT " " ;
	FONT "MS Sans Serif", 9 ;
	PICTURE "@K !!!!!!!!" ;
	  VALID IIF(!llInhouse ,lfvContCode(),.T.) ;
	   COLOR  &gcObjColor

  @ 6.231,47.400 GET lcContName ;
	SIZE 1.000,63.000 ;
	DEFAULT " " ;
	FONT "MS Sans Serif", 8 ;
	MESSAGE '' &lcNameStat ;
	   COLOR  &gcObjColor

 IF cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H')
    @ 9.462,21.000 GET cbActualize ;
	    PICTURE "@*C \<Actualize" ;
	    SIZE 1.308,14.333 ;
	    DEFAULT 0 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "BT"
 ENDIF

  @ 8.846,IIF(cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H'),52.4,35.6) GET pbOk ;
	  PICTURE "@*BHT " + ;
		  lcOk ;
	  SIZE 2.615,15.200,0.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	  VALID lfvUpOpr()

  @ 8.846,IIF(cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H'),86.8,70.0) GET pbCancel ;
	  PICTURE "@*BHT " + ;
		  lcCancel ;
	  SIZE 2.615,15.200,0.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8

lcWindNoGr = ''

IF NOT WVISIBLE("mfmodopr")
	ACTIVATE WINDOW mfmodopr     
ENDIF     


*       *********************************************************
*       *                                                         
*       *    WindowsREAD contains clauses from SCREEN mfmodopr    
*       *                                                         
*       *********************************************************
*

READ CYCLE MODAL ;
	WHEN lfDisActual() ;
	ACTIVATE lfAriaAct() ;
	SHOW _1up13j2j9() ;
	OBJECT LNCUROBJ COLOR ,&GCREADCLR

  RELEASE WINDOW mfmodopr

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       *********************************************************
*       *                                                         
*       * MFMODOPR/Windows Says Function defined by aria generato 
*       *                                                         
*       *********************************************************
*

PROCEDURE _1UP13J2HS

  @ 1.615,20.400 SAY cOprCode ;
	SIZE 1.000,14.600 ;
	FONT "MS Sans Serif", 8

IF cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H')
    @ 9.462,20.800 TO 9.462,23.800 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H')
    @ 10.538,21.000 TO 10.538,23.800 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H')
    @ 9.538,20.600 TO 10.538,20.600 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H')
    @ 9.615,23.600 TO 10.615,23.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H')
    @ 8.846,19.000 TO 11.384,38.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)
ENDIF

  @ 1.538,4.000 SAY "Operation"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 6.154,4.000 SAY "Dept./Cont."  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 1.538,97.000 SAY "Sequence :"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 3.846,4.000 SAY "Comment"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 0.000,0.000 TO 0.000,121.000 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.308,0.800 TO 0.308,120.200 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.000,120.800 TO 12.308,120.800 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.308,120.000 TO 12.000,120.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.000,0.000 TO 12.308,0.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.308,0.800 TO 12.000,0.800 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 11.923,0.800 TO 11.923,120.200 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 12.231,0.000 TO 12.231,121.000 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.154,18.000 SAY ":"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 3.846,18.000 SAY ":"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 1.615,18.000 SAY ":"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 1.462,20.000 TO 1.462,35.600 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.615,20.200 TO 2.615,35.600 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.538,20.000 TO 2.692,20.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,35.200 TO 2.692,35.200 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.462,37.000 TO 1.462,95.200 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.615,37.200 TO 2.615,95.200 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.538,37.000 TO 2.692,37.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,94.800 TO 2.692,94.800 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.462,111.000 TO 1.462,117.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.615,111.200 TO 2.615,117.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.538,111.000 TO 2.692,111.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,116.600 TO 2.692,116.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 3.769,20.000 TO 3.769,95.200 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 4.923,20.200 TO 4.923,95.200 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 3.846,20.000 TO 5.000,20.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 3.846,94.800 TO 5.000,94.800 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 3.769,96.800 TO 3.769,99.800 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 4.923,97.000 TO 4.923,99.800 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 3.846,96.600 TO 4.923,96.600 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 3.923,99.600 TO 5.000,99.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.077,26.000 TO 6.077,46.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 7.231,26.200 TO 7.231,46.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.154,26.000 TO 7.308,26.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.154,45.600 TO 7.308,45.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.077,47.000 TO 6.077,111.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 7.231,47.200 TO 7.231,111.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.154,47.000 TO 7.308,47.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.154,110.600 TO 7.308,110.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.769,2.000 TO 8.154,118.400 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,,,,)

  @ 0.846,2.200 TO 8.231,118.600 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 1.615,37.400 SAY gfCodDes(cOprCode,'MFGCODE') ;
	SIZE 1.000,57.200 ;
	FONT "MS Sans Serif", 8

IF cOprCode=lcFirstOpr AND !INLIST(laData[3],'A','H')
    @ 8.923,19.200 TO 11.461,38.200 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,,,,)
ENDIF

*!************************************************************************
*! This Code Generated By Aria Code Generator to refresh the Says Only
*! with out needing to use the show gets
*!************************************************************************
FUNCTION lfRefresh
PARAMETERS lcWindRef
      DO _1up13j2j9 WITH lcWindRef
*********************** End of Aria Refresh Says Code ***********************  


*       *********************************************************
*       *                                                         
*       * _1UP13J2HV           llInHouse VALID                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFMODOPR,     Record Number:    5  
*       * Variable:            llInHouse                          
*       * Called By:           VALID Clause                       
*       * Object Type:         Check Box                          
*       * Snippet Number:      1                                  
*       *                                                         
*       *********************************************************
*
*B#803082,1 SSH 06/03/00 Allow enabling cont/dept even if AP not installed
*IF !llInhouse  .AND. 'AP' $ gcCmpModules
FUNCTION _1up13j2hv     &&  llInHouse VALID
#REGION 1
IF !llInhouse
*B#803082,1 SSH (End)
  SHOW GET ibContCode ENABLE
  SHOW GET lcCOntName DISABLE
ELSE
  SHOW GET ibContCode DISABLE
  SHOW GET lcCOntName ENABLE
ENDIF

*       *********************************************************
*       *                                                         
*       * LFARIAACT           Read Level Activate                 
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFMODOPR                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      2                                  
*       *                                                         
*       *********************************************************
*
FUNCTION lfAriaAct     && Read Level Activate
IF TYPE('lcWindNoGr') = 'C' AND !EMPTY(lcWindNoGr)
  DO CASE
    CASE WONTOP() $ lcWindNoGr
      MODIFY WINDOW (WONTOP()) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WONTOP())
    CASE WPARENT(WONTOP()) $ lcWindNoGr
      MODIFY WINDOW (WPARENT(WONTOP())) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WPARENT(WONTOP()))
  ENDCASE
ENDIF

*       *********************************************************
*       *                                                         
*       * LFVY2K           Valid 1900 year                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFMODOPR                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      3                                  
*       *                                                         
*       *********************************************************
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)

*       *********************************************************
*       *                                                         
*       * _1UP13J2J9           Read Level Show                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFMODOPR                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      4                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1up13j2j9     && Read Level Show
PARAMETERS lcShowWin
lcShowWin=IIF(PARAM()>0 AND TYPE('lcShowWin')='C',lcShowWin,'')
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: MFMODOPR
*
#REGION 1
IF ((SYS(2016) = UPPER("mfmodopr") OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER("mfmodopr") $ UPPER(lcShowWin)         
  _1UP13J2KR=IIF(WVISIBLE("mfmodopr"),'SAME','NOSHOW')
	ACTIVATE WINDOW mfmodopr &_1UP13J2KR

  @ 1.615,20.400 SAY cOprCode ;
	SIZE 1.000,14.600, 0.000 ;
		FONT "MS Sans Serif", 8

  @ 1.615,37.400 SAY gfCodDes(cOprCode,'MFGCODE') ;
	SIZE 1.000,57.200, 0.000 ;
		FONT "MS Sans Serif", 8
ENDIF
IF NOT EMPTY(currwind)
  _1UP13J2KU=IIF(WVISIBLE(currwind),'SAME','NOSHOW')
	ACTIVATE WINDOW (currwind) &_1UP13J2KU   
ENDIF