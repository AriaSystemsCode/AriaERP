*       *********************************************************
*       *                                                         
*       * 07/18/2006           MFITMISS.SPR              18:26:21 
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (c) 2006 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This program was automatically generated by GENSCRN.    
*       *                                                         
*       *********************************************************

PARAMETERS llissue,llactcst,lleditused

*       *********************************************************
*       *                                                         
*       *         MFITMISS/Windows Setup Code - SECTION 1         
*       *                                                         
*       *********************************************************
*

#REGION 1

*E301897,1 AMH Add new parameter for calling from edit used botton [Start]
*PARAMETERS llIssue,llActCst
*lcTitle = IIF(llIssue,'Issue','Return')
lcTitle = IIF(llEditUsed,'Edit Used',IIF(llIssue,'Issue','Return'))

*lcText1  = IIF(llIssue,'Issue Date','Return Date')
lcText1  = IIF(llEditUsed,'Date',IIF(llIssue,'Issue Date','Return Date'))
*lcText2  = IIF(llIssue,'Issue Cost','Return Cost')
lcText2  = IIF(llEditUsed,'Cost',IIF(llIssue,'Issue Cost','Return Cost'))
*lcText3  = IIF(llIssue,'Issue Quantity','Return Quantity')
lcText3  = IIF(llEditUsed,'Used Quantity',IIF(llIssue,'Issue Quantity','Return Quantity'))
*lcText4  = IIF(llIssue,'Issue From Warehouse','Return To Warehouse')
lcText4  = IIF(llEditUsed,'Warehouse',IIF(llIssue,'Issue From Warehouse','Return To Warehouse'))
lcText5  = IIF(llEditUsed,'Issue Quantity','Used Quantity')
*lcCstStat= IIF(llIssue .AND. !llActCst,'DISABLE','ENABLE')
lcCstStat= IIF((llIssue  .OR. llEditUsed) .AND. !llActCst,'DISABLE','ENABLE')
lcActCstSt=IIF(llActCst,'DISABLE','ENABLE')
*lcDyeStat= IIF(llIssue .AND. !llActCst AND EMPTY(m.Dyelot),'ENABLE','DISABLE')
lcDyeStat= IIF((llIssue .OR. llEditUsed) .AND. !llActCst AND EMPTY(m.Dyelot),'ENABLE','DISABLE')
*E301897,1 AMH [End]

*B038753,1 KHM 12/18/2004 Disable the unit cost in case of standard costing method
lcCstStat = IIF(laSetups[9,2]='S', 'DISABLE',lcCstStat)
*B038753,1 KHM 12/18/2004 [End]

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       *********************************************************
*       *                                                         
*       *               Windows Window definitions                
*       *                                                         
*       *********************************************************
*

lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
IF NOT WEXIST("mfitmiss") ;   
	OR UPPER(WTITLE("MFITMISS")) == "MFITMISS.PJX";
	OR UPPER(WTITLE("MFITMISS")) == "MFITMISS.SCX";      
	OR UPPER(WTITLE("MFITMISS")) == "MFITMISS.MNX";      
	OR UPPER(WTITLE("MFITMISS")) == "MFITMISS.PRG";
	OR UPPER(WTITLE("MFITMISS")) == "MFITMISS.FRX";
	OR UPPER(WTITLE("MFITMISS")) == "MFITMISS.QPR"      
	DEFINE WINDOW mfitmiss ;
		AT  0.000, 0.000  ;
		SIZE 20.000,116.000 ;
		TITLE lcTitle ;
		FONT "MS Sans Serif", 8 ;
		FLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		DOUBLE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW FNDATION
	MOVE WINDOW mfitmiss CENTER
ENDIF


*       *********************************************************
*       *                                                         
*       *             MFITMISS/Windows Screen Layout              
*       *                                                         
*       *********************************************************
*

#REGION 1
IF WVISIBLE("mfitmiss")
	ACTIVATE WINDOW mfitmiss SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW mfitmiss NOSHOW
    llSayCnt=.T.   
ENDIF
IF llSayCnt
  DO _1UP13ISJR 
ENDIF

IF llItemDye
    @ 2.615,39.000 GET ibDyelot ;
	    PICTURE "@*BVN " + ;
		    lcKey ;
	    SIZE 1.538,4.400,0.923 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	  WHEN MDOWN() ;
	    VALID gfvActBrow('m.Dyelot') ;
	  MESSAGE '' &lcDyeStat
ENDIF

IF llItemDye
    @ 2.923,44.400 GET m.Dyelot ;
	  SIZE 1.000,25.000 ;
	  DEFAULT " " ;
	  FONT "MS Sans Serif", 9 ;
	  PICTURE "!!!!!!!!!!" ;
	    VALID lfvIssDye('F') ;
	  MESSAGE '' &lcDyeStat ;
	     COLOR  &gcObjColor
ENDIF

IF laSetups[2,2]='Y'
  @ 2.846,72.200 GET lnIssWare ;
	  PICTURE "@^" ;
	  FROM laMatWare ;
	  SIZE 1.538,40.000 ;
	  DEFAULT 1 ;
	  FONT "MS Sans Serif", 9 ;
	    VALID lfvIssWare() ;
	  MESSAGE '' &lcWareStat
ENDIF

  @ 10.154,52.400 GET ldIssDate ;
	SIZE 1.000,12.000 ;
	DEFAULT {  /  /  } ;
	FONT "MS Sans Serif", 9 ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.) ;
	MESSAGE '' &lcActCstSt ;
	   COLOR  &gcObjColor

IF  !llIssue .OR. !INLIST(laSetups[9,2],'F','I')
    @ 10.154,77.400 GET lnIssCost ;
	  SIZE 1.000,13.000 ;
	  DEFAULT 0 ;
	  FONT "MS Sans Serif", 8 ;
	  PICTURE "999.999" ;
	  MESSAGE '' &lcCstStat ;
	     COLOR  &gcObjColor
ENDIF

IF !llEditUsed
    @ 13.615,77.400 GET m.Issue_Qty ;
	  SIZE 1.000,21.000 ;
	RANGE 0 ;
	  DEFAULT 0 ;
	  FONT "MS Sans Serif", 8 ;
	  PICTURE "99999999.999" ;
	  MESSAGE '' &lcActCstSt ;
	     COLOR  &gcObjColor
ENDIF

IF llEditUsed
    @ 13.615,77.400 GET m.Used_Qty ;
	  SIZE 1.000,21.000 ;
	RANGE 0 ;
	  DEFAULT 0 ;
	  FONT "MS Sans Serif", 8 ;
	  PICTURE "99999999.999" ;
	    VALID lfvUsedQty() ;
	  MESSAGE '' &lcActCstSt ;
	     COLOR  &gcObjColor
ENDIF

IF llIssue .AND. !EMPTY(m.cOprCode)
  @ 17.231,52.000 GET lnLotNo ;
	  PICTURE "@^" ;
	  FROM laLots ;
	  SIZE 1.538,12.000 ;
	  DEFAULT 1 ;
	  FONT "MS Sans Serif", 9 ;
	  MESSAGE '' &lcActCstSt
ENDIF

  @ 16.154,IIF(llIssue .AND. !EMPTY(m.cOprCode),78.00,29.40) GET pbOk ;
	  PICTURE "@*BHN " + ;
		  lcOk ;
	  SIZE 2.615,15.200,0.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	  VALID _1up13islm()

  @ 16.154,IIF(llIssue .AND. !EMPTY(m.cOprCode),98.00,71.40) GET pbCancel ;
	  PICTURE "@*BHN " + ;
		  lcCancel ;
	  SIZE 2.615,15.200,0.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	  VALID _1up13ismp()

lcWindNoGr = ''

IF NOT WVISIBLE("mfitmiss")
	ACTIVATE WINDOW mfitmiss     
ENDIF     


*       *********************************************************
*       *                                                         
*       *    WindowsREAD contains clauses from SCREEN mfitmiss    
*       *                                                         
*       *********************************************************
*

READ CYCLE MODAL ;
	ACTIVATE lfAriaAct() ;
	SHOW _1up13ismv() ;
	OBJECT LNCUROBJ COLOR ,&GCREADCLR


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       *********************************************************
*       *                                                         
*       * MFITMISS/Windows Says Function defined by aria generato 
*       *                                                         
*       *********************************************************
*

PROCEDURE _1UP13ISJR

  @ 0.000,0.000 TO 0.000,116.000 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.308,0.800 TO 0.308,115.200 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.000,0.000 TO 20.000,0.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.385,0.800 TO 19.693,0.800 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.000,115.800 TO 20.000,115.800 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.308,115.000 TO 19.693,115.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 19.923,0.000 TO 19.923,116.000 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 19.615,0.800 TO 19.615,115.200 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.538,4.000 SAY "Item"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)

  @ 1.538,23.000 SAY "Color"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)

  @ 2.769,4.000 TO 2.769,22.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 3.923,4.200 TO 3.923,22.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.846,4.000 TO 4.000,4.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.846,21.600 TO 4.000,21.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.769,23.000 TO 2.769,38.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 3.923,23.200 TO 3.923,38.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.846,23.000 TO 4.000,23.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.846,37.600 TO 4.000,37.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 5.385,4.000 TO 5.385,54.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.538,4.200 TO 6.538,54.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 5.462,4.000 TO 6.616,4.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 5.462,53.600 TO 6.616,53.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.308,4.000 SAY "Description"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)

  @ 8.385,4.000 SAY "Units"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)

  @ 8.385,24.000 SAY "Pieces"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)

  @ 11.923,4.000 SAY "Unit Cost"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)

  @ 11.846,24.000 SAY "Required"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)

  @ 10.000,4.000 TO 10.000,18.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 11.154,4.200 TO 11.154,18.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 10.077,4.000 TO 11.231,4.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 10.077,17.600 TO 11.231,17.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 10.000,24.000 TO 10.000,40.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 11.154,24.200 TO 11.154,40.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 10.077,24.000 TO 11.231,24.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 10.077,39.600 TO 11.231,39.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 13.462,4.000 TO 13.462,18.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 14.615,4.200 TO 14.615,18.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 13.538,4.000 TO 14.692,4.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 13.538,17.600 TO 14.692,17.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 13.462,24.000 TO 13.462,42.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 14.615,24.200 TO 14.615,42.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 13.538,24.000 TO 14.692,24.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 13.538,41.600 TO 14.692,41.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.769,2.000 TO 7.154,113.000 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,,,,)

  @ 7.692,2.000 TO 15.307,113.000 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,,,,)

IF  !llIssue .OR. !INLIST(laSetups[9,2],'F','I')
    @ 10.000,77.000 TO 10.000,91.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF  !llIssue .OR. !INLIST(laSetups[9,2],'F','I')
    @ 11.154,77.200 TO 11.154,91.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF  !llIssue .OR. !INLIST(laSetups[9,2],'F','I')
    @ 10.077,77.000 TO 11.231,77.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF  !llIssue .OR. !INLIST(laSetups[9,2],'F','I')
    @ 10.077,90.600 TO 11.231,90.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF !llEditUsed
    @ 13.462,77.000 TO 13.462,99.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF !llEditUsed
    @ 14.615,77.200 TO 14.615,99.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF !llEditUsed
    @ 13.538,77.000 TO 14.692,77.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF !llEditUsed
    @ 13.538,98.600 TO 14.692,98.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

  @ 10.000,52.000 TO 10.000,65.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 11.154,52.200 TO 11.154,65.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 10.077,52.000 TO 11.231,52.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 10.077,64.600 TO 11.231,64.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

IF llItemDye
    @ 1.538,44.000 SAY "Dyelot"  ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)
ENDIF 

IF llItemDye
    @ 2.769,44.000 TO 2.769,70.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF llItemDye
    @ 3.923,44.200 TO 3.923,70.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF llItemDye
    @ 2.846,44.000 TO 4.000,44.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF llItemDye
    @ 2.846,69.600 TO 4.000,69.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

  @ 13.462,52.000 TO 13.462,70.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 14.615,52.200 TO 14.615,70.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 13.538,52.000 TO 14.692,52.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 13.538,69.600 TO 14.692,69.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.846,2.200 TO 7.231,113.200 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 7.769,2.200 TO 15.384,113.200 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 15.769,2.000 TO 19.154,76.400 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,,,,)
ENDIF

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 15.846,2.200 TO 19.231,76.600 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)
ENDIF

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 16.154,4.200 SAY "Operation"  ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)
ENDIF 

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 16.154,52.000 SAY "Lot#"  ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "BT" ;
	  COLOR RGB(0,0,0,,,,)
ENDIF 

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 17.308,4.000 TO 17.308,50.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 18.462,4.200 TO 18.462,50.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 17.385,4.000 TO 18.539,4.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 17.385,49.600 TO 18.539,49.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF llEditUsed
    @ 13.462,77.000 TO 13.462,99.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF llEditUsed
    @ 14.615,77.200 TO 14.615,99.000 ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

IF llEditUsed
    @ 13.538,77.000 TO 14.692,77.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)
ENDIF

IF llEditUsed
    @ 13.538,98.600 TO 14.692,98.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF

  @ 2.923,4.400 SAY SUBSTR(m.Item,1,7) ;
	SIZE 1.000,17.000 ;
	FONT "MS Sans Serif", 9

  @ 2.923,23.400 SAY m.IClr ;
	SIZE 1.000,14.000 ;
	FONT "MS Sans Serif", 9

  @ 5.538,4.400 SAY m.Desc ;
	SIZE 1.000,49.000 ;
	FONT "MS Sans Serif", 9

IF laSetups[2,2]='Y'
    @ 1.615,72.600 SAY lcText4 ;
	  SIZE 1.000,26.667 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	  COLOR RGB(0,0,0,,,,)
ENDIF 

  @ 10.154,4.400 SAY m.UntQty ;
	SIZE 1.000,13.000 ;
	FONT "MS Sans Serif", 8 ;
	PICTURE "999.999"

  @ 13.615,4.400 SAY m.UntCost ;
	SIZE 1.000,13.000 ;
	FONT "MS Sans Serif", 8 ;
	PICTURE "999.999"

  @ 10.154,24.400 SAY m.Pieces ;
	SIZE 1.000,15.000 ;
	FONT "MS Sans Serif", 8 ;
	PICTURE "99999999"

  @ 13.615,24.400 SAY m.Req_Qty ;
	SIZE 1.000,17.000 ;
	FONT "MS Sans Serif", 8 ;
	PICTURE "99999999.999"

  @ 8.462,52.400 SAY lcText1 ;
	SIZE 1.000,15.833 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,0,,,,)

  @ 13.615,52.400 SAY IIF(llEditUsed,m.Issue_Qty,m.Used_Qty) ;
	SIZE 1.000,17.000 ;
	FONT "MS Sans Serif", 8 ;
	PICTURE "99999999.999"

IF  !llIssue .OR. !INLIST(laSetups[9,2],'F','I')
    @ 8.462,77.400 SAY lcText2 ;
	  SIZE 1.000,15.833 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	  COLOR RGB(0,0,0,,,,)
ENDIF 

  @ 11.923,77.400 SAY lcText3 ;
	SIZE 1.000,21.667 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,0,,,,)

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 17.462,4.400 SAY gfCodDes(m.cOprCode,'MFGCODE') ;
	  SIZE 1.000,45.000 ;
	  FONT "MS Sans Serif", 9
ENDIF 

  @ 11.923,52.400 SAY lcText5 ;
	SIZE 1.000,15.833 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,0,,,,)

*!************************************************************************
*! This Code Generated By Aria Code Generator to refresh the Says Only
*! with out needing to use the show gets
*!************************************************************************
FUNCTION lfRefresh
PARAMETERS lcWindRef
      DO _1up13ismv WITH lcWindRef
*********************** End of Aria Refresh Says Code ***********************  


*       *********************************************************
*       *                                                         
*       * _1UP13ISLM           pbOk VALID                         
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFITMISS,     Record Number:  103  
*       * Variable:            pbOk                               
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      1                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1up13islm     &&  pbOk VALID
#REGION 1
llOk = .T.
IF !llIssue .OR. laSetups[9,2] <> 'L'
  *E301897,1 AHM 06/20/2002 Adding a new paramter to take care of the new button (Edit Used)
  *=lfvItmIss(llIssue,llActCst,llEditUsed)
  =lfvItmIss(llIssue,llActCst,llEditUsed)
  *E301897,1 AHM 06/20/2002 (End)
ELSE
  CLEAR READ
ENDIF

*       *********************************************************
*       *                                                         
*       * _1UP13ISMP           pbCancel VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFITMISS,     Record Number:  104  
*       * Variable:            pbCancel                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      2                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1up13ismp     &&  pbCancel VALID
#REGION 1
llOk = .F.
CLEAR READ
RELEASE WINDOW 'MFITMISS'


*       *********************************************************
*       *                                                         
*       * LFARIAACT           Read Level Activate                 
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFITMISS                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      3                                  
*       *                                                         
*       *********************************************************
*
FUNCTION lfAriaAct     && Read Level Activate
IF TYPE('lcWindNoGr') = 'C' AND !EMPTY(lcWindNoGr)
  DO CASE
    CASE WONTOP() $ lcWindNoGr
      MODIFY WINDOW (WONTOP()) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WONTOP())
    CASE WPARENT(WONTOP()) $ lcWindNoGr
      MODIFY WINDOW (WPARENT(WONTOP())) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WPARENT(WONTOP()))
  ENDCASE
ENDIF

*       *********************************************************
*       *                                                         
*       * LFVY2K           Valid 1900 year                        
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFITMISS                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      4                                  
*       *                                                         
*       *********************************************************
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)

*       *********************************************************
*       *                                                         
*       * _1UP13ISMV           Read Level Show                    
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         MFITMISS                           
*       * Called By:           READ Statement                     
*       * Snippet Number:      5                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _1up13ismv     && Read Level Show
PARAMETERS lcShowWin
lcShowWin=IIF(PARAM()>0 AND TYPE('lcShowWin')='C',lcShowWin,'')
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: MFITMISS
*
#REGION 1
IF ((SYS(2016) = UPPER("mfitmiss") OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER("mfitmiss") $ UPPER(lcShowWin)         
  _1UP13ISNC=IIF(WVISIBLE("mfitmiss"),'SAME','NOSHOW')
	ACTIVATE WINDOW mfitmiss &_1UP13ISNC

  @ 2.923,4.400 SAY SUBSTR(m.Item,1,7) ;
	SIZE 1.000,17.000, 0.000 ;
		FONT "MS Sans Serif", 9

  @ 2.923,23.400 SAY m.IClr ;
	SIZE 1.000,14.000, 0.000 ;
		FONT "MS Sans Serif", 9

  @ 5.538,4.400 SAY m.Desc ;
	SIZE 1.000,49.000, 0.000 ;
		FONT "MS Sans Serif", 9

IF laSetups[2,2]='Y'
    @ 1.615,72.600 SAY lcText4 ;
	  SIZE 1.000,26.667, 0.000 ;
		  FONT "MS Sans Serif", 8 ;
		   STYLE "B" ;
		  COLOR RGB(0,0,0,,,,)
ENDIF 

  @ 10.154,4.400 SAY m.UntQty ;
	SIZE 1.000,13.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "999.999"

  @ 13.615,4.400 SAY m.UntCost ;
	SIZE 1.000,13.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "999.999"

  @ 10.154,24.400 SAY m.Pieces ;
	SIZE 1.000,15.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "99999999"

  @ 13.615,24.400 SAY m.Req_Qty ;
	SIZE 1.000,17.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "99999999.999"

  @ 8.462,52.400 SAY lcText1 ;
	SIZE 1.000,15.833, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,0,,,,)

  @ 13.615,52.400 SAY IIF(llEditUsed,m.Issue_Qty,m.Used_Qty) ;
	SIZE 1.000,17.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "99999999.999"

IF  !llIssue .OR. !INLIST(laSetups[9,2],'F','I')
    @ 8.462,77.400 SAY lcText2 ;
	  SIZE 1.000,15.833, 0.000 ;
		  FONT "MS Sans Serif", 8 ;
		   STYLE "B" ;
		  COLOR RGB(0,0,0,,,,)
ENDIF 

  @ 11.923,77.400 SAY lcText3 ;
	SIZE 1.000,21.667, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,0,,,,)

IF llIssue .AND. !EMPTY(m.cOprCode)
    @ 17.462,4.400 SAY gfCodDes(m.cOprCode,'MFGCODE') ;
	  SIZE 1.000,45.000, 0.000 ;
		  FONT "MS Sans Serif", 9
ENDIF 

  @ 11.923,52.400 SAY lcText5 ;
	SIZE 1.000,15.833, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,0,,,,)
ENDIF
IF NOT EMPTY(currwind)
  _1UP13ISNX=IIF(WVISIBLE(currwind),'SAME','NOSHOW')
	ACTIVATE WINDOW (currwind) &_1UP13ISNX   
ENDIF