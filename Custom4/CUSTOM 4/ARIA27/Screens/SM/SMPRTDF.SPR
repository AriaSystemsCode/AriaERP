*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/19/2006            SMPRTDF.SPR              10:55:41 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2006 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#IF "WINDOWS" $ UPPER(VERSION())
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                SMPRTDF/Windows Setup Code - SECTION 1          
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	PRIVATE m.talk, m.curarea, m.escape, m.fontsize, m.save_font, m.save_fsize,;
	   m.save_orntn, m.save_tmport, m.save_tmland, m.fontalias,;
	   m.menu,lcTopM,lcLeftM
	
	lcTopM="Top margin (pnts) :"
	lcLeftM="Left margin (pnts) :"
	
	EXTERNAL ARRAY attribs, g_pdfiles
	lcSavArea=SELECT(0)
	
	PUSH KEY
	
	IF USED("SYCP_ESC")
	SELECT SYCP_ESC
	ELSE
	SELECT 0
	USE &gcSysHome.sycp_esc.dbf
	ENDIF
	 DIMENSION drivers[RECCOUNT(),1]
	 COPY TO ARRAY drivers FIELDS p_name
	
	
	SELECT 0
	m.fontalias = SYS(2015)
	USE &gcSysHome.SYCFONTS AGAIN ALIAS (m.fontalias)
	
	DIMENSION fontab[RECCOUNT(),1]
	COPY TO ARRAY fontab FIELDS fontname
	
	
	
	IF EMPTY(g_pddriver)
	   g_pddriver = drivers[1]
	ENDIF
	
	m.fontsize = VAL(m.g_pdfontsize)
	
	DIMENSION chg_sets[22]
	
	chg_sets[1] = g_pddriver
	chg_sets[2] = g_pdname
	chg_sets[3] = g_pdorientation
	chg_sets[4] = g_pdstroke
	chg_sets[5] = g_pdstyle
	chg_sets[6] = g_pdfont
	chg_sets[7] = m.fontsize
	chg_sets[8] = g_pdleading
	chg_sets[9] = g_pdlpi
	chg_sets[10] = g_pdcpi
	chg_sets[11] = g_pdtmargin
	chg_sets[12] = g_pdlmargin
	chg_sets[13] = g_pdpgsize
	
	=ACOPY(g_pdfiles, chg_sets, 1, -1, 14)
	
	m.save_font = g_pdfont
	m.save_fsize = m.fontsize
	m.save_orntn = g_pdorientation
	m.save_driv = m.g_pddriver
	
	IF m.g_pddriver = "Postscript"
	   IF m.g_pdorientation = 1
	      m.save_tmport = m.g_pdtmargin
	      m.save_tmland = 20
	   ELSE
	      m.save_tmland = m.g_pdtmargin
	      m.save_tmport = 20
	   ENDIF
	
	   m.save_tmdriv = 2
	ELSE
	   m.save_tmdriv = m.g_pdtmargin
	   m.save_tmport = 20
	   m.save_tmland = 20
	ENDIF
	m.g_pdname = PADR(m.g_pdname,24)
	
	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                      Windows Window definitions                
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
	IF NOT WEXIST("awdsmprtdf") ;   
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.PJX";
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.SCX";      
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.MNX";      
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.PRG";
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.FRX";
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.QPR"      
		DEFINE WINDOW awdsmprtdf ;
			AT  0.000, 0.000  ;
			SIZE 31.167,45.125 ;
			TITLE "Printer Defaults" ;
			FONT "FoxFont", 9 ;
			FLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE ;
			  COLOR RGB(,,,192,192,192) ;
			&lcIcon ;
			IN WINDOW FNDATION
		MOVE WINDOW awdsmprtdf CENTER
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     SMPRTDF/Windows Screen Layout              
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	IF WVISIBLE("awdsmprtdf")
		ACTIVATE WINDOW awdsmprtdf SAME
	    llSayCnt=.F.
	ELSE
		ACTIVATE WINDOW awdsmprtdf NOSHOW
	    llSayCnt=.T.   
	ENDIF
	
	  @ 18.417,3.125 TO 26.167,41.750 ;
	    PEN 1, 8 ;
		  COLOR RGB(255,255,255,,,,)
	
	  @ 18.333,3.000 TO 26.083,41.625 ;
	    PEN 1, 8
	
	  @ 9.083,29.375 TO 17.333,41.750 ;
	    PEN 1, 8 ;
		  COLOR RGB(255,255,255,,,,)
	
	  @ 9.000,29.250 TO 17.250,41.625 ;
	    PEN 1, 8
	
	  @ 9.083,3.125 TO 17.333,27.875 ;
	    PEN 1, 8 ;
		  COLOR RGB(255,255,255,,,,)
	
	  @ 9.000,3.000 TO 17.250,27.750 ;
	    PEN 1, 8
	
	  @ 2.167,3.125 TO 7.584,42.000 ;
	    PEN 1, 8 ;
		  COLOR RGB(255,255,255,,,,)
	
	  @ 2.083,3.000 TO 7.500,41.875 ;
	    PEN 1, 8
	
	  @ 2.750,18.875 SAY "Stroke:"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 2.750,3.875 SAY "Orientation:"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 2.750,30.250 SAY "Style:"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 12.500,9.625 SAY "Size     :"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 18.917,4.000 SAY "Lines per inch:"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 20.750,4.000 SAY "Chars per inch:"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 14.750,9.625 SAY "Leading:"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 12.500,23.625 SAY "pts"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  COLOR RGB(255,0,0,,,,)
	
	  @ 14.750,23.625 SAY "pts"  ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  COLOR RGB(255,0,0,,,,)
	
	  @ 8.000,29.875 SAY " Page size "  ;
		FONT "Times New Roman", 12 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)
	
	  @ 1.083,3.750 SAY " General "  ;
		FONT "Times New Roman", 12 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)
	
	  @ 8.000,3.750 SAY " Fonts "  ;
		FONT "Times New Roman", 12 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)
	
	  @ 17.333,3.750 SAY " Options "  ;
		FONT "Times New Roman", 12 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)
	
	  @ 22.500,39.750 TO 23.917,39.750 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 23.833,37.250 TO 23.833,40.000 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 22.500,21.375 TO 23.917,21.375 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 23.833,18.875 TO 23.833,21.625 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 16.000,16.750 TO 16.000,22.375 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 14.667,22.125 TO 16.084,22.125 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 11.500,4.375 TO 11.500,26.375 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 12.500,22.125 TO 13.917,22.125 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 13.750,16.750 TO 13.750,22.375 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 9.667,26.125 TO 11.584,26.125 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 22.500,37.250 TO 22.500,39.875 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 22.500,18.750 TO 23.917,18.750 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 12.417,16.750 TO 12.417,22.375 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 9.667,4.250 TO 9.667,26.125 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 22.500,37.125 TO 23.917,37.125 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 9.667,4.125 TO 11.584,4.125 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 22.500,18.750 TO 22.500,21.500 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 14.667,16.500 TO 16.084,16.500 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 14.667,16.625 TO 14.667,22.375 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 12.417,16.500 TO 13.834,16.500 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 0.000,0.000 TO 0.000,45.125 ;
	    PEN 1, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 0.000,0.000 TO 31.167,0.000 ;
	    PEN 1, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 0.083,45.000 TO 31.083,45.000 ;
	    PEN 1, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 31.083,0.000 TO 31.083,45.125 ;
	    PEN 1, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 0.250,0.375 TO 0.250,44.750 ;
	    PEN 1, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 0.250,0.375 TO 30.917,0.375 ;
	    PEN 1, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 30.833,0.375 TO 30.833,44.750 ;
	    PEN 1, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 0.250,44.625 TO 30.917,44.625 ;
	    PEN 1, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 30.000,11.500 TO 30.000,21.125 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 27.000,21.000 TO 30.167,21.000 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 30.000,24.000 TO 30.000,33.750 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 27.000,33.500 TO 30.083,33.500 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 27.000,11.500 TO 27.000,21.000 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 27.000,11.250 TO 30.083,11.250 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 27.000,23.750 TO 30.167,23.750 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 27.000,23.875 TO 27.000,33.500 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 27.167,11.500 GET m.g_saved ;
		  PICTURE "@*BHT " + ;
			  lcBtMpOk ;
		  SIZE 2.833,9.500,3.000 ;
		  DEFAULT 1 ;
		FONT "FoxFont", 9 ;
		  VALID _1uq22v2ke() ;
		MESSAGE gfObj_msg()
	
	  @ 27.167,24.000 GET m.g_saved1 ;
		  PICTURE "@*BHT " + ;
			  lcBtMpCan ;
		  SIZE 2.833,9.500,3.000 ;
		  DEFAULT 1 ;
		FONT "FoxFont", 9 ;
		  VALID _1uq22v2kl() ;
		MESSAGE gfObj_msg()
	
	  @ 4.000,5.375 GET m.g_pdorientation ;
		  PICTURE "@*RVN \<Portrait;\<Landscape" ;
		  SIZE 1.308,14.333,0.000 ;
		  DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  VALID _1uq22v2l8() ;
		MESSAGE gfObj_msg() ;
		  COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	
	  @ 4.000,20.500 GET m.g_pdstroke ;
		  PICTURE "@*RVN \<Medium;\<Bold" ;
		  SIZE 1.308,11.667,0.000 ;
		  DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  VALID chk_change(4, "m.g_pdstroke") ;
		MESSAGE gfObj_msg() ;
		  COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	
	  @ 4.000,31.750 GET m.g_pdstyle ;
		  PICTURE "@*RVN \<Upright;\<Italic" ;
		  SIZE 1.308,11.333,0.000 ;
		  DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  VALID chk_change(5, "m.g_pdstyle") ;
		MESSAGE gfObj_msg() ;
		  COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	
	@ 9.167,4.375 GET m.g_pdfont ;
		PICTURE "@^" ;
		FROM fontab ;
		SIZE 1.538,29.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  VALID _1uq22v2mb() ;
		MESSAGE gfObj_msg()
	
	  @ 12.583,16.875 GET m.fontsize ;
		SIZE 1.167,5.000 ;
		RANGE _1uq22v2n8(), _1uq22v2nk() ;
		DEFAULT 0 ;
		FONT "FoxFont", 9 ;
		PICTURE "@K 999.9" ;
		  VALID _1uq22v2nx() ;
		MESSAGE gfObj_msg()
	
	  @ 14.833,16.875 GET m.g_pdleading ;
		SIZE 1.167,5.000 ;
		RANGE 0, 9.99 ;
		DEFAULT 0 ;
		FONT "FoxFont", 9 ;
		PICTURE "@K 99.99" ;
		  VALID chk_change(8, "m.g_pdleading") ;
		MESSAGE gfObj_msg()
	
	  @ 9.750,30.625 GET g_pdpgsize ;
		  PICTURE "@*RVN 8.5 X 11;Legal;A4;A3;8.5 X 12" ;
		  SIZE 1.308,12.500,0.000 ;
		  DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  VALID chk_change(13, "m.g_pdpgsize") ;
		MESSAGE gfObj_msg() ;
		  COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	
	  @ 18.750,17.000 GET m.g_pdlpi ;
		  PICTURE "@*RHN   6;  8" ;
		  SIZE 1.308,7.000,2.000 ;
		  DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  VALID chk_change(9, "m.g_pdlpi") ;
		MESSAGE gfObj_msg() ;
		  COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	
	  @ 20.667,17.000 GET m.g_pdcpi ;
		  PICTURE "@*RHN 10;12;16.7" ;
		  SIZE 1.308,8.667,0.000 ;
		  DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  VALID chk_change(10, "m.g_pdcpi") ;
		MESSAGE gfObj_msg() ;
		  COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	
	  @ 22.667,19.125 GET m.g_pdtmargin ;
		SIZE 1.167,2.000 ;
		DEFAULT 0 ;
		FONT "FoxFont", 9 ;
		PICTURE "@K" ;
		  VALID _1uq22v2o6() ;
		MESSAGE gfObj_msg()
	
	  @ 22.667,37.500 GET m.g_pdlmargin ;
		SIZE 1.167,2.000 ;
		DEFAULT 0 ;
		FONT "FoxFont", 9 ;
		PICTURE "@K" ;
		  VALID chk_change(12, "m.g_pdlmargin") ;
		MESSAGE gfObj_msg()
	
	  @ 24.250,4.000 GET m.g_pdAcomp ;
		  PICTURE "@*C \<Auto Compression" ;
		  SIZE 1.308,22.500 ;
		  DEFAULT 0 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		  COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
	
	  @ 22.667,4.125 SAY lcTopM ;
		SIZE 1.000,18.333 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	  @ 22.667,22.375 SAY lcLeftM ;
		SIZE 1.000,18.333 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
	
	lcWindNoGr = ''
	
	IF NOT WVISIBLE("awdsmprtdf")
		ACTIVATE WINDOW awdsmprtdf     
	ENDIF     
	
	READ CYCLE MODAL ;
		WHEN _1uq22v2oi() ;
		ACTIVATE lfAriaAct() .AND. _1uq22v2oj() ;
		SHOW _1uq22v2ok()
	
	  RELEASE WINDOW awdsmprtdf
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     SMPRTDF/Windows Cleanup Code               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	*B800199 M.H 10/4/95 Adjust the printer driver screen
	SELECT (m.fontalias)
	USE
	
	m.g_pdfontsize = ALLTRIM(STR(m.fontsize,5,1))
	POP KEY
	SELECT(lcSavArea)
	
	
	

#ELIF   !(UPPER(RIGHT(VERSION(),3)) $ "WINDOWSMACUNIX")
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                 SMPRTDF/MS-DOS Setup Code - SECTION 1          
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	PRIVATE m.talk, m.curarea, m.escape, m.fontsize, m.save_font, m.save_fsize,;
	   m.save_orntn, m.save_tmport, m.save_tmland, m.fontalias, m.menu
	
	EXTERNAL ARRAY attribs, g_pdfiles
	lcSavArea=SELECT(0)
	
	PUSH KEY
	
	IF USED("SYCP_ESC")
	SELECT SYCP_ESC
	ELSE
	SELECT 0
	USE &gcSysHome.sycp_esc.dbf
	ENDIF
	 DIMENSION drivers[RECCOUNT(),1]
	 COPY TO ARRAY drivers FIELDS p_name
	
	
	SELECT 0
	m.fontalias = SYS(2015)
	USE &gcSysHome.SYCFONTS AGAIN ALIAS (m.fontalias)
	
	DIMENSION fontab[RECCOUNT(),1]
	COPY TO ARRAY fontab FIELDS fontname
	
	
	
	IF EMPTY(g_pddriver)
	   g_pddriver = drivers[1]
	ENDIF
	
	m.fontsize = VAL(m.g_pdfontsize)
	
	DIMENSION chg_sets[22]
	
	chg_sets[1] = g_pddriver
	chg_sets[2] = g_pdname
	chg_sets[3] = g_pdorientation
	chg_sets[4] = g_pdstroke
	chg_sets[5] = g_pdstyle
	chg_sets[6] = g_pdfont
	chg_sets[7] = m.fontsize
	chg_sets[8] = g_pdleading
	chg_sets[9] = g_pdlpi
	chg_sets[10] = g_pdcpi
	chg_sets[11] = g_pdtmargin
	chg_sets[12] = g_pdlmargin
	chg_sets[13] = g_pdpgsize
	
	=ACOPY(g_pdfiles, chg_sets, 1, -1, 14)
	
	m.save_font = g_pdfont
	m.save_fsize = m.fontsize
	m.save_orntn = g_pdorientation
	m.save_driv = m.g_pddriver
	
	IF m.g_pddriver = "Postscript"
	   IF m.g_pdorientation = 1
	      m.save_tmport = m.g_pdtmargin
	      m.save_tmland = 20
	   ELSE
	      m.save_tmland = m.g_pdtmargin
	      m.save_tmport = 20
	   ENDIF
	
	   m.save_tmdriv = 2
	ELSE
	   m.save_tmdriv = m.g_pdtmargin
	   m.save_tmport = 20
	   m.save_tmland = 20
	ENDIF
	m.g_pdname = PADR(m.g_pdname,24)
	
	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                       MS-DOS Window definitions                
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
	IF NOT WEXIST("awdsmprtdf") ;   
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.PJX";
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.SCX";      
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.MNX";      
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.PRG";
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.FRX";
		OR UPPER(WTITLE("AWDSMPRTDF")) == "AWDSMPRTDF.QPR"      
		DEFINE WINDOW awdsmprtdf ;
			FROM  INT((SROW()-21)/2), INT((SCOL()-55)/2) ;
			TO  INT((SROW()-21)/2)+20, INT((SCOL()-55)/2)+54  ;
			FLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE ;
			   COLOR SCHEME 5
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     SMPRTDF/MS-DOS Screen Layout               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	IF WVISIBLE("awdsmprtdf")
		ACTIVATE WINDOW awdsmprtdf SAME
	    llSayCnt=.F.
	ELSE
		ACTIVATE WINDOW awdsmprtdf NOSHOW
	    llSayCnt=.T.   
	ENDIF
	
	  @ 1,21 SAY "Stroke:" ;
		SIZE 1,7, 0
	
	  @ 1,3 SAY "Orientation:" ;
		SIZE 1,12, 0
	
	  @ 1,36 SAY "Style:" ;
		SIZE 1,6, 0
	
	  @ 0,1 TO 4,51
	
	  @ 12,1 TO 17,51
	
	  @ 5,1 TO 11,33
	
	  @ 7,19 SAY "Size:" ;
		SIZE 1,5, 0
	
	  @ 0,2 SAY " General " ;
		SIZE 1,9, 0
	
	  @ 5,2 SAY " Fonts " ;
		SIZE 1,7, 0
	
	  @ 12,3 SAY " Options " ;
		SIZE 1,9, 0
	
	  @ 13,3 SAY "Lines per inch:" ;
		SIZE 1,15, 0
	
	  @ 14,3 SAY "Chars per inch:" ;
		SIZE 1,15, 0
	
	  @ 9,16 SAY "Leading:" ;
		SIZE 1,8, 0
	
	  @ 7,30 SAY "pts" ;
		SIZE 1,3, 0
	
	  @ 9,30 SAY "pts" ;
		SIZE 1,3, 0
	
	  @ 5,35 TO 11,51
	
	  @ 5,36 SAY " Page Size " ;
		SIZE 1,11, 0
	
	  @ 15,3 SAY "Top margin (pnts):" ;
		SIZE 1,18, 0
	
	  @ 15,27 SAY "Left margin (pnts) :" ;
		SIZE 1,20, 0
	
	  @ 2,5 GET m.g_pdorientation ;
		  PICTURE "@*RVN \<Portrait;\<Landscape" ;
		  SIZE 1,13,0 ;
		  DEFAULT 1 ;
		  VALID _1uq22v2tu() ;
		MESSAGE gfObj_msg()
	
	  @ 2,23 GET m.g_pdstroke ;
		  PICTURE "@*RVN \<Medium;\<Bold" ;
		  SIZE 1,10,0 ;
		  DEFAULT 1 ;
		  VALID chk_change(4, "m.g_pdstroke") ;
		MESSAGE gfObj_msg()
	
	  @ 2,38 GET m.g_pdstyle ;
		  PICTURE "@*RVN \<Upright;\<Italic" ;
		  SIZE 1,11,0 ;
		  DEFAULT 1 ;
		  VALID chk_change(5, "m.g_pdstyle") ;
		MESSAGE gfObj_msg()
	
	  @ 6,36 GET g_pdpgsize ;
		  PICTURE "@*RVN 8.5 X 11;Legal;A4;A3;8.5 X 12" ;
		  SIZE 1,12,0 ;
		  DEFAULT 1 ;
		  VALID chk_change(13, "m.g_pdpgsize") ;
		MESSAGE gfObj_msg()
	
	@ 7,2 GET m.g_pdfont ;
		PICTURE "@^" ;
		FROM fontab ;
		SIZE 3,13 ;
		DEFAULT 1 ;
		  VALID _1uq22v2uw() ;
		MESSAGE gfObj_msg() ;
		   COLOR SCHEME 5, 6
	
	  @ 7,24 GET m.fontsize ;
		SIZE 1,5 ;
		RANGE _1uq22v2vj(), _1uq22v2w3() ;
		DEFAULT 0 ;
		PICTURE "@K 999.9" ;
		  VALID _1uq22v2wf() ;
		MESSAGE gfObj_msg()
	
	  @ 9,24 GET m.g_pdleading ;
		SIZE 1,5 ;
		RANGE 0, 9.99 ;
		DEFAULT 0 ;
		PICTURE "@K 99.99" ;
		  VALID chk_change(8, "m.g_pdleading") ;
		MESSAGE gfObj_msg()
	
	  @ 13,20 GET m.g_pdlpi ;
		  PICTURE "@*RHN  6; 8" ;
		  SIZE 1,6,2 ;
		  DEFAULT 1 ;
		  VALID chk_change(9, "m.g_pdlpi") ;
		MESSAGE gfObj_msg()
	
	  @ 14,20 GET m.g_pdcpi ;
		  PICTURE "@*RHN 10;12;16.7" ;
		  SIZE 1,8,0 ;
		  DEFAULT 1 ;
		  VALID chk_change(10, "m.g_pdcpi") ;
		MESSAGE gfObj_msg()
	
	  @ 15,23 GET m.g_pdtmargin ;
		SIZE 1,2 ;
		DEFAULT 0 ;
		PICTURE "@K" ;
		  VALID _1uq22v2wl() ;
		MESSAGE gfObj_msg()
	
	  @ 15,48 GET m.g_pdlmargin ;
		SIZE 1,2 ;
		DEFAULT 0 ;
		PICTURE "@K" ;
		  VALID chk_change(12, "m.g_pdlmargin") ;
		MESSAGE gfObj_msg()
	
	  @ 16,3 GET m.g_pdAcomp ;
		  PICTURE "@*C \<Auto Compression" ;
		  SIZE 1,20 ;
		  DEFAULT 0
	
	  @ 18,12 GET m.g_saved ;
		  PICTURE "@*HT \!\<OK;\<Cancel" ;
		  SIZE 1,12,4 ;
		  DEFAULT 1 ;
		  VALID _1uq22v2xc() ;
		MESSAGE gfObj_msg()
	
	lcWindNoGr = ''
	
	IF NOT WVISIBLE("awdsmprtdf")
		ACTIVATE WINDOW awdsmprtdf     
	ENDIF     
	
	READ CYCLE MODAL ;
		WHEN _1uq22v2xi() ;
		ACTIVATE _1uq22v2xj() ;
		SHOW _1uq22v2xk()
	
	  RELEASE WINDOW awdsmprtdf
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                      SMPRTDF/MS-DOS Cleanup Code               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	SELECT (m.fontalias)
	USE
	
	m.g_pdfontsize = ALLTRIM(STR(m.fontsize,5,1))
	POP KEY
	SELECT(lcSavArea)
	
	
	

#ENDIF
   

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2KE           m.g_saved VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   59   
*        Variable:            m.g_saved                          
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2ke     &&  m.g_saved VALID
#REGION 1
=gfUpdate()
RETURN


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2KL           m.g_saved1 VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   60   
*        Variable:            m.g_saved1                         
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2kl     &&  m.g_saved1 VALID
#REGION 1
=gfUpdate()
RETURN


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2L8           m.g_pdorientation VALID            
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   61   
*        Variable:            m.g_pdorientation                  
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2l8     &&  m.g_pdorientation VALID
#REGION 1
DO chk_change WITH 3, "m.g_pdorientation"

IF m.save_orntn != m.g_pdorientation
   DO sav_marg
ENDIF

m.save_orntn = m.g_pdorientation


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2MB           m.g_pdfont VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   64   
*        Variable:            m.g_pdfont                         
*        Called By:           VALID Clause                       
*        Object Type:         Popup                              
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2mb     &&  m.g_pdfont VALID
#REGION 1
DO chk_change WITH 6, "m.g_pdfont"
m.save_font = m.g_pdfont

SELECT (m.fontalias)
LOCATE FOR fontname = m.g_pdfont AND printer = m.g_pddriver
IF FOUND()
	DO chk_buttons
ELSE
	SHOW GET m.fontsize DISABLE
	SHOW GET m.g_pdleading DISABLE
	SHOW GET m.g_pdlpi ENABLE
	SHOW GET m.g_pdcpi ENABLE
ENDIF




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2N8           m.fontsize GET Low RANGE           
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   65   
*        Variable:            m.fontsize                         
*        Called By:           GET Low RANGE Clause               
*        Object Type:         Field                              
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2n8     &&  m.fontsize GET Low RANGE
#REGION 1
m.temparea = SELECT(0)
SELECT (m.fontalias)
min = min_pt
SELECT (m.temparea)
RETURN min

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2NK           m.fontsize GET High RANGE          
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   65   
*        Variable:            m.fontsize                         
*        Called By:           GET High RANGE Clause              
*        Object Type:         Field                              
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2nk     &&  m.fontsize GET High RANGE
#REGION 1
m.temparea = SELECT(0)
SELECT (m.fontalias)
max = max_pt
SELECT (m.temparea)
RETURN max

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2NX           m.fontsize VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   65   
*        Variable:            m.fontsize                         
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2nx     &&  m.fontsize VALID
#REGION 1
DO chk_change WITH 7, "m.fontsize"
IF m.save_fsize != m.fontsize
	
	IF m.g_pddriver == "HP LaserJet III               "
		m.g_pdleading = m.fontsize * .6666
	ELSE
		m.g_pdleading = .08 * m.fontsize
	ENDIF
	
	SHOW GET m.g_pdleading
	m.save_fsize = m.fontsize
	g_pdfontsize = ALLTRIM(STR(m.fontsize,5,1))
ENDIF



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2O6           m.g_pdtmargin VALID                
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF,     Record Number:   70   
*        Variable:            m.g_pdtmargin                      
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2o6     &&  m.g_pdtmargin VALID
#REGION 1
DO chk_change WITH 11, "m.g_pdtmargin"
IF m.g_pddriver = "Postscript"
   IF m.g_pdorientation = 1
      m.save_tmport = m.g_pdtmargin
   ELSE
      m.save_tmland = m.g_pdtmargin
   ENDIF
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2OI           Read Level When                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF                            
*        Called By:           READ Statement                     
*        Snippet Number:      9                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2oi     && Read Level When
*
* When Code from screen: SMPRTDF
*
#REGION 1
=gfActHelp()

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFARIAACT           Read Level Activate                 
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF                            
*        Called By:           READ Statement                     
*        Snippet Number:      10                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfAriaAct     && Read Level Activate
IF TYPE('lcWindNoGr') = 'C' AND !EMPTY(lcWindNoGr)
  DO CASE
    CASE WONTOP() $ lcWindNoGr
      MODIFY WINDOW (WONTOP()) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WONTOP())
    CASE WPARENT(WONTOP()) $ lcWindNoGr
      MODIFY WINDOW (WPARENT(WONTOP())) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WPARENT(WONTOP()))
  ENDCASE
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFVY2K           Valid 1900 year                        
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF                            
*        Called By:           READ Statement                     
*        Snippet Number:      11                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)
*
* Activate Code from screen: SMPRTDF
*
FUNCTION _1uq22v2oj
#REGION 1
IF RDLEVEL() = 5 OR MEMORY() < 95
   SHOW GET m.g_pdprocs DISABLE
ELSE
   SHOW GET m.g_pdprocs ENABLE
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2OK           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SMPRTDF                            
*        Called By:           READ Statement                     
*        Snippet Number:      12                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2ok     && Read Level Show
PARAMETERS lcShowWin
lcShowWin=IIF(PARAM()>0 AND TYPE('lcShowWin')='C',lcShowWin,'')
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: SMPRTDF
*
#REGION 1
DO chk_driver

DO chk_change WITH 1, "m.g_pddriver"

IF m.save_driv != "HP LaserJet III               "

	IF m.g_pddriver == "HP LaserJet III               "
		m.g_pdleading = m.fontsize * .6666
	ELSE
		IF m.save_driv != "Postscript                    "
			m.g_pdleading = .08 * m.fontsize
		ENDIF
	ENDIF
ELSE
	IF m.g_pddriver == "Postscript                    "
		m.g_pdleading = .08 * m.fontsize
	ENDIF
ENDIF	

SHOW GET m.g_pdleading

DO sav_marg
m.save_driv = m.g_pddriver

*B800506,1 Disable the screen object at view mode
IF laScrMode[2]
  SHOW GETS DISABLE ONLY
  SHOW GET  m.g_saved,1 ENABLE
ENDIF

IF ((SYS(2016) = UPPER("awdsmprtdf") OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER("awdsmprtdf") $ UPPER(lcShowWin)         
  _1UQ22V2PD=IIF(WVISIBLE("awdsmprtdf"),'SAME','NOSHOW')
	ACTIVATE WINDOW awdsmprtdf &_1UQ22V2PD

  @ 22.667,4.125 SAY lcTopM ;
	SIZE 1.000,18.333, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"

  @ 22.667,22.375 SAY lcLeftM ;
	SIZE 1.000,18.333, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B"
ENDIF
IF NOT EMPTY(currwind)
  _1UQ22V2PG=IIF(WVISIBLE(currwind),'SAME','NOSHOW')
	ACTIVATE WINDOW (currwind) &_1UQ22V2PG   
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2TU           m.g_pdorientation VALID            
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF,     Record Number:   98   
*        Variable:            m.g_pdorientation                  
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      13                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2tu     &&  m.g_pdorientation VALID
#REGION 1
DO chk_change WITH 3, "m.g_pdorientation"

IF m.save_orntn != m.g_pdorientation
   DO sav_marg
ENDIF

m.save_orntn = m.g_pdorientation


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2UW           m.g_pdfont VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF,     Record Number:  102   
*        Variable:            m.g_pdfont                         
*        Called By:           VALID Clause                       
*        Object Type:         Popup                              
*        Snippet Number:      14                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2uw     &&  m.g_pdfont VALID
#REGION 1
DO chk_change WITH 6, "m.g_pdfont"
m.save_font = m.g_pdfont

SELECT (m.fontalias)
LOCATE FOR fontname = m.g_pdfont AND printer = m.g_pddriver
IF FOUND()
	DO chk_buttons
ELSE
	SHOW GET m.fontsize DISABLE
	SHOW GET m.g_pdleading DISABLE
	SHOW GET m.g_pdlpi ENABLE
	SHOW GET m.g_pdcpi ENABLE
ENDIF




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2VJ           m.fontsize GET Low RANGE           
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF,     Record Number:  103   
*        Variable:            m.fontsize                         
*        Called By:           GET Low RANGE Clause               
*        Object Type:         Field                              
*        Snippet Number:      15                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2vj     &&  m.fontsize GET Low RANGE
#REGION 1
m.temparea = SELECT(0)
SELECT (m.fontalias)
min = min_pt
SELECT (m.temparea)
RETURN min

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2W3           m.fontsize GET High RANGE          
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF,     Record Number:  103   
*        Variable:            m.fontsize                         
*        Called By:           GET High RANGE Clause              
*        Object Type:         Field                              
*        Snippet Number:      16                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2w3     &&  m.fontsize GET High RANGE
#REGION 1
m.temparea = SELECT(0)
SELECT (m.fontalias)
max = max_pt
SELECT (m.temparea)
RETURN max

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2WF           m.fontsize VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF,     Record Number:  103   
*        Variable:            m.fontsize                         
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      17                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2wf     &&  m.fontsize VALID
#REGION 1
DO chk_change WITH 7, "m.fontsize"
IF m.save_fsize != m.fontsize
	
	IF m.g_pddriver == "HP LaserJet III               "
		m.g_pdleading = m.fontsize * .6666
	ELSE
		m.g_pdleading = .08 * m.fontsize
	ENDIF
	
	SHOW GET m.g_pdleading
	m.save_fsize = m.fontsize
	g_pdfontsize = ALLTRIM(STR(m.fontsize,5,1))
ENDIF



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2WL           m.g_pdtmargin VALID                
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF,     Record Number:  107   
*        Variable:            m.g_pdtmargin                      
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      18                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2wl     &&  m.g_pdtmargin VALID
#REGION 1
DO chk_change WITH 11, "m.g_pdtmargin"
IF m.g_pddriver = "Postscript"
   IF m.g_pdorientation = 1
      m.save_tmport = m.g_pdtmargin
   ELSE
      m.save_tmland = m.g_pdtmargin
   ENDIF
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2XC           m.g_saved VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF,     Record Number:  110   
*        Variable:            m.g_saved                          
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      19                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2xc     &&  m.g_saved VALID
#REGION 1
=gfUpdate()
RETURN


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2XI           Read Level When                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF                            
*        Called By:           READ Statement                     
*        Snippet Number:      20                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2xi     && Read Level When
*
* When Code from screen: SMPRTDF
*
#REGION 1
=gfActHelp()

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFVY2K           Valid 1900 year                        
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF                            
*        Called By:           READ Statement                     
*        Snippet Number:      21                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)
*
* Activate Code from screen: SMPRTDF
*
FUNCTION _1uq22v2xj
#REGION 1
IF RDLEVEL() = 5 OR MEMORY() < 95
   SHOW GET m.g_pdprocs DISABLE
ELSE
   SHOW GET m.g_pdprocs ENABLE
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22V2XK           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SMPRTDF                            
*        Called By:           READ Statement                     
*        Snippet Number:      22                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22v2xk     && Read Level Show
PARAMETERS lcShowWin
lcShowWin=IIF(PARAM()>0 AND TYPE('lcShowWin')='C',lcShowWin,'')
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: SMPRTDF
*
#REGION 1
DO chk_driver

DO chk_change WITH 1, "m.g_pddriver"

IF m.save_driv != "HP LaserJet III               "

	IF m.g_pddriver == "HP LaserJet III               "
		m.g_pdleading = m.fontsize * .6666
	ELSE
		IF m.save_driv != "Postscript                    "
			m.g_pdleading = .08 * m.fontsize
		ENDIF
	ENDIF
ELSE
	IF m.g_pddriver == "Postscript                    "
		m.g_pdleading = .08 * m.fontsize
	ENDIF
ENDIF	

SHOW GET m.g_pdleading

DO sav_marg
m.save_driv = m.g_pddriver

*B800506,1 Disable the screen object at view mode
IF laScrMode[2]
  SHOW GETS DISABLE ONLY
  SHOW GET  m.g_saved,1 ENABLE
ENDIF

IF NOT EMPTY(currwind)
  _1UQ22V2Z0=IIF(WVISIBLE(currwind),'SAME','NOSHOW')
	ACTIVATE WINDOW (currwind) &_1UQ22V2Z0   
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*          SMPRTDF/MS-DOS Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     SMPRTDF Procedure CHK_CHANGE               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


PROCEDURE CHK_CHANGE
PARAMETERS M.ELEMENT, M.OBJECT
DO CASE
CASE _DOS
	
	IF NOT m.chg_flag AND chg_sets[m.element] != EVAL(m.object)
	   m.chg_flag = .T.
	ENDIF
	
	RETURN
	
	
CASE _WINDOWS
	
	IF NOT m.chg_flag AND chg_sets[m.element] != EVAL(m.object)
	   m.chg_flag = .T.
	ENDIF
	
	RETURN
	
	
ENDCASE

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     SMPRTDF Procedure CHK_DRIVER               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


PROCEDURE CHK_DRIVER
DO CASE
CASE _DOS
	PRIVATE m.numrec, m.recnum
	
		SELECT (m.fontalias)
		LOCATE FOR printer = m.g_pddriver
		m.recnum = RECNO()
		
		IF FOUND()
		
			COUNT FOR printer = m.g_pddriver TO m.numrec
			DIMENSION fontab[m.numrec,1]
			COPY TO ARRAY fontab FOR printer = m.g_pddriver FIELDS fontname
			GOTO m.recnum
			
			IF m.save_driv != m.g_pddriver
			   m.g_pdfont = fontab[1]
			ENDIF
			
			SHOW GET g_pdfont ENABLE
			LOCATE FOR fontname = m.g_pdfont AND printer = m.g_pddriver
			IF FOUND()
				DO chk_buttons
				
			ELSE
				SHOW GET m.fontsize DISABLE
				SHOW GET m.leading DISABLE
				SHOW GET m.lpi ENABLE
				SHOW GET m.cpi ENABLE
			ENDIF
	
		ELSE
			m.g_pdfont = "Courier"
			SHOW GET g_pdfont DISABLE
			SHOW GET m.fontsize DISABLE
			SHOW GET g_pdleading DISABLE
	*		SHOW GET m.g_pdpgsize DISABLE  * Leave Pagesize for all models. GD.
			SHOW GET m.g_pdlmargin DISABLE
			SHOW GET g_pdcpi ENABLE
			SHOW GET g_pdlpi ENABLE
			@ 15,3 SAY "Top Margin (lines):"
			@ 15,27 SAY "Left Margin (lines):"
		ENDIF
	
	RETURN
	
	
CASE _WINDOWS
	PRIVATE m.numrec, m.recnum
	
		SELECT (m.fontalias)
		LOCATE FOR printer = m.g_pddriver
		m.recnum = RECNO()
		
		IF FOUND()
		
			COUNT FOR printer = m.g_pddriver TO m.numrec
			DIMENSION fontab[m.numrec,1]
			COPY TO ARRAY fontab FOR printer = m.g_pddriver FIELDS fontname
			GOTO m.recnum
			
			IF m.save_driv != m.g_pddriver
			   m.g_pdfont = fontab[1]
			ENDIF
			
			SHOW GET g_pdfont ENABLE
			LOCATE FOR fontname = m.g_pdfont AND printer = m.g_pddriver
			IF FOUND()
				DO chk_buttons
				
			ELSE
				SHOW GET m.fontsize DISABLE
				SHOW GET m.leading DISABLE
				SHOW GET m.lpi ENABLE
				SHOW GET m.cpi ENABLE
			ENDIF
			lcTopM  = "Top Margin (pnts) :"
	        lcLeftM = "Left Margin (pnts) :"
	
		ELSE
			m.g_pdfont = "Courier"
			SHOW GET g_pdfont DISABLE
			SHOW GET m.fontsize DISABLE
			SHOW GET g_pdleading DISABLE
	*		SHOW GET m.g_pdpgsize DISABLE  * Leave Pagesize for all models. GD.
			SHOW GET m.g_pdlmargin DISABLE
			SHOW GET g_pdcpi ENABLE
			SHOW GET g_pdlpi ENABLE
	*B800199 M.H 10/4/95 Adjust the printer driver screen
	**Start
			lcTopM  = "Top Margin (lines) :"
	        lcLeftM = "Left Margin (lines) :"
	*		@ 20.846,4.667 SAY "Top Margin (lines):";
	    	FONT "MS Sans Serif", 8 ;
			STYLE "B"
	*		@ 20.846,29.167 SAY "Left Margin (lines):";
	    	FONT "MS Sans Serif", 8 ;
			STYLE "B"
	**End
	*B800199 M.H 10/4/95 Adjust the printer driver screen
		ENDIF
	
	RETURN
	
	
ENDCASE

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     SMPRTDF Procedure CHK_BUTTONS              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


PROCEDURE CHK_BUTTONS
DO CASE
CASE _DOS
		
		*
		* If this is a new driver setup, read the defaults from the FONTS dbf
		*
		
		IF	m.g_action = 2
		
			m.g_pdleading = def_lead
			m.g_pdlmargin = def_lmarg
			m.g_pdtmargin = def_tmarg
			
		ENDIF
		
		SHOW GET m.g_pdtmargin ENABLE
		
		IF fontsize
			SHOW GET m.fontsize ENABLE
		ELSE
			SHOW GET m.fontsize DISABLE
		ENDIF
	
		IF leading
			SHOW GET m.g_pdleading ENABLE
		ELSE
			SHOW GET m.g_pdleading DISABLE
		ENDIF
	
		
	****************************************************************
	* Changed so that all Models can have pagesizes Garydo 11/26/92*
	****************************************************************
		
		
	*	IF pagesize
			SHOW GET m.g_pdpgsize ENABLE
	*	ELSE	
	*		SHOW GET m.g_pdpgsize DISABLE
	*	ENDIF
		
		IF leftmargin
			SHOW GET m.g_pdlmargin ENABLE
		ELSE
			SHOW GET m.g_pdlmargin DISABLE
		ENDIF
		
		IF cpi
			SHOW GET g_pdcpi ENABLE
		ELSE
			SHOW GET g_pdcpi DISABLE
		ENDIF
		
		IF lpi
			SHOW GET g_pdlpi ENABLE
		ELSE
			SHOW GET g_pdlpi DISABLE
		ENDIF
		
		IF printer == "Postscript                    "
		    @ 15,3 SAY "Top Margin (pts) :"
			@ 15,27 SAY "Left Margin (pts) : "
		ELSE
		    @ 15,3 SAY "Top Margin (line):"	
			@ 15,27 SAY "Left Margin (lines):"
		ENDIF
	
	
	RETURN
	
	
CASE _WINDOWS
		
		*
		* If this is a new driver setup, read the defaults from the FONTS dbf
		*
		
		IF	m.g_action = 2
		
			m.g_pdleading = def_lead
			m.g_pdlmargin = def_lmarg
			m.g_pdtmargin = def_tmarg
			
		ENDIF
		
		SHOW GET m.g_pdtmargin ENABLE
		
		IF fontsize
			SHOW GET m.fontsize ENABLE
		ELSE
			SHOW GET m.fontsize DISABLE
		ENDIF
	
		IF leading
			SHOW GET m.g_pdleading ENABLE
		ELSE
			SHOW GET m.g_pdleading DISABLE
		ENDIF
	
		
	****************************************************************
	* Changed so that all Models can have pagesizes Garydo 11/26/92*
	****************************************************************
		
		
	*	IF pagesize
			SHOW GET m.g_pdpgsize ENABLE
	*	ELSE	
	*		SHOW GET m.g_pdpgsize DISABLE
	*	ENDIF
		
		IF leftmargin
			SHOW GET m.g_pdlmargin ENABLE
		ELSE
			SHOW GET m.g_pdlmargin DISABLE
		ENDIF
		
		IF cpi
			SHOW GET g_pdcpi ENABLE
		ELSE
			SHOW GET g_pdcpi DISABLE
		ENDIF
		
		IF lpi
			SHOW GET g_pdlpi ENABLE
		ELSE
			SHOW GET g_pdlpi DISABLE
		ENDIF
		
		IF printer == "Postscript                    "
	*B800199 M.H 10/4/95 Adjust the printer driver screen
	**Start
			lcTopM  = "Top Margin (pnts) :"
	        lcLeftM = "Left Margin (pnts) :"
	*		@ 20.846,4.667 SAY "Top Margin (pnts):"  ;
			FONT "MS Sans Serif", 8 ;
			STYLE "B"
	*    	@ 20.846,29.167 SAY "Left Margin (pnts) :"  ;
			FONT "MS Sans Serif", 8 ;
			STYLE "B"
	**End
	*B800199 M.H 10/4/95 Adjust the printer driver screen
		ELSE
	*B800199 M.H 10/4/95 Adjust the printer driver screen
	**Start
			lcTopM  = "Top Margin (lines) :"
	        lcLeftM = "Left Margin (lines) :"
	*		@ 20.846,4.667 SAY "Top Margin (lines):";
	    	FONT "MS Sans Serif", 8 ;
			STYLE "B"
	*		@ 20.846,29.167 SAY "Left Margin (lines):";
	    	FONT "MS Sans Serif", 8 ;
			STYLE "B"
	**End
	*B800199 M.H 10/4/95 Adjust the printer driver screen
		ENDIF
	
	
	RETURN
	
	
ENDCASE

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      SMPRTDF Procedure SAV_MARG                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


PROCEDURE SAV_MARG
DO CASE
CASE _DOS
	
	IF save_driv = m.g_pddriver
	   IF m.g_pddriver = "Postscript" AND ;
	         m.g_pdorientation != m.save_orntn
	      IF m.g_pdorientation = 1
	         m.save_tmland = m.g_pdtmargin
	         m.g_pdtmargin = m.save_tmport
	      ELSE
	         m.save_tmport = m.g_pdtmargin
	         m.g_pdtmargin = m.save_tmland
	      ENDIF
	   ENDIF
	ELSE
	   IF m.g_pddriver = "Postscript"
	      m.save_tmdriv = m.g_pdtmargin
	
	      m.g_pdtmargin = IIF(m.g_pdorientation = 1, ;
	         m.save_tmport, m.save_tmland)
	   ELSE
	      IF m.save_driv = "Postscript"
	
	         IF m.g_pdorientation = 1
	            m.save_tmport = m.g_pdtmargin
	         ELSE
	            m.save_tmland = m.g_pdtmargin
	         ENDIF
	
	         m.g_pdtmargin = m.save_tmdriv
	
	      ENDIF
	   ENDIF
	ENDIF
	
	SHOW GET m.g_pdtmargin
	
	RETURN
	
	
	
	
CASE _WINDOWS
	
	IF save_driv = m.g_pddriver
	   IF m.g_pddriver = "Postscript" AND ;
	         m.g_pdorientation != m.save_orntn
	      IF m.g_pdorientation = 1
	         m.save_tmland = m.g_pdtmargin
	         m.g_pdtmargin = m.save_tmport
	      ELSE
	         m.save_tmport = m.g_pdtmargin
	         m.g_pdtmargin = m.save_tmland
	      ENDIF
	   ENDIF
	ELSE
	   IF m.g_pddriver = "Postscript"
	      m.save_tmdriv = m.g_pdtmargin
	
	      m.g_pdtmargin = IIF(m.g_pdorientation = 1, ;
	         m.save_tmport, m.save_tmland)
	   ELSE
	      IF m.save_driv = "Postscript"
	
	         IF m.g_pdorientation = 1
	            m.save_tmport = m.g_pdtmargin
	         ELSE
	            m.save_tmland = m.g_pdtmargin
	         ENDIF
	
	         m.g_pdtmargin = m.save_tmdriv
	
	      ENDIF
	   ENDIF
	ENDIF
	
	SHOW GET m.g_pdtmargin
	
	RETURN
	
	
	
	
ENDCASE

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      SMPRTDF Procedure ESCAPEKEY               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*


PROCEDURE ESCAPEKEY
DO CASE
CASE _DOS
	
	g_pddriver = chg_sets[1]
	g_pdname = IIF(m.g_action = 2, "", chg_sets[2])
	g_pdorientation = chg_sets[3]
	g_pdstroke = chg_sets[4]
	g_pdstyle = chg_sets[5]
	g_pdfont = chg_sets[6]
	g_pdfontsize = ALLTRIM(STR(chg_sets[7],5,1))
	g_pdleading = chg_sets[8]
	g_pdlpi = chg_sets[9]
	g_pdcpi = chg_sets[10]
	g_pdtmargin = chg_sets[11]
	g_pdlmargin = chg_sets[12]
	=ACOPY(chg_sets, g_pdfiles , 14, -1)
	m.g_saved = 1
	
	CLEAR READ
	RETURN
	
	
	
CASE _WINDOWS
	
	g_pddriver = chg_sets[1]
	g_pdname = IIF(m.g_action = 2, "", chg_sets[2])
	g_pdorientation = chg_sets[3]
	g_pdstroke = chg_sets[4]
	g_pdstyle = chg_sets[5]
	g_pdfont = chg_sets[6]
	g_pdfontsize = ALLTRIM(STR(chg_sets[7],5,1))
	g_pdleading = chg_sets[8]
	g_pdlpi = chg_sets[9]
	g_pdcpi = chg_sets[10]
	g_pdtmargin = chg_sets[11]
	g_pdlmargin = chg_sets[12]
	=ACOPY(chg_sets, g_pdfiles , 14, -1)
	m.g_saved = 1
	
	CLEAR READ
	RETURN
	
	
	
ENDCASE
