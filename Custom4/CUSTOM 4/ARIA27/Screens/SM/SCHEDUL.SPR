*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/19/2006            SCHEDUL.SPR              10:53:53 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2006 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 FOLDER/Windows Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2
PRIVATE lnLastFold,lnMastRow,lnMastCol
lcFoldPrnt = IIF(TYPE('lcFoldPrnt')='C',lcFoldPrnt,"SCREEN")
lcFolder = IIF(TYPE('lcFolder')='C',lcFolder,SYS(2015))
lnFolderRSt=IIF(TYPE('lnFolderRSt')='N',lnFolderRSt,0)
lnFolderCSt=IIF(TYPE('lnFolderCSt')='N',lnFolderCSt,0)
lnFolderREnd=IIF(TYPE('lnFolderREnd')='N',lnFolderREnd,2.00)
lnFolderCEnd=IIF(TYPE('lnFolderCEnd')='N',lnFolderCEnd,78.500)
lcWFoldChng = IIF(TYPE('lcWFoldChng')='C',lcWFoldChng,'SHOW GETS')
lnActFolder = IIF(TYPE('lnActFolder')='N',lnActFolder,1)
lnLastFold  = lnActFolder
IF TYPE('laFoldWinds[1,1]')<>'C'
  DIMENSION laFoldWinds[1,2]
  STORE '' TO laFoldWinds
  laFoldWinds[1,1]='No Folders Defined'
ENDIF
lcFoldDesc = IIF(TYPE('lcFoldDesc')='C',lcFoldDesc,laFoldWinds[lnActFolder,1])
DIME IBFOLDER[ALEN(laFoldWinds,1)]
STORE 0 TO IBFOLDER

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 CALNDR/Windows Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 4
lcWCalnder =  IIF(TYPE('lcWCalnder')#'C' OR EMPTY(lcWCalnder),'.T.',lcWCalnder)
lnCalRStr =  IIF(TYPE('lnCalRStr')#'N' OR TYPE('lcCalender')#'C',.231,lnCalRStr)
lnCalCStr =  IIF(TYPE('lnCalCStr')#'N' OR TYPE('lcCalender')#'C',.500,lnCalCStr)
lcCalender = IIF(TYPE('lcCalender')#'C',SYS(2015),lcCalender)
lcCalParent = IIF(TYPE('lcCalParent ')#'C','SCREEN',lcCalParent)
DIMEN laCalDays[6,7],laCalCon[6,7],laInv[6,7]
STORE '' TO laCalDays
STORE .F. TO laCalCon
STORE 0 TO laInv
ldCurDate=IIF(TYPE('ldCurDate')#'D',DATE(),ldCurDate)
=lfGetMonDay(ldCurDate)
lnObjNo=ASCAN(laCalDays,PADR(DAY(DATE()),2))
lnObjNo=IIF(lnObjNo>0,lnObjNo,1)
llFromCal = .F.
puCalMon = MONTH(ldCurDate)
SPCALYEAR = YEAR(ldCurDate)
lnObjPos = ASCAN(laCalDays,STR(DAY(ldCurDate),2))
STORE 0 TO lnCurWeek,lnCurDay
IF lnObjPos <> 0
  lnCurWeek = ASUB(laCalDays,lnObjPos,1)
  lnCurDay = ASUB(laCalDays,lnObjPos,2)
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      Windows Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
IF NOT WEXIST((gcbasewind)) ;   
	OR UPPER(WTITLE((GCBASEWIND))) == GCBASEWIND+".PJX";
	OR UPPER(WTITLE((GCBASEWIND))) == GCBASEWIND+".SCX";      
	OR UPPER(WTITLE((GCBASEWIND))) == GCBASEWIND+".MNX";
	OR UPPER(WTITLE((GCBASEWIND))) == GCBASEWIND+".PRG";
	OR UPPER(WTITLE((GCBASEWIND))) == GCBASEWIND+".FRX";
	OR UPPER(WTITLE((GCBASEWIND))) == GCBASEWIND+".QPR"
	lcGrow = ''
	IF _WINDOWS 
	  lcGrow = IIF(RIGHT(OS(1),2)='95','GROW','')
	ENDIF
	DEFINE WINDOW (gcbasewind) ;
		AT  0.000, 0.000  ;
		SIZE 32.500,75.625 ;
		TITLE lcWindTitl ;
		FONT "FoxFont", 9 ;
		FLOAT ;
		CLOSE ;
		MINIMIZE ;
		SYSTEM ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW FNDATION &LCGROW
	MOVE WINDOW (gcbasewind) CENTER
ENDIF

IF NOT WEXIST((lcfolder)) ;   
	OR UPPER(WTITLE((LCFOLDER))) == LCFOLDER+".PJX";
	OR UPPER(WTITLE((LCFOLDER))) == LCFOLDER+".SCX";      
	OR UPPER(WTITLE((LCFOLDER))) == LCFOLDER+".MNX";
	OR UPPER(WTITLE((LCFOLDER))) == LCFOLDER+".PRG";
	OR UPPER(WTITLE((LCFOLDER))) == LCFOLDER+".FRX";
	OR UPPER(WTITLE((LCFOLDER))) == LCFOLDER+".QPR"
	DEFINE WINDOW (lcfolder) ;
		AT 0.667, 1.125 ;
		SIZE lnFolderREnd,lnFolderCEnd ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW (LCFOLDPRNT)
ENDIF

IF NOT WEXIST((lcwinch1)) ;   
	OR UPPER(WTITLE((LCWINCH1))) == LCWINCH1+".PJX";
	OR UPPER(WTITLE((LCWINCH1))) == LCWINCH1+".SCX";      
	OR UPPER(WTITLE((LCWINCH1))) == LCWINCH1+".MNX";
	OR UPPER(WTITLE((LCWINCH1))) == LCWINCH1+".PRG";
	OR UPPER(WTITLE((LCWINCH1))) == LCWINCH1+".FRX";
	OR UPPER(WTITLE((LCWINCH1))) == LCWINCH1+".QPR"
	DEFINE WINDOW (lcwinch1) ;
		AT 2.917, 1.500 ;
		SIZE 25.769,97.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW (GCBASEWIND)
ENDIF

IF NOT WEXIST((lccalender)) ;   
	OR UPPER(WTITLE((LCCALENDER))) == LCCALENDER+".PJX";
	OR UPPER(WTITLE((LCCALENDER))) == LCCALENDER+".SCX";      
	OR UPPER(WTITLE((LCCALENDER))) == LCCALENDER+".MNX";
	OR UPPER(WTITLE((LCCALENDER))) == LCCALENDER+".PRG";
	OR UPPER(WTITLE((LCCALENDER))) == LCCALENDER+".FRX";
	OR UPPER(WTITLE((LCCALENDER))) == LCCALENDER+".QPR"
	DEFINE WINDOW (lccalender) ;
		AT  0.000, 0.000  ;
		SIZE 14.615,42.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		FLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		SYSTEM ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW (LCCALPARENT)
	MOVE WINDOW (lccalender) CENTER
ENDIF

IF NOT WEXIST((lcwinch2)) ;   
	OR UPPER(WTITLE((LCWINCH2))) == LCWINCH2+".PJX";
	OR UPPER(WTITLE((LCWINCH2))) == LCWINCH2+".SCX";      
	OR UPPER(WTITLE((LCWINCH2))) == LCWINCH2+".MNX";
	OR UPPER(WTITLE((LCWINCH2))) == LCWINCH2+".PRG";
	OR UPPER(WTITLE((LCWINCH2))) == LCWINCH2+".FRX";
	OR UPPER(WTITLE((LCWINCH2))) == LCWINCH2+".QPR"
	DEFINE WINDOW (lcwinch2) ;
		AT 2.917, 1.500 ;
		SIZE 27.917,72.750 ;
		FONT "FoxFont", 9 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		  COLOR RGB(,,,192,192,192) ;
		&lcIcon ;
		IN WINDOW (GCBASEWIND)
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 FOLDER/Windows Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2
lnFoldSize=WCOLS(lcFolder)/ALEN(laFoldWinds,1)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     SCHEDUL/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE((gcbasewind))   
	ACTIVATE WINDOW (gcbasewind) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (gcbasewind) NOSHOW
    llSayCnt=.T.   
ENDIF
IF llSayCnt
  DO _1UQ22SQP5 
ENDIF

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     FOLDER/Windows Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2
IF WVISIBLE((lcfolder))   
	ACTIVATE WINDOW (lcfolder) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcfolder) NOSHOW
    llSayCnt=.T.   
ENDIF

   PRIVATE lnCount,lnoldfold
   lnoldfold = lnActFolder
   FOR lnCount = 1 TO ALEN(laFoldWinds,1)
   lnActFolder = lnCount

  @ 0.000,((lnCount-1)*lnFoldSize)+0.077 TO 2.077,lnFoldSize+((lnCount-1)*lnFoldSize)+0.077 ;
    PEN 1, 8 ;
	 STYLE "16" ;
	  COLOR RGB(0,0,0,0,0,0)

  @ 0.077,((lnCount-1)*lnFoldSize)+(2*0.077) TO 2.000,lnFoldSize-(2*0.077)+((lnCount-1)*lnFoldSize)+(2*0.077) ;
    PEN 2, 8 ;
	 STYLE "16" ;
	  COLOR RGB(255,255,255,0,0,0)

  @ 1.615,((lnCount-1)*lnFoldSize)+0.077 TO 2.077,lnFoldSize+((lnCount-1)*lnFoldSize)+0.077 ;
  PATTERN 1 ;
    PEN 1, 8 ;
	  COLOR RGB(192,192,192,192,192,192)

IF lnActFolder<>lnLastFold
    @ 1.615,((lnActFolder-1)*lnFoldSize)+(2*0.077) TO 1.615,lnFoldSize-(2*0.077)+((lnActFolder-1)*lnFoldSize)+(2*0.077) ;
    PEN 2, 8 ;
	   STYLE "1" ;
	     COLOR (IIF(lnActFolder=lnLastFold,'RGB(192,192,192,192,192,192)','RGB(255,255,255,255,255,255)'))
ENDIF

  @ 0.385,((lnCount-1)*lnFoldSize)+(8*0.077) GET IBFolder[lnCount] ;
  	  PICTURE "@*IHN " ;
	  SIZE 1.154,lnFoldSize-(14*0.077),0.167 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	WHEN _1uq22sqpi() ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.) .AND. _1uq22sqps()

  @ 0.385,((lnActFolder-1)*lnFoldSize)+(8*0.077) SAY laFoldWinds[lnActFolder,1] ;
	SIZE 1.000,lnFoldSize-(14*0.077) ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	PICTURE "@I" ;
	  COLOR RGB(0,0,255,,,,)

  @ 0.462,(lnCount*lnFoldSize)-(4*0.077) TO 1.539,(lnCount*lnFoldSize)-(4*0.077) ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,((lnActFolder-1)*lnFoldSize)+0.077 TO 1.538,lnFoldSize+((lnActFolder-1)*lnFoldSize)+0.077 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	   COLOR (IIF(lnActFolder=lnLastFold,'RGB(192,192,192,192,192,192)','RGB(0,0,0,0,0,0)'))

   ENDFOR
   lnActFolder = lnoldfold

  @ 1.538,(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) TO WROWS(lcFolder)+2,(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,((lnLastFold-1)*lnFoldSize)+0.077 TO 1.538,lnFoldSize+((lnLastFold-1)*lnFoldSize)+0.077 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(0,0,0,0,0,0)')

  @ 1.615,((lnLastFold-1)*lnFoldSize)+(2*0.077) TO 1.615,lnFoldSize-(2*0.077)+((lnLastFold-1)*lnFoldSize)+(2*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(255,255,255,255,255,255)')

  @ 1.615,((lnActFolder-1)*lnFoldSize)+(6*0.077) TO 1.615,lnFoldSize-(12*0.077)+((lnActFolder-1)*lnFoldSize)+(6*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(192,192,192,192,192,192)')

  @ WROWS(lcFolder)-.077,0.00 TO WROWS(lcFolder)-.077,0+0.00 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(0,0,0,0,0,0)

  @ WROWS(lcFolder)-.077,0.167 TO WROWS(lcFolder)-.077,0+0.167 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

IF .F.
    @ 1.538,(ALEN(laFoldWinds,1)*lnFoldSize)-(2*0.077) TO WROWS(lcFolder)+2,(ALEN(laFoldWinds,1)*lnFoldSize)-(2*0.077) ;
    PEN 1, 8
ENDIF

IF .F.
    @ WROWS(lcFolder)-.077,WCOLS(lcFolder)-(4*0.077) TO WROWS(lcFolder)-.077,0+WCOLS(lcFolder)-(4*0.077) ;
    PEN 2, 8 ;
	   STYLE "1" ;
	  COLOR RGB(0,0,0,0,0,0)
ENDIF

  @ WROWS(lcFolder)-.077,(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) TO WROWS(lcFolder)-.077,1+(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,((lnActFolder-1)*lnFoldSize)+(4*0.077) TO 1.538,lnFoldSize-(8*0.077)+((lnActFolder-1)*lnFoldSize)+(4*0.077) ;
    PEN 1, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(192,192,192,192,192,192)')

  @ 1.538,0.000 TO WROWS(lcFolder)+2,0.000 ;
    PEN 1, 8 ;
	  COLOR RGB(0,0,0,0,0,0)

  @ 1.538,0.167 TO WROWS(lcFolder)+2,0.167 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.615,0.167 TO 1.615,ALEN(laFoldWinds,1)*lnFoldSize+0 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SCHEDUL0/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 3
IF WVISIBLE((lcwinch1))   
	ACTIVATE WINDOW (lcwinch1) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcwinch1) NOSHOW
    llSayCnt=.T.   
ENDIF
IF llSayCnt
  DO _1UQ22SQQM 
ENDIF

IF .F.
    =lfDrwClnd(7,3)
ENDIF

IF .F.
    @ 6.154,2.167 GET ibDummi2 ;
  	    PICTURE "@*IVN " ;
	    SIZE 12.538,30.667,0.923 ;
	    DEFAULT 0 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	  WHEN lfDoCalnd(7,3,'',0,.F.) ;
	  VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)
ENDIF

IF .F.
    @ 23.000,2.000 GET pbMnYer ;
	    PICTURE "@*HN -Y" ;
	    SIZE 1.769,4.000,1.000 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	    VALID lfvClndKey(7)
ENDIF

IF .F.
    @ 23.000,7.333 GET pbMnMon ;
	    PICTURE "@*HN -M" ;
	    SIZE 1.769,4.000,1.000 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	    VALID lfvClndKey(6)
ENDIF

IF .F.
    @ 23.000,12.667 GET pbMnDay ;
	    PICTURE "@*HN -D" ;
	    SIZE 1.769,4.000,1.000 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	    VALID lfvClndKey(5)
ENDIF

IF .F.
    @ 23.000,18.000 GET pbTod ;
	    PICTURE "@*HN T" ;
	    SIZE 1.769,3.000,1.000 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	    VALID lfvClndKey(4)
ENDIF

IF .F.
    @ 23.000,22.000 GET pbplDay ;
	    PICTURE "@*HN +D" ;
	    SIZE 1.769,4.000,1.000 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	    VALID lfvClndKey(3)
ENDIF

IF .F.
    @ 23.000,27.333 GET pbplMon ;
	    PICTURE "@*HN +M" ;
	    SIZE 1.769,4.000,1.000 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	    VALID lfvClndKey(2)
ENDIF

IF .F.
    @ 23.000,32.667 GET pbplYer ;
	    PICTURE "@*HN +Y" ;
	    SIZE 1.769,4.000,1.000 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	   STYLE "B" ;
	    VALID lfvClndKey(1)
ENDIF

  @ 1.231,34.833 GET lsTasks ;
 	  PICTURE "@&N" ;
	  POPUP puTasks ;
	  SIZE 16.250,28.000 ;
	  DEFAULT " " ;
	FONT "FoxFont", 9 ;
	 STYLE "" ;
	WHEN lfwTasks() ;
	  VALID lfvEdit()

  @ 16.692,34.833 GET lsToDo ;
 	  PICTURE "@&N" ;
	  FROM laToDo ;
	  SIZE 4.615,44.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	WHEN lfwToDo() ;
	  VALID lfvToDo()

@ 2.692,76.333 GET puDUserId ;
	PICTURE "@^" ;
	FROM laUsers ;
	SIZE 1.538,16.167 ;
	DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvUserId()

  @ 6.000,75.333 GET pbEdit ;
	  PICTURE "@*BHN " + ;
		  lcBmp1 ;
	  SIZE 2.923,6.333,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvEdit() ;
	MESSAGE " " &lcEdtStat

  @ 11.615,75.333 GET pbCal ;
	  PICTURE "@*BHN " + ;
		  lcBmp2 ;
	  SIZE 2.923,6.333,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvScdTyp(1,"A")

  @ 15.538,75.333 GET pbApp ;
	  PICTURE "@*BHN " + ;
		  lcBmp3 ;
	  SIZE 2.923,6.333,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvScdTyp(2,"A")

  @ 19.462,75.333 GET pbTodo ;
	  PICTURE "@*BHN " + ;
		  lcBmp4 ;
	  SIZE 2.923,6.333,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvScdTyp(3,"A")

  @ 23.000,42.167 GET pbClose ;
	  PICTURE "@*BHN " + ;
		  lcBmp5 ;
	  SIZE 2.615,12.667,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvClose()

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     CALNDR/Windows Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 4
IF WVISIBLE((lccalender))   
	ACTIVATE WINDOW (lccalender) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lccalender) NOSHOW
    llSayCnt=.T.   
ENDIF

  @ lnCalRStr+1.923,lnCalCStr SAY "Su"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ lnCalRStr+1.923,lnCalCStr+(1*3.5) SAY "Mo"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ lnCalRStr+1.923,lnCalCStr+(2*3.5) SAY "Tu"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ lnCalRStr+1.923,lnCalCStr+(3*3.5) SAY "We"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ lnCalRStr+1.923,lnCalCStr+(4*3.5) SAY "Th"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ lnCalRStr+1.923,lnCalCStr+(5*3.5) SAY "Fr"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ lnCalRStr+1.923,lnCalCStr+(6*3.5) SAY "Sa"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

@ lnCalRStr,lnCalCStr GET puCalMon ;
	PICTURE "@^ January;February;March;April;May;June;July;August;September;October;November;December" ;
	SIZE 1.538,12.667 ;
	DEFAULT "January" ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID _1uq22squo()

  @ lnCalRStr-(2*0.077),lnCalCStr-(4*0.077) TO lnCalRStr-(2*0.077),13+lnCalCStr-(4*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ lnCalRStr+1.538*1.000,lnCalCStr-(4*0.077) TO lnCalRStr+1.538*1.000,13+lnCalCStr-(4*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ lnCalRStr-(2*0.077),lnCalCStr-(4*0.077) TO 1.538+(2*0.077)+lnCalRStr-(2*0.077),lnCalCStr-(4*0.077) ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ lnCalRStr-(2*0.077),lnCalCStr-(0.077)+12.667 TO 1.538+(3*0.077)+lnCalRStr-(2*0.077),lnCalCStr-(0.077)+12.667 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
@ lnCalRStr+.25,lnCalCStr+15.00 GET SpCalYear ;
	SPINNER 1.000, 1900, 2100 ;
	SIZE 0.846, 7.167 ;
	DEFAULT 1900.000 ;
	  VALID _1uq22squs() ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ 0,0 GET IBSTRCL ;
  	  PICTURE "@*IHN " ;
	  SIZE 0,0,0.667 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	WHEN _1uq22sqvc() ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)

  @ 0,0 GET IbCalPrior ;
  	  PICTURE "@*IHN " ;
	  SIZE 0,0,0.667 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	WHEN _1uq22sqvy() ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)

   FOR lnWeek = 1 TO 6
   FOR lnDay  = 1 TO 7

  @ (lnWeek*1.5)+lnCalRStr+2.00,(lnDay-1)*3.5+lnCalCStr GET laCalDays[lnWeek,lnDay] ;
	SIZE 1.000,3.000 ;
	DEFAULT " " ;
	FONT "MS Sans Serif", 8 ;
	WHEN .f. ;
	   COLOR (IIF(lnCurWeek=lnWeek AND lnCurDay=lnDay,',RGB(,,,0,0,255)',',RGB(,,,,,)'))

  @ (lnWeek*1.5)+lnCalRStr+2.00-(3*0.077),(lnDay-1)*3.5+lnCalCStr-0.501 TO (lnWeek*1.5)+lnCalRStr+2.00-(3*0.077),3.000*0.833+(8*0.167)+(lnDay-1)*3.5+lnCalCStr-0.501 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ (lnWeek*1.5)+lnCalRStr+2.00+1.077*1.000+(2*0.077),(lnDay-1)*3.5+lnCalCStr-0.501 TO (lnWeek*1.5)+lnCalRStr+2.00+1.077*1.000+(2*0.077),3.000*0.833+(8*0.167)+(lnDay-1)*3.5+lnCalCStr-0.501 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ (lnWeek*1.5)+lnCalRStr+2.00-(3*0.077),(lnDay-1)*3.5+lnCalCStr-0.668 TO 1.077*1.000+(6*0.077)+(lnWeek*1.5)+lnCalRStr+2.00-(3*0.077),(lnDay-1)*3.5+lnCalCStr-0.668 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ (lnWeek*1.5)+lnCalRStr+2.00-(3*0.077),(lnDay-1)*3.5+lnCalCStr+3.000*0.833+0.501 TO 1.077*1.000+(6*0.077)+(lnWeek*1.5)+lnCalRStr+2.00-(3*0.077),(lnDay-1)*3.5+lnCalCStr+3.000*0.833+0.501 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ (lnWeek*1.5)+lnCalRStr+2.00,(lnDay-1)*3.5+lnCalCStr GET laInv[lnWeek,lnDay] ;
  	  PICTURE "@*IVN " ;
	  SIZE 1.231,2.667,1.000 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	WHEN lfWCalDay() .AND. &lcWCalnder ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)

   ENDFOR &&lnWeek = 1 TO 5
   ENDFOR &&lnDay  = 1 TO 7

  @ 0,0 GET IbCalNext ;
  	  PICTURE "@*IHN " ;
	  SIZE 0,0,0.667 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	WHEN _1uq22sqwo() ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)

  @ 0,0 GET IBEndCL ;
  	  PICTURE "@*IHN " ;
	  SIZE 0,0,0.667 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	WHEN _1uq22sqxo() ;
	VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)

  @ (lnCalRStr+.25)-(5*0.077),(lnCalCStr+14.250) TO (lnCalRStr+.25)-(5*0.077),10.75+(lnCalCStr+14.250) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ (lnCalRStr+.25)+(4*0.077)+0.846*1.000,(lnCalCStr+14.250) TO (lnCalRStr+.25)+(4*0.077)+0.846*1.000,10.75+(lnCalCStr+14.250) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ (lnCalRStr+.25)-(5*0.077),(lnCalCStr+14.250)-(2*0.077) TO 1.500+(lnCalRStr+.25)-(5*0.077),(lnCalCStr+14.250)-(2*0.077) ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ (lnCalRStr+.25)-(5*0.077),(lnCalCStr+14.250)+10.75 TO 1.500+(lnCalRStr+.25)-(5*0.077),(lnCalCStr+14.250)+10.75 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SCHEDUL1/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 5
IF WVISIBLE((lcwinch2))   
	ACTIVATE WINDOW (lcwinch2) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcwinch2) NOSHOW
    llSayCnt=.T.   
ENDIF

  @ 1.083,29.625 TO 4.166,49.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 1.000,29.500 TO 4.083,48.875 ;
    PEN 1, 8

  @ 0.000,30.250 SAY " User "  ;
	FONT "Times New Roman", 12 ;
	 STYLE "B" ;
	  COLOR RGB(255,255,255,,,,)

  @ 23.167,0.500 SAY "Contact"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ 23.167,36.875 SAY "Subject"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B"

  @ 0.083,30.375 SAY " User "  ;
	FONT "Times New Roman", 12 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

  @ 4.583,0.500 TO 4.583,14.625 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,0.500 TO 6.250,0.500 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,14.875 TO 4.583,29.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,14.875 TO 6.250,14.875 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,29.250 TO 4.583,43.375 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,29.250 TO 6.250,29.250 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,43.625 TO 4.583,57.750 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,43.625 TO 6.250,43.625 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,58.000 TO 4.583,72.125 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 4.583,58.000 TO 6.250,58.000 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.167,0.625 TO 6.167,14.750 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.167,15.000 TO 6.167,29.125 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.167,29.375 TO 6.167,43.500 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.167,43.750 TO 6.167,57.875 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.167,58.125 TO 6.167,72.250 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 4.667,14.500 TO 6.334,14.500 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 4.667,28.875 TO 6.334,28.875 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 4.667,43.250 TO 6.334,43.250 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 4.667,57.625 TO 6.334,57.625 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 4.667,72.000 TO 6.334,72.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.667,0.625 TO 6.667,14.750 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.667,15.000 TO 6.667,29.125 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.667,29.375 TO 6.667,43.500 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.667,43.750 TO 6.667,57.875 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.667,58.125 TO 6.667,72.250 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 22.167,0.750 TO 22.167,14.875 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 22.167,15.125 TO 22.167,29.250 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 22.167,29.500 TO 22.167,43.625 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 22.167,43.875 TO 22.167,58.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 22.167,58.250 TO 22.167,72.250 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.667,0.500 TO 22.250,0.500 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.667,14.875 TO 22.250,14.875 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.750,14.500 TO 22.333,14.500 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.667,29.250 TO 22.250,29.250 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.750,28.875 TO 22.250,28.875 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.667,43.625 TO 22.250,43.625 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.750,43.250 TO 22.333,43.250 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.750,58.000 TO 22.333,58.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 6.750,57.625 TO 22.333,57.625 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 6.750,72.000 TO 22.333,72.000 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 23.167,6.375 SAY ":"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 23.167,42.250 SAY ":"  ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "BT"

  @ 1.583,30.875 TO 1.583,47.625 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 3.417,31.000 TO 3.417,47.750 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.583,30.875 TO 3.500,30.875 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.667,47.500 TO 3.584,47.500 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 23.000,7.000 TO 23.000,36.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 24.500,7.125 TO 24.500,36.125 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 23.000,7.000 TO 24.583,7.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 23.083,36.000 TO 24.666,36.000 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 22.917,43.000 TO 22.917,72.000 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 24.417,43.125 TO 24.417,72.125 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 22.917,43.000 TO 24.500,43.000 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 23.000,72.000 TO 24.583,72.000 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.750,1.125 SAY PADC(CMONTH(ldStart) + " , " + ALLTRIM(STR(YEAR(ldStart))) , 15 , " ") ;
	SIZE 1.000,25.857 ;
	FONT "Times New Roman", 12 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

@ 1.083,31.125 GET puWklUsr ;
	PICTURE "@^" ;
	FROM laUsers ;
	SIZE 1.538,21.833 ;
	DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvWklUsr() ;
	DISABLE

  @ 1.000,51.500 GET pbPrv ;
	  PICTURE "@*BHN " + ;
		  lcBmp6 ;
	  SIZE 2.833,9.500,0.750 ;
	  DEFAULT 1 ;
	FONT "FoxFont", 9 ;
	  VALID lfvPrvWeek() ;
	DISABLE

  @ 0.917,62.625 GET pbNext ;
	  PICTURE "@*BHN " + ;
		  lcBmp7 ;
	  SIZE 2.833,9.500,0.750 ;
	  DEFAULT 1 ;
	FONT "FoxFont", 9 ;
	  VALID lfvNxtWeek() ;
	DISABLE

  @ 4.833,1.000 SAY CDOW(ldStart)+" "+STR(DAY(ldStart),2) ;
	SIZE 0.938,17.500 ;
	FONT "Times New Roman", 10 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,255,,,,)

  @ 4.833,15.375 SAY CDOW(ldStart+1)+" "+STR(DAY(ldStart+1),2) ;
	SIZE 0.938,17.500 ;
	FONT "Times New Roman", 10 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,255,,,,)

  @ 4.833,29.750 SAY CDOW(ldStart+2)+" "+STR(DAY(ldStart+2),2) ;
	SIZE 0.938,17.500 ;
	FONT "Times New Roman", 10 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,255,,,,)

  @ 4.833,44.125 SAY CDOW(ldStart+3)+" "+STR(DAY(ldStart+3),2) ;
	SIZE 0.938,17.500 ;
	FONT "Times New Roman", 10 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,255,,,,)

  @ 4.833,58.500 SAY CDOW(ldStart+4)+" "+STR(DAY(ldStart+4),2) ;
	SIZE 0.938,17.500 ;
	FONT "Times New Roman", 10 ;
	 STYLE "B" ;
	  COLOR RGB(0,0,255,,,,)

  @ 6.917,0.875 GET lsTsk1 ;
 	  PICTURE "@&N" ;
	  POPUP puTsk1 ;
	  SIZE 15.000,13.500 ;
	  DEFAULT " " ;
	FONT "FoxFont", 9 ;
	 STYLE "" ;
	WHEN lfwTsk("1") ;
	DISABLE

  @ 6.917,15.250 GET lsTsk2 ;
 	  PICTURE "@&N" ;
	  POPUP puTsk2 ;
	  SIZE 15.000,13.500 ;
	  DEFAULT " " ;
	FONT "FoxFont", 9 ;
	 STYLE "" ;
	WHEN lfwTsk("2") ;
	DISABLE

  @ 6.917,29.625 GET lsTsk3 ;
 	  PICTURE "@&N" ;
	  POPUP puTsk3 ;
	  SIZE 15.000,13.500 ;
	  DEFAULT " " ;
	FONT "FoxFont", 9 ;
	 STYLE "" ;
	WHEN lfwTsk("3") ;
	DISABLE

  @ 6.917,44.000 GET lsTsk4 ;
 	  PICTURE "@&N" ;
	  POPUP puTsk4 ;
	  SIZE 15.000,13.500 ;
	  DEFAULT " " ;
	FONT "FoxFont", 9 ;
	 STYLE "" ;
	WHEN lfwTsk("4") ;
	DISABLE

  @ 6.917,58.375 GET lsTsk5 ;
 	  PICTURE "@&N" ;
	  POPUP puTsk5 ;
	  SIZE 15.000,13.500 ;
	  DEFAULT " " ;
	FONT "FoxFont", 9 ;
	 STYLE "" ;
	WHEN lfwTsk("5") ;
	DISABLE

  @ 23.250,7.500 GET lcWklCont ;
	SIZE 1.167,28.125 ;
	DEFAULT " " ;
	FONT "FoxFont", 9 ;
	WHEN .F. ;
	DISABLE

  @ 23.167,43.500 GET lcWklSub ;
	SIZE 1.167,28.125 ;
	DEFAULT " " ;
	FONT "FoxFont", 9 ;
	WHEN .F. ;
	DISABLE

  @ 24.917,31.625 GET pbClose1 ;
	  PICTURE "@*BHN " + ;
		  lcBmp5 ;
	  SIZE 2.833,9.500,0.750 ;
	  DEFAULT 1 ;
	FONT "FoxFont", 9 ;
	  VALID lfvClose() ;
	DISABLE

lcWindNoGr = ''

IF glFirstime
IF NOT WVISIBLE((lcwinch2))
	ACTIVATE WINDOW (lcwinch2) 
ENDIF
ENDIF &&glFirstime
IF NOT WVISIBLE((lccalender))
	ACTIVATE WINDOW (lccalender) 
ENDIF
IF glFirstime
IF NOT WVISIBLE((lcwinch1))
	ACTIVATE WINDOW (lcwinch1) 
ENDIF
ENDIF &&glFirstime
IF NOT WVISIBLE((lcfolder))
	ACTIVATE WINDOW (lcfolder) 
ENDIF
IF NOT WVISIBLE((gcbasewind))
  MODIFY WINDOW  (gcbasewind) NOGROW              
	ACTIVATE WINDOW (gcbasewind) 
ENDIF



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*           WindowsREAD contains clauses from SCREEN schedul     
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

READ CYCLE ;
	WHEN lfChngFolder(lnActFolder) AND lfObjRef() ;
	ACTIVATE lfAriaAct() ;
	DEACTIVATE lfStopRead() ;
	SHOW _1uq22sr0k() ;
	OBJECT LNCUROBJ COLOR ,&GCREADCLR


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      FOLDER/Windows Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        SCHEDUL/Windows Says Function defined by aria generator 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

PROCEDURE _1UQ22SQP5

  @ 0.000,0.000 TO 0.000,75.625 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.000,0.000 TO 32.500,0.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 32.417,0.000 TO 32.417,75.625 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.000,75.500 TO 32.500,75.500 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.333,0.500 TO 0.333,75.125 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.333,0.500 TO 32.166,0.500 ;
    PEN 1, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 32.083,0.500 TO 32.083,75.125 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.333,75.000 TO 32.166,75.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.333,1.250 TO 31.666,1.250 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 2.333,1.125 TO 31.750,1.125 ;
    PEN 0, 8 ;
	  COLOR RGB(0,0,0,0,0,0)

  @ 31.750,1.250 TO 31.750,74.750 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(0,0,0,0,0,0)

  @ 31.583,1.500 TO 31.583,74.625 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 2.333,74.500 TO 31.666,74.500 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*          FOLDER/Windows Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2
FUNCTION lfGetFolder
PARAMETERS lnRow1,lnCol1,lnRow2,lnCol2,lcContNam,;
           lcReturn,lcDisplay,lcSayVar,lcPopWindo
lnDefBar   = 1
lcCode     = ''
lnFound    = 0
*-- If the popup from array.
IF TYPE('lcPopWindo') ='C'
  DEFINE POPUP lcList ;
         FROM lnRow1+1,lnCol1 TO lnRow2,lnCol2;
         MARGIN ;
         MARK "" ;
         SCROLL;
         SHADOW ;
         IN WINDOW (lcPopWindo)
ELSE
  DEFINE POPUP lcList ;
         FROM lnRow1+1,lnCol1 TO lnRow2,lnCol2;
         MARGIN ;
         SCROLL;
         MARK "" ;
         SHADOW
ENDIF
*-- Fill the popup with the element of the array.
FOR lnI = 1 TO ALEN(&lcContNam,1)
  DEFINE BAR lnI OF lcList PROMPT &lcContNam[lnI,lcDisplay]
ENDFOR

*-- Deactivate the popup on selection any bar.
ON SELECTION POPUP lcList DEACTIVATE POPUP lcList
lnFound = ASCAN(&lcContNam,ALLTRIM(lcSayVar))
IF lnFound > 0
  lnDefBar = ASUBSCRIPT(&lcContNam,lnFound,1)
  lcCode   = &lcContNam[lnDefBar,lcReturn]
ENDIF
ACTIVATE POPUP lcList BAR lnDefBar
RELEASE POPUP lcList
IF LASTKEY() = 13
  lcSayVar = &lcContNam[IIF(BAR()=0 .OR. BAR()>ALEN(&lcContNam,1),1,BAR()),lcDisplay]
  lcCode   = (&lcContNam[IIF(BAR()=0 .OR. BAR()>ALEN(&lcContNam,1),1,BAR()),lcReturn])
  lnActFolder = IIF(BAR()=0 .OR. BAR()>ALEN(&lcContNam,1),1,BAR())
ENDIF
RETURN lcCode


FUNCTION lfChngFolder
PARAMETER lnWindNum
PRIVATE lnWindNum,lcWindName
lcWindName = laFoldWinds[lnWindNum,2]
SHOW GETS WINDOW (lcFolder) OFF
IF !EMPTY(lcWindName) AND WEXIST(lcWindName)
  SHOW WINDOW (lcWindName) TOP
ENDIF
FOR lnCount = 1 TO ALEN(laFoldWinds,1)
  IF !EMPTY(laFoldWinds[lnCount,2]) AND WEXIST(laFoldWinds[lnCount,2]) AND laFoldWinds[lnCount,2]<>lcWindName
    SHOW GETS WINDOW (laFoldWinds[lnCount,2]) DISABLE ONLY
    HIDE WINDOW (laFoldWinds[lnCount,2])
  ENDIF
ENDFOR
IF TYPE('lcWFoldChng')='C'
  &lcWFoldChng
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        SCHEDUL0/Windows Says Function defined by aria generato 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

PROCEDURE _1UQ22SQQM

  @ 2.000,74.167 TO 5.000,97.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 11.231,74.167 TO 23.000,97.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 15.077,74.167 TO 15.077,97.000 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 19.000,74.167 TO 19.000,97.000 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 11.154,74.000 TO 22.923,96.833 ;
    PEN 1, 8

  @ 15.000,74.000 TO 15.000,96.833 ;
    PEN 1, 8 ;
	 STYLE "1"

  @ 18.923,74.000 TO 18.923,96.833 ;
    PEN 1, 8 ;
	 STYLE "1"

  @ 1.923,74.000 TO 4.923,96.833 ;
    PEN 1, 8

  @ 0.769,75.167 SAY " User "  ;
	FONT "Times New Roman", 12 ;
	 STYLE "B" ;
	  COLOR RGB(255,255,255,,,,)

  @ 10.077,75.000 SAY " Schedule "  ;
	FONT "Times New Roman", 12 ;
	 STYLE "B" ;
	  COLOR RGB(255,255,255,,,,)

  @ 5.462,74.000 TO 9.462,96.833 ;
    PEN 1, 8

  @ 5.308,1.167 TO 5.308,33.667 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 5.308,1.167 TO 21.770,1.167 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 21.692,1.333 TO 21.692,33.666 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 5.385,33.667 TO 21.847,33.667 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

IF .F.
    @ 22.538,1.167 TO 25.384,38.500 ;
    PEN 1, 8
ENDIF

IF .F.
    @ 22.615,1.333 TO 25.461,38.666 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)
ENDIF

  @ 12.385,82.000 SAY "Call"  ;
	FONT "Times New Roman", 11 ;
	 STYLE "BT" ;
	  COLOR RGB(255,255,255,,,,)

  @ 16.308,82.000 SAY "Appointment"  ;
	FONT "Times New Roman", 11 ;
	 STYLE "BT" ;
	  COLOR RGB(255,255,255,,,,)

  @ 20.231,82.000 SAY "Todo"  ;
	FONT "Times New Roman", 11 ;
	 STYLE "BT" ;
	  COLOR RGB(255,255,255,,,,)

  @ 12.462,82.167 SAY "Call"  ;
	FONT "Times New Roman", 11 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

  @ 16.385,82.167 SAY "Appointment"  ;
	FONT "Times New Roman", 11 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

  @ 20.308,82.167 SAY "Todo"  ;
	FONT "Times New Roman", 11 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

  @ 0.846,75.333 SAY " User "  ;
	FONT "Times New Roman", 12 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

  @ 10.154,75.167 SAY " Schedule "  ;
	FONT "Times New Roman", 12 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

  @ 5.538,74.167 TO 9.538,97.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 6.769,82.000 SAY "Edit"  ;
	FONT "Times New Roman", 12 ;
	 STYLE "BT" ;
	  COLOR RGB(255,255,255,,,,)

  @ 6.846,82.167 SAY "Edit"  ;
	FONT "Times New Roman", 12 ;
	 STYLE "BT" ;
	  COLOR RGB(0,0,255,,,,)

  @ 0.846,9.000 SAY lcDayStr ;
	SIZE 0.950,14.714 ;
	FONT "Times New Roman", 12 ;
	 STYLE "B" ;
	PICTURE "@I" ;
	  COLOR RGB(0,0,255,,,,)

  @ 2.769,0.833 SAY lcDateExp ;
	SIZE 0.950,29.429 ;
	FONT "Times New Roman", 12 ;
	 STYLE "B" ;
	PICTURE "@I" ;
	  COLOR RGB(0,0,255,,,,)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*          CALNDR/Windows Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 4
FUNCTION lfWCalDay
lcCurObj=VARREAD()
lnCurWeek = VAL(SUBSTR(lcCurObj,7,1))
lnCurDay  = VAL(SUBSTR(lcCurObj,9,1))


DO CASE
  CASE MDOWN() AND laCalCon[lnCurWeek,lnCurDay]
    llFromCal = .T.
    =lfObjColor()
    lcDateSet=SET('DATE')
    SET DATE British
    lcDate= laCalDays[lnCurWeek,lnCurDay]+'/'+ALLT(STR(MONTH(ldCurDate)))+'/'+;
    ALLT(STR(YEAR(ldCurDate)))
    ldCurDate = CTOD(lcDate)
    SET DATE &lcDateSet
  CASE (LASTKEY()=9 OR LASTKEY()=15 ) AND laCalCon[lnCurWeek,lnCurDay]
   IF !llFromCal
     llFromCal = laCalDays[lnCurWeek,lnCurDay] = PADR(DAY(ldCurDate),2)
     IF llFromCal
      =lfObjColor()
     ENDIF
     RETURN llFromCal
   ELSE
     RETURN .F.
   ENDIF
*  CASE LASTKEY()=15 AND laCalCon[lnCurWeek,lnCurDay]
*    IF !llFromCal
*       llFromCal = laCalDays[lnCurWeek,lnCurDay] = PADR(DAY(ldCurDate),2)
*       RETURN llFromCal
*    ELSE
*        RETURN .F.
*    ENDIF
  CASE LASTKEY()=5  AND laCalCon[lnCurWeek,lnCurDay]
     llFromCal = .T.
     _CUROBJ = OBJNUM(IbCalPrior)
    RETURN .T.
  CASE LASTKEY()=24  AND laCalCon[lnCurWeek,lnCurDay]
     llFromCal = .T.
     _CUROBJ = OBJNUM(IbCalNext)
    RETURN .T.
  CASE LASTKEY()=19 AND laCalCon[lnCurWeek,lnCurDay]
    llFromCal = .T.
      ldCurDate=ldCurDate-1
     =lfObjColor()
      RETURN .T.
  CASE LASTKEY()=4  AND laCalCon[lnCurWeek,lnCurDay]
    llFromCal = .T.
    ldCurDate=ldCurDate+1
     =lfObjColor()
    RETURN .T.
ENDCASE

RETURN laCalCon[lnCurWeek,lnCurDay]

FUNCTION lfGetMonDay
PARAMETERS ldDate
STORE '' TO laCalDays
STORE .F. TO laCalCon
ldDate=IIF(TYPE('ldDate')='D',ldDate,DATE())

lnStrtDay=IIF(DAY(ldDate)>1,DOW(ldDate-day(ldDate-1))-1,DOW(ldDate)-1)
lnStrtMon=IIF(DAY(ldDate)>1,ldDate-day(ldDate-1),ldDate)
FOR lnDate = 0 TO 31
  IF MONTH(lnStrtMon+lnDate) = MONTH(lnStrtMon)
    laCalDays[lnStrtDay+DAY(lnStrtMon+lnDate)] = PADR(DAY(lnStrtMon+lnDate),2)
    laCalCon[lnStrtDay+DAY(lnStrtMon+lnDate)] = .T.
    SHOW GET laCalCon[lnStrtDay+DAY(lnStrtMon+lnDate)]
  ENDIF
ENDFOR


FUNCTION lfObjColor
SHOW GETS WINDOW (lcCalender) COLOR SCHEME 1
lcColor=SCHEME(1)
lcColor1=SCHEME(1,6)
lcColor2=SCHEME(1,2)
lcColor=STRTRAN(lcColor,lcColor2,lcColor1,1)
SHOW GET laCalDays[lnCurWeek,lnCurDay] COLOR &lcColor


*!************************************************************************
*! This Code Generated By Aria Code Generator to refresh the Says Only
*! with out needing to use the show gets
*!************************************************************************
FUNCTION lfScdRef
PARAMETERS lcWindRef
      DO _1uq22sr0k WITH lcWindRef
*********************** End of Aria Refresh Says Code ***********************  


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQPI           IBFolder[lnCount] WHEN             
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         FOLDER,     Record Number:    7    
*        Variable:            IBFolder[lnCount]                  
*        Called By:           WHEN Clause                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22sqpi     &&  IBFolder[lnCount] WHEN
#REGION 2
llMousePress = MDOWN()
IF VAL(STRTRAN(SUBSTR(VARREAD(),ATC('(',VARREAD())+1),')')) =  lnActFolder OR llMousePress
  RETURN .T.
ELSE
  IF LASTKEY()=148 &&OR llMousePress
    KEYBOARD "{SPACEBAR}" CLEAR
  ELSE
    RETURN .F.
  ENDIF
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQPS           IBFolder[lnCount] VALID            
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         FOLDER,     Record Number:    7    
*        Variable:            IBFolder[lnCount]                  
*        Called By:           VALID Clause                       
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22sqps     &&  IBFolder[lnCount] VALID
#REGION 2
PRIVATE lcOldWind
IF !EMPTY(laFoldWinds[1,1])
  lnOldWind = lnActFolder
  lnActFolder=VAL(STRTRAN(SUBSTR(VARREAD(),ATC('(',VARREAD())+1),')'))
  IF !(lnOldWind==lnActFolder)
    lnLastFold = lnOldWind
    =lfChngFolder(lnActFolder)
  ENDIF
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQUO           puCalMon VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         CALNDR,     Record Number:    9    
*        Variable:            puCalMon                           
*        Called By:           VALID Clause                       
*        Object Type:         Popup                              
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22squo     &&  puCalMon VALID
#REGION 4
IF MONTH(ldCurDate) <> PUCALMON
  lnDay = DAY(ldCurDate)
  lnYear=Year(ldCurDate)
  DO WHILE EMPTY(DAY(CTOD(STR(PUCALMON,2)+'/'+STR(lnDay,2)+'/'+STR(LNYEAR,4))))
    lnDay = lnDay-1
  ENDDO
  ldcurdate = CTOD(STR(PUCALMON,2)+'/'+STR(lnDay,2)+'/'+STR(LNYEAR,4))
  =lfGetMonDay(ldCurDate)
  SHOW GETS WINDOW (lcCalender) ONLY
  _CUROBJ = OBJNUM(IBSTRCL)
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQUS           SpCalYear VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         CALNDR,     Record Number:   14    
*        Variable:            SpCalYear                          
*        Called By:           VALID Clause                       
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22squs     &&  SpCalYear VALID
#REGION 4
IF YEAR(ldCurDate) <> SPCALYEAR
  lnDay = DAY(ldCurDate)
  lnMonth=Month(ldCurDate)
  DO WHILE EMPTY(DAY(CTOD(STR(lnMonth,2)+'/'+STR(lnDay,2)+'/'+STR(spCalYear,4))))
    lnDay = lnDay-1
  ENDDO
  ldcurdate = CTOD(STR(lnMonth,2)+'/'+STR(lnDay,2)+'/'+STR(spCalYear,4))
  =lfGetMonDay(ldCurDate)
  SHOW GETS WINDOW (lcCalender) ONLY
  lnObjPos = ASCAN(laCalDays,STR(lnDay,2))
  IF lnObjPos <> 0
    lnCurWeek = ASUB(laCalDays,lnObjPos,1)
    lnCurDay = ASUB(laCalDays,lnObjPos,2)
    =lfObjColor()
  ENDIF
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQVC           IBSTRCL WHEN                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         CALNDR,     Record Number:   15    
*        Variable:            IBSTRCL                            
*        Called By:           WHEN Clause                        
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22sqvc     &&  IBSTRCL WHEN
#REGION 4
llFromCal = .F.
RETURN .F.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQVY           IbCalPrior WHEN                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         CALNDR,     Record Number:   16    
*        Variable:            IbCalPrior                         
*        Called By:           WHEN Clause                        
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22sqvy     &&  IbCalPrior WHEN
#REGION 4
IF !llFromCal
 KEYBOARD "{TAB}" PLAIN CLEAR
 RETURN .T.
ELSE
 lnNegDays = IIF(LASTKEY()=5,7,1)
 IF LASTKEY() = 19 OR LASTKEY() = 5
   =lfGetMonDay(ldCurDate-lnNegDays )
   ldCurDate=ldCurDate-lnNegDays
   SHOW GETS WINDOW (lcCalender) ONLY
   puCalMon = MONTH(ldCurDate)
   SPCALYEAR = YEAR(ldCurDate)
   llFromCal = .F.
   KEYBOARD "{TAB}" PLAIN CLEAR
   RETURN .T.
 ENDIF
ENDIF
RETURN .F.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQWO           IbCalNext WHEN                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         CALNDR,     Record Number:   25    
*        Variable:            IbCalNext                          
*        Called By:           WHEN Clause                        
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22sqwo     &&  IbCalNext WHEN
#REGION 4
IF !llFromCal
* KEYBOARD "{SHIFT+TAB}" PLAIN CLEAR
* RETURN .T.
ELSE
 lnNextDay = IIF(LASTKEY()=24,7,1)
 IF LASTKEY() = 4 OR LASTKEY()=24
   =lfGetMonDay(ldCurDate+lnNextDay )
   ldCurDate=ldCurDate + lnNextDay
   SHOW GETS WINDOW (lcCalender) ONLY
   puCalMon = MONTH(ldCurDate)
   SPCALYEAR = YEAR(ldCurDate)
   llFromCal = .F.
   _CUROBJ = OBJNUM(IBSTRCL)
*   KEYBOARD "{SHIFT+TAB}" PLAIN CLEAR
   RETURN
 ENDIF
ENDIF
RETURN .F.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SQXO           IBEndCL WHEN                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         CALNDR,     Record Number:   26    
*        Variable:            IBEndCL                            
*        Called By:           WHEN Clause                        
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22sqxo     &&  IBEndCL WHEN
#REGION 4
llFromCal = .F.
RETURN .F.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFARIAACT           Read Level Activate                 
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         Multiple Screens                   
*        Called By:           READ Statement                     
*        Snippet Number:      9                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfAriaAct     && Read Level Activate
IF TYPE('lcWindNoGr') = 'C' AND !EMPTY(lcWindNoGr)
  DO CASE
    CASE WONTOP() $ lcWindNoGr
      MODIFY WINDOW (WONTOP()) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WONTOP())
    CASE WPARENT(WONTOP()) $ lcWindNoGr
      MODIFY WINDOW (WPARENT(WONTOP())) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WPARENT(WONTOP()))
  ENDCASE
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFVY2K           Valid 1900 year                        
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         Multiple Screens                   
*        Called By:           READ Statement                     
*        Snippet Number:      10                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1UQ22SR0K           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         Multiple Screens                   
*        Called By:           READ Statement                     
*        Snippet Number:      11                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1uq22sr0k     && Read Level Show
PARAMETERS lcShowWin
lcShowWin=IIF(PARAM()>0 AND TYPE('lcShowWin')='C',lcShowWin,'')
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: SCHEDUL
*
#REGION 1
IF ((SYS(2016) = UPPER(gcbasewind) OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER(gcbasewind) $ UPPER(lcShowWin)         
  _1UQ22SR11=IIF(WVISIBLE((gcbasewind)),'SAME','NOSHOW')
	ACTIVATE WINDOW (gcbasewind) &_1UQ22SR11
ENDIF
*
* Show Code from screen: FOLDER
*
#REGION 2
IF ((SYS(2016) = UPPER(lcfolder) OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER(lcfolder) $ UPPER(lcShowWin)         
  _1UQ22SR13=IIF(WVISIBLE((lcfolder)),'SAME','NOSHOW')
	ACTIVATE WINDOW (lcfolder) &_1UQ22SR13

  @ 0.385,((lnActFolder-1)*lnFoldSize)+(8*0.077) SAY laFoldWinds[lnActFolder,1] ;
	SIZE 1.000,lnFoldSize-(14*0.077), 0.000 ;
		FONT "MS Sans Serif", 8 ;
		 STYLE "B" ;
		PICTURE "@I" ;
		  COLOR RGB(0,0,255,,,,)

  @ 1.538,(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) TO WROWS(lcFolder)+2,(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,((lnLastFold-1)*lnFoldSize)+0.077 TO 1.538,lnFoldSize+((lnLastFold-1)*lnFoldSize)+0.077 ;
    PEN 1, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(0,0,0,0,0,0)')

  @ 1.615,((lnLastFold-1)*lnFoldSize)+(2*0.077) TO 1.615,lnFoldSize-(2*0.077)+((lnLastFold-1)*lnFoldSize)+(2*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(255,255,255,255,255,255)')

  @ 1.615,((lnActFolder-1)*lnFoldSize)+(6*0.077) TO 1.615,lnFoldSize-(12*0.077)+((lnActFolder-1)*lnFoldSize)+(6*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(192,192,192,192,192,192)')

  @ WROWS(lcFolder)-.077,0.167 TO WROWS(lcFolder)-.077,0+0.167 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

IF .F.
    @ 1.538,(ALEN(laFoldWinds,1)*lnFoldSize)-(2*0.077) TO WROWS(lcFolder)+2,(ALEN(laFoldWinds,1)*lnFoldSize)-(2*0.077) ;
    PEN 1, 8
ENDIF

  @ WROWS(lcFolder)-.077,(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) TO WROWS(lcFolder)-.077,1+(ALEN(laFoldWinds,1)*lnFoldSize)-(4*0.077) ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 1.538,((lnActFolder-1)*lnFoldSize)+(4*0.077) TO 1.538,lnFoldSize-(8*0.077)+((lnActFolder-1)*lnFoldSize)+(4*0.077) ;
    PEN 1, 8 ;
	 STYLE "1" ;
	   COLOR ('RGB(192,192,192,192,192,192)')

  @ 1.538,0.000 TO WROWS(lcFolder)+2,0.000 ;
    PEN 1, 8 ;
	  COLOR RGB(0,0,0,0,0,0)

  @ 1.538,0.167 TO WROWS(lcFolder)+2,0.167 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)
ENDIF
*
* Show Code from screen: SCHEDUL0
*
#REGION 3
IF ((SYS(2016) = UPPER(lcwinch1) OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER(lcwinch1) $ UPPER(lcShowWin)         
  _1UQ22SR2K=IIF(WVISIBLE((lcwinch1)),'SAME','NOSHOW')
	ACTIVATE WINDOW (lcwinch1) &_1UQ22SR2K

  @ 0.846,9.000 SAY lcDayStr ;
	SIZE 0.950,14.714, 0.000 ;
		FONT "Times New Roman", 12 ;
		 STYLE "B" ;
		PICTURE "@I" ;
		  COLOR RGB(0,0,255,,,,)

  @ 2.769,0.833 SAY lcDateExp ;
	SIZE 0.950,29.429, 0.000 ;
		FONT "Times New Roman", 12 ;
		 STYLE "B" ;
		PICTURE "@I" ;
		  COLOR RGB(0,0,255,,,,)
ENDIF
*
* Show Code from screen: CALNDR
*
#REGION 4
IF ((SYS(2016) = UPPER(lccalender) OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER(lccalender) $ UPPER(lcShowWin)         
  _1UQ22SR2N=IIF(WVISIBLE((lccalender)),'SAME','NOSHOW')
	ACTIVATE WINDOW (lccalender) &_1UQ22SR2N
ENDIF
*
* Show Code from screen: SCHEDUL1
*
#REGION 5
IF ((SYS(2016) = UPPER(lcwinch2) OR SYS(2016) = "*") AND EMPTY(lcShowWin)) OR UPPER(lcwinch2) $ UPPER(lcShowWin)         
  _1UQ22SR2Q=IIF(WVISIBLE((lcwinch2)),'SAME','NOSHOW')
	ACTIVATE WINDOW (lcwinch2) &_1UQ22SR2Q
	@ 1.750,1.125 CLEAR TO 2.750,26.982

  @ 1.750,1.125 SAY PADC(CMONTH(ldStart) + " , " + ALLTRIM(STR(YEAR(ldStart))) , 15 , " ") ;
	SIZE 1.000,25.857, 0.000 ;
		FONT "Times New Roman", 12 ;
		 STYLE "BT" ;
		  COLOR RGB(0,0,255,,,,)

  @ 4.833,1.000 SAY CDOW(ldStart)+" "+STR(DAY(ldStart),2) ;
	SIZE 0.938,17.500, 0.000 ;
		FONT "Times New Roman", 10 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)

  @ 4.833,15.375 SAY CDOW(ldStart+1)+" "+STR(DAY(ldStart+1),2) ;
	SIZE 0.938,17.500, 0.000 ;
		FONT "Times New Roman", 10 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)

  @ 4.833,29.750 SAY CDOW(ldStart+2)+" "+STR(DAY(ldStart+2),2) ;
	SIZE 0.938,17.500, 0.000 ;
		FONT "Times New Roman", 10 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)

  @ 4.833,44.125 SAY CDOW(ldStart+3)+" "+STR(DAY(ldStart+3),2) ;
	SIZE 0.938,17.500, 0.000 ;
		FONT "Times New Roman", 10 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)

  @ 4.833,58.500 SAY CDOW(ldStart+4)+" "+STR(DAY(ldStart+4),2) ;
	SIZE 0.938,17.500, 0.000 ;
		FONT "Times New Roman", 10 ;
		 STYLE "B" ;
		  COLOR RGB(0,0,255,,,,)
ENDIF
IF NOT EMPTY(currwind)
  _1UQ22SR35=IIF(WVISIBLE(currwind),'SAME','NOSHOW')
	ACTIVATE WINDOW (currwind) &_1UQ22SR35   
ENDIF