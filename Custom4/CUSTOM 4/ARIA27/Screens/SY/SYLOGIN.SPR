*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        09/05/2006            SYLOGIN.SPR              14:58:19 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2006 ARIA SYSTEMS                         
*        48 - 7 st                                               
*        CAIRO - EGYPT,     Zip                                  
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#IF "WINDOWS" $ UPPER(VERSION())
	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.rborder = SET("READBORDER")
	SET READBORDER ON
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                      Windows Window definitions                
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
	IF NOT WEXIST("gwdlog_in") ;   
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.PJX";
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.SCX";      
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.MNX";      
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.PRG";
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.FRX";
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.QPR"      
		DEFINE WINDOW gwdlog_in ;
			AT  0.000, 0.000  ;
			SIZE 33.333,65.000 ;
			FONT "FOXFONT", 10 ;
			FLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE ;
			  COLOR RGB(,,,192,192,192) ;
			&lcIcon
		MOVE WINDOW gwdlog_in CENTER
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                SYLOGIN/Windows Setup Code - SECTION 2          
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	*300271,1 get the number of users currently logged in
	lnCurUsers = gfUserList(.T.)
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     SYLOGIN/Windows Screen Layout              
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	IF WVISIBLE("gwdlog_in")
		ACTIVATE WINDOW gwdlog_in SAME
	    llSayCnt=.F.
	ELSE
		ACTIVATE WINDOW gwdlog_in NOSHOW
	    llSayCnt=.T.   
	ENDIF
	
	  @ 4.167,28.000 GET ibDummi ;
	  	  PICTURE "@*IVN " ;
		  SIZE 1.000,1.000,1.000 ;
		  DEFAULT 0 ;
		FONT "FOXFONT", 10 ;
		WHEN _1sr0w39fz() ;
		VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)
	@ 2.500,3.750 SAY Syclogo.glogo ;
		SIZE 16.667,57.625 ;
		CENTER ;
		ISOMETRIC ;
		 STYLE ""
	
	IF llReLogIn
	    @ 25.917,6.250 SAY "User ID     :"  ;
		  FONT "MS Sans Serif", 10 ;
		   STYLE "BT"
	ENDIF 
	
	IF llReLogIn
	    @ 26.167,18.375 GET lcUser_ID ;
		  SIZE 1.000,10.625 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN llUsErChang ;
		    VALID lfvUsr_ID() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF llReLogIn
	    @ 25.917,18.000 TO 25.917,29.625 ;
	    PEN 2, 8 ;
		   STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	ENDIF
	
	IF llReLogIn
	    @ 27.250,18.000 TO 27.250,29.625 ;
	    PEN 2, 8 ;
		   STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	ENDIF
	
	IF llReLogIn
	    @ 25.917,17.875 TO 27.334,17.875 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	ENDIF
	
	IF llReLogIn
	    @ 25.917,29.375 TO 27.334,29.375 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	ENDIF
	
	IF llReLogIn
	    @ 29.583,6.250 SAY "Password :"  ;
		  FONT "MS Sans Serif", 10 ;
		   STYLE "BT"
	ENDIF 
	
	IF llReLogIn
	    @ 29.667,18.375 GET laUsr_Pass[1] ;
		  SIZE 1.000,1.375 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.667,19.375 GET laUsr_Pass[2] ;
		  SIZE 1.000,1.000 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.667,20.375 GET laUsr_Pass[3] ;
		  SIZE 1.000,1.000 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.667,21.375 GET laUsr_Pass[4] ;
		  SIZE 1.000,1.000 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.667,22.375 GET laUsr_Pass[5] ;
		  SIZE 1.000,1.125 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.667,23.500 GET laUsr_Pass[6] ;
		  SIZE 1.000,1.000 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.667,24.375 GET laUsr_Pass[7] ;
		  SIZE 1.000,1.000 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.667,25.375 GET laUsr_Pass[8] ;
		  SIZE 1.000,1.000 ;
		  DEFAULT " " ;
		  FONT "FOXFONT", 10 ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,N/N
	ENDIF
	
	IF llReLogIn
	    @ 29.417,18.000 TO 29.417,27.000 ;
	    PEN 2, 8 ;
		   STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	ENDIF
	
	IF llReLogIn
	    @ 30.750,18.000 TO 30.750,27.000 ;
	    PEN 2, 8 ;
		   STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	ENDIF
	
	IF llReLogIn
	    @ 29.417,17.875 TO 30.834,17.875 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	ENDIF
	
	IF llReLogIn
	    @ 29.417,26.750 TO 30.834,26.750 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	ENDIF
	
	  @ 0.000,0.000 TO 0.000,65.000 ;
	    PEN 4, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 0.000,0.000 TO 33.000,0.000 ;
	    PEN 4, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 0.333,64.625 TO 33.000,64.625 ;
	    PEN 4, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 33.000,0.000 TO 33.000,65.000 ;
	    PEN 4, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 1.167,1.625 TO 31.917,63.250 ;
	    PEN 1, 8 ;
		 STYLE "16"
	
	  @ 1.250,1.750 TO 32.000,63.375 ;
	    PEN 1, 8 ;
		 STYLE "16" ;
		  COLOR RGB(255,255,255,,,,)
	
	  @ 2.333,3.500 TO 2.333,61.500 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 2.500,3.500 TO 19.250,3.500 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 2.417,61.375 TO 19.250,61.375 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 19.167,3.625 TO 19.167,61.625 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 22.750,6.750 SAY "Maximum no. of users   : "  ;
		FONT "MS Sans Serif", 8
	
	  @ 22.833,22.625 SAY gnMaxUsers ;
		SIZE 1.167,3.000 ;
		FONT "FoxFont", 9 ;
		PICTURE "999"
	
	  @ 22.417,22.125 TO 22.417,26.125 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 23.917,22.125 TO 23.917,26.125 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 22.583,22.125 TO 24.166,22.125 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 22.667,26.000 TO 24.167,26.000 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 22.750,32.375 SAY "Currently logged users  :"  ;
		FONT "MS Sans Serif", 8
	
	  @ 22.833,48.250 SAY lnCurUsers ;
		SIZE 1.167,3.000 ;
		FONT "FoxFont", 9 ;
		PICTURE "999"
	
	  @ 22.583,47.875 TO 22.583,51.875 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 24.083,47.875 TO 24.083,51.875 ;
	    PEN 2, 8 ;
		 STYLE "1" ;
		  COLOR RGB(128,128,128,128,128,128)
	
	  @ 22.667,47.750 TO 24.250,47.750 ;
	    PEN 2, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 22.750,51.625 TO 24.250,51.625 ;
	    PEN 2, 8 ;
		  COLOR RGB(128,128,128,128,128,128)
	
	IF llReLogIn
	    @ 25.000,49.375 GET pbOk_Cncl ;
		    PICTURE "@*BVN " + ;
			    (LOCFILE("bmps\ok.bmp","BMP|ICO","Where is ok?")) + ";" + ;
			    (LOCFILE("bmps\can.bmp","BMP|ICO","Where is can?")) ;
		    SIZE 2.833,9.500,0.833 ;
		    DEFAULT 1 ;
		  FONT "FOXFONT", 10 ;
		  WHEN lfwOK_CNCL() ;
		    VALID lfvOK_CNCL()
	ENDIF
	
	  @ 19.667,1.625 TO 19.667,63.000 ;
	    PEN 1, 8 ;
		 STYLE "1"
	
	  @ 19.750,1.750 TO 19.750,63.125 ;
	    PEN 1, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	  @ 24.500,1.625 TO 24.500,63.125 ;
	    PEN 1, 8 ;
		 STYLE "1"
	
	  @ 24.583,1.750 TO 24.583,63.250 ;
	    PEN 1, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	IF glLog_Requ
	    @ 24.500,40.875 TO 31.833,40.875 ;
	    PEN 1, 8
	ENDIF
	
	IF glLog_Requ
	    @ 24.667,41.000 TO 31.917,41.000 ;
	    PEN 1, 8 ;
		  COLOR RGB(255,255,255,255,255,255)
	ENDIF
	
	  @ 22.667,47.875 GET pbwho ;
	  	  PICTURE "@*IHN " ;
		  SIZE 1.583,4.000,0.500 ;
		  DEFAULT 0 ;
		FONT "FOXFONT", 10 ;
		VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.) .AND. GFUSERLIST()
	
	  @ 22.167,1.750 TO 22.167,63.125 ;
	    PEN 1, 8 ;
		 STYLE "1"
	
	  @ 22.250,1.875 TO 22.250,63.250 ;
	    PEN 1, 8 ;
		 STYLE "1" ;
		  COLOR RGB(255,255,255,255,255,255)
	
	IF llReLogIn .AND. !llOldVersn
	    @ 20.250,2.625 SAY 'Licensed exclusively to : '+gcCompName ;
		  SIZE 1.000,59.625 ;
		  FONT "MS Sans Serif", 10 ;
		   STYLE "B" ;
		  PICTURE "@I" ;
		  COLOR RGB(255,0,0,,,,)
	ENDIF 
	
	IF !llReLogIn
	    @ 27.500,2.625 SAY 'Licensed exclusively to : '+ gcCompName   ;
		  SIZE 1.000,59.625 ;
		  FONT "MS Sans Serif", 10 ;
		   STYLE "B" ;
		  PICTURE "@I" ;
		  COLOR RGB(255,0,0,,,,)
	ENDIF 
	
	lcWindNoGr = ''
	
	IF NOT WVISIBLE("gwdlog_in")
		ACTIVATE WINDOW gwdlog_in     
	ENDIF     
	
	READ CYCLE MODAL ;
		VALID _1sr0w39kh() ;
		ACTIVATE lfAriaAct() .AND. lfAct()
	
	  RELEASE WINDOW gwdlog_in
	
	#REGION 0
	
	SET READBORDER &rborder
	
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     SYLOGIN/Windows Cleanup Code               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	MODI WINDOW SCREEN ICON FILE ARIA.ICO

#ELIF   !(UPPER(RIGHT(VERSION(),3)) $ "WINDOWSMACUNIX")
	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                       MS-DOS Window definitions                
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
	IF NOT WEXIST("gwdlog_in") ;   
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.PJX";
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.SCX";      
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.MNX";      
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.PRG";
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.FRX";
		OR UPPER(WTITLE("GWDLOG_IN")) == "GWDLOG_IN.QPR"      
		DEFINE WINDOW gwdlog_in ;
			FROM  INT((SROW()-19)/2), INT((SCOL()-50)/2) ;
			TO  INT((SROW()-19)/2)+18, INT((SCOL()-50)/2)+49  ;
			FLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE ;
			   COLOR SCHEME 5
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                 SYLOGIN/MS-DOS Setup Code - SECTION 2          
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	*300271,1 get the number of users currently logged in
	lnCurUsers = gfUserList(.T.)
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     SYLOGIN/MS-DOS Screen Layout               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	IF WVISIBLE("gwdlog_in")
		ACTIVATE WINDOW gwdlog_in SAME
	    llSayCnt=.F.
	ELSE
		ACTIVATE WINDOW gwdlog_in NOSHOW
	    llSayCnt=.T.   
	ENDIF
	
	  @ 2,10 SAY "Product of Aria Systems, Inc." ;
		SIZE 1,29, 0
	
	  @ 5,15 SAY "All rights reserved" ;
		SIZE 1,19, 0
	
	  @ 7,5 SAY "User ID  :" ;
		SIZE 1,10, 0
	
	IF sycinst.linspassw
	    @ 9,5 SAY "Password :" ;
		  SIZE 1,10, 0
	ENDIF 
	
	  @ 1,9 SAY gcSysName ;
		SIZE 1,31 ;
		PICTURE "@I"
	
	  @ 4,19 GET ibDummi ;
	  	  PICTURE "@*IVN " ;
		  SIZE 1,1,1 ;
		  DEFAULT 0 ;
		WHEN _1sr0w39n9() ;
		VALID IIF(TYPE(VARREAD()) = 'D' , lfvY2K() , .T.)
	
	  @ 3,19 SAY gcAriaVer ;
		SIZE 1,11 ;
		PICTURE "@I"
	
	  @ 7,20 GET lcUser_ID ;
		SIZE 1,10 ;
		DEFAULT " " ;
		PICTURE "@!" ;
		WHEN llUsErChang ;
		  VALID lfvUsr_ID() ;
		   COLOR &gcReadClr,&gcReadClr
	
	IF sycinst.linspassw
	    @ 9,20 GET laUsr_Pass[1] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF sycinst.linspassw
	    @ 9,21 GET laUsr_Pass[2] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF sycinst.linspassw
	    @ 9,22 GET laUsr_Pass[3] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF sycinst.linspassw
	    @ 9,23 GET laUsr_Pass[4] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF sycinst.linspassw
	    @ 9,24 GET laUsr_Pass[5] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF sycinst.linspassw
	    @ 9,25 GET laUsr_Pass[6] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF sycinst.linspassw
	    @ 9,26 GET laUsr_Pass[7] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	IF sycinst.linspassw
	    @ 9,27 GET laUsr_Pass[8] ;
		  SIZE 1,1 ;
		  DEFAULT " " ;
		  PICTURE "@!" ;
		  WHEN lfwUsr_Pass() ;
		    VALID lfvUsr_Pass() ;
		     COLOR &gcReadClr,&gcReadClr
	ENDIF
	
	  @ 6,3 TO 10,33
	
	  @ 12,5 SAY "Maximum number of users : " ;
		SIZE 1,26, 0
	
	  @ 14,5 SAY "Currently logged users  :" ;
		SIZE 1,25, 0
	
	  @ 7,35 GET pbOk_Cncl ;
		  PICTURE "@*VN \!\<Ok;\<Cancel" ;
		  SIZE 1,10,1 ;
		  DEFAULT 1 ;
		WHEN lfwOk_Cncl() ;
		  VALID lfvOK_CNCL()
	
	  @ 6,34 TO 10,45
	
	  @ 11,3 TO 15,45
	
	  @ 12,31 GET gnMaxUsers ;
		SIZE 1,3 ;
		DEFAULT 0 ;
		PICTURE "999" ;
		WHEN .F. ;
		   COLOR &gcReadClr,&gcReadClr
	
	  @ 14,31 GET lnCurUsers ;
		SIZE 1,3 ;
		DEFAULT 0 ;
		PICTURE "999" ;
		WHEN .F. ;
		   COLOR &gcReadClr,&gcReadClr
	
	  @ 14,35 GET pbWho ;
		  PICTURE "@*HN \<WHO" ;
		  SIZE 1,10,1 ;
		  DEFAULT 1 ;
		  VALID GFUSERLIST()
	
	  @ 4,3 SAY "(c) Copyright 1990 - 1996 Aria Systems Inc." ;
		SIZE 1,43, 0
	
	lcWindNoGr = ''
	
	IF NOT WVISIBLE("gwdlog_in")
		ACTIVATE WINDOW gwdlog_in     
	ENDIF     
	
	READ CYCLE MODAL ;
		VALID _1sr0w39p7() ;
		ACTIVATE _1sr0w39p8()
	
	  RELEASE WINDOW gwdlog_in
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	

#ENDIF
   

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1SR0W39FZ           ibDummi WHEN                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SYLOGIN,     Record Number:    2   
*        Variable:            ibDummi                            
*        Called By:           WHEN Clause                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*























FUNCTION _1sr0w39fz     &&  ibDummi WHEN
#REGION 1
glDoprog = "01"
RETURN .F.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1SR0W39KH           Read Level Valid                   
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SYLOGIN                            
*        Called By:           READ Statement                     
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1sr0w39kh     && Read Level Valid
*
* Valid Code from screen: SYLOGIN
*
#REGION 1
IF LASTKEY() = 27
  HIDE WINDOW gwdlog_in
  IF !glReLogIn
    IF gfModalgen("QRM00013B00008","DIALIG") = 1
      ACTIVATE WINDOW  gwdlog_in
      RETURN .F.
    ENDIF
  ENDIF
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFARIAACT           Read Level Activate                 
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SYLOGIN                            
*        Called By:           READ Statement                     
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfAriaAct     && Read Level Activate
IF TYPE('lcWindNoGr') = 'C' AND !EMPTY(lcWindNoGr)
  DO CASE
    CASE WONTOP() $ lcWindNoGr
      MODIFY WINDOW (WONTOP()) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WONTOP())
    CASE WPARENT(WONTOP()) $ lcWindNoGr
      MODIFY WINDOW (WPARENT(WONTOP())) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WPARENT(WONTOP()))
  ENDCASE
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFVY2K           Valid 1900 year                        
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SYLOGIN                            
*        Called By:           READ Statement                     
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1SR0W39N9           ibDummi WHEN                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SYLOGIN,     Record Number:   68   
*        Variable:            ibDummi                            
*        Called By:           WHEN Clause                        
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*























FUNCTION _1sr0w39n9     &&  ibDummi WHEN
#REGION 1
glDoprog = "01"
RETURN .F.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1SR0W39P7           Read Level Valid                   
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SYLOGIN                            
*        Called By:           READ Statement                     
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1sr0w39p7     && Read Level Valid
*
* Valid Code from screen: SYLOGIN
*
#REGION 1
IF LASTKEY() = 27
  HIDE WINDOW gwdlog_in
  IF !glReLogIn
    IF gfModalgen("QRM00013B00008","DIALIG") = 1
      ACTIVATE WINDOW  gwdlog_in
      RETURN .F.
    ENDIF
  ENDIF
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFVY2K           Valid 1900 year                        
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         SYLOGIN                            
*        Called By:           READ Statement                     
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)
*
* Activate Code from screen: SYLOGIN
*
FUNCTION _1sr0w39p8
#REGION 1
*300271,1 Deactivate the who button if the number of users = 0
IF lnCurUsers = 0
  SHOW GET pbWho DISABLE
ENDIF
*300271,1 Deactivate the OK button if the number of users = max no. of users
IF lnCurUsers = gnMaxUsers .AND. !glReLogIn
  SHOW GET pbOk_Cncl,1 DISABLE
ENDIF




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*          SYLOGIN/MS-DOS Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                        SYLOGIN Function LFACT                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION LFACT
IF !llReLogIn
  lnStartSnd = Eval(sys(2)) + 3
  Do While .T.
    IF Eval(sys(2)) = lnStartSnd
      EXIT
    ENDIF
  ENDDO
  llRet_flag = .T.
ENDIF

*300271,1 Deactivate the who button if the number of users = 0
*B606532,1 ABD - Relogin in case we didn't requierd the Logain. [Begin]
*IF lnCurUsers = 0
IF lnCurUsers = 0 .OR. !glLog_Requ
  SHOW GET pbWho DISABLE
  *B606532,1 ABD - [End]
ENDIF
*300271,1 Deactivate the OK button if the number of users = max no. of users
IF lnCurUsers = gnMaxUsers .AND. !glReLogIn
  SHOW GET pbOk_Cncl,1 DISABLE
ENDIF

