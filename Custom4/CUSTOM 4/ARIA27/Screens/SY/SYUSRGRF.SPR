*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        09/05/2006           SYUSRGRF.SPR              14:58:30 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 2006 ARIA SYSTEMS                         
*        48 - 7 st                                               
*        CAIRO - EGYPT,     Zip                                  
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                SYUSRGRF/Windows Setup Code - SECTION 1         
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
PRIVATE lcGraphFile,lcGrPhScr,lcGrfDisp,lcGrfBtns,lcGrfcntr,llByRow,lnGraph,cbByRow,cbBycol,lcFields,pbGrphtyp,pbPopGrf,pbOk,pbCancel,lcGraphVr,lcDispGrf,laSource,laTarget,lcGrfMove,lcTxtField
DIMEN laTarget[1],laSource[1]
PRIVATE ALL LIKE CBGRF*
STORE 0 TO pbGrphtyp,pbPopGrf,pbOk,pbCancel,pbSettings
lcGraphVr = 'SCREEN'
lcGrPhScr = SYS(2015)
lcGrfDisp = SYS(2015)
lcDispGrf = SYS(2015)
lcGrfBtns = SYS(2015)
lcGrfcntr = SYS(2015)
lcGrfMove = SYS(2015)
lcGraphFile = 'X'+RIGHT(SYS(2015),7)
llByRow = IIF(TYPE('llRow')#'L',.T.,llRow)
lnGraph = IIF(TYPE('lnTypGraph')#'N',8,lnTypGraph)
cbByRow = llByRow
cbByCol = !llByRow
lcPrompt = 'GRAPH'+ALLT(STR(lnGraph))+'.BMP'
lcFields = lcFieldsGrf
=gfSubStr(lcFields,@laTarget)
=gfSubStr(lcGenrlGrf,@laSource)
lcTxtField = laTarget[1]
=ADEL(laTarget,1)
DIMEN laTarget[ALEN(laTarget)-1]
=ADEL(laSource,1)
laSource[ALEN(laSource)] = 'Expression'
lcGrfRead = 'WITH '+lcGrPhScr
IF !EMPTY(lcFields)
  =GETGRF(gcWorkDir+lcGraphFile,lnGraph,lcFields,llByRow)
ENDIF
FOR lnCount = 1 TO 14
  lcvarName = 'CBGRF'+ALLT(STR(lnCount))
  &lcVarName = .F.
ENDFOR
lcvarName = 'CBGRF'+ALLT(STR(lnGraph))
&lcvarName = .T.
IF lcGraphVr <> 'SCREEN'
  MODIFY WINDOW (lcGrPhScr) NONE NOMINI NOCLOSE NOFLOAT
ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

m.rborder = SET("READBORDER")
SET READBORDER ON

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      Windows Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

lcIcon = IIF(FILE("ARIA.ICO"),[ICON FILE "ARIA.ICO"],"")
IF NOT WEXIST((lcgrphscr)) ;   
	OR UPPER(WTITLE((LCGRPHSCR))) == LCGRPHSCR+".PJX";
	OR UPPER(WTITLE((LCGRPHSCR))) == LCGRPHSCR+".SCX";      
	OR UPPER(WTITLE((LCGRPHSCR))) == LCGRPHSCR+".MNX";
	OR UPPER(WTITLE((LCGRPHSCR))) == LCGRPHSCR+".PRG";
	OR UPPER(WTITLE((LCGRPHSCR))) == LCGRPHSCR+".FRX";
	OR UPPER(WTITLE((LCGRPHSCR))) == LCGRPHSCR+".QPR"
	lcGrow = ''
	IF _WINDOWS 
	  lcGrow = IIF(RIGHT(OS(1),2)='95','GROW','')
	ENDIF
	DEFINE WINDOW (lcgrphscr) ;
		AT 0.000, 0.000 ;
		SIZE 28.923,118.800 ;
		FONT "MS Sans Serif", 8 ;
		FLOAT ;
		NOCLOSE ;
		MINIMIZE ;
		SYSTEM ;
		&lcIcon ;
		IN WINDOW (LCGRAPHVR) &LCGROW
	MOVE WINDOW (lcgrphscr) CENTER
ENDIF

IF NOT WEXIST((lcdispgrf)) ;   
	OR UPPER(WTITLE((LCDISPGRF))) == LCDISPGRF+".PJX";
	OR UPPER(WTITLE((LCDISPGRF))) == LCDISPGRF+".SCX";      
	OR UPPER(WTITLE((LCDISPGRF))) == LCDISPGRF+".MNX";
	OR UPPER(WTITLE((LCDISPGRF))) == LCDISPGRF+".PRG";
	OR UPPER(WTITLE((LCDISPGRF))) == LCDISPGRF+".FRX";
	OR UPPER(WTITLE((LCDISPGRF))) == LCDISPGRF+".QPR"
	DEFINE WINDOW (lcdispgrf) ;
		AT 2.250, 56.250 ;
		SIZE 20.000,60.000 ;
		TITLE "Graph" ;
		FONT "MS Sans Serif", 8 ;
		NOFLOAT ;
		CLOSE ;
		NOMINIMIZE ;
		SYSTEM ;
		&lcIcon ;
		IN WINDOW (LCGRPHSCR)
ENDIF

IF NOT WEXIST((lcgrfcntr)) ;   
	OR UPPER(WTITLE((LCGRFCNTR))) == LCGRFCNTR+".PJX";
	OR UPPER(WTITLE((LCGRFCNTR))) == LCGRFCNTR+".SCX";      
	OR UPPER(WTITLE((LCGRFCNTR))) == LCGRFCNTR+".MNX";
	OR UPPER(WTITLE((LCGRFCNTR))) == LCGRFCNTR+".PRG";
	OR UPPER(WTITLE((LCGRFCNTR))) == LCGRFCNTR+".FRX";
	OR UPPER(WTITLE((LCGRFCNTR))) == LCGRFCNTR+".QPR"
	DEFINE WINDOW (lcgrfcntr) ;
		AT 0.250, 0.000 ;
		SIZE 2.077,46.400 ;
		FONT "MS Sans Serif", 8 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		&lcIcon ;
		IN WINDOW (LCGRPHSCR)
ENDIF

IF NOT WEXIST((lcgrfmove)) ;   
	OR UPPER(WTITLE((LCGRFMOVE))) == LCGRFMOVE+".PJX";
	OR UPPER(WTITLE((LCGRFMOVE))) == LCGRFMOVE+".SCX";      
	OR UPPER(WTITLE((LCGRFMOVE))) == LCGRFMOVE+".MNX";
	OR UPPER(WTITLE((LCGRFMOVE))) == LCGRFMOVE+".PRG";
	OR UPPER(WTITLE((LCGRFMOVE))) == LCGRFMOVE+".FRX";
	OR UPPER(WTITLE((LCGRFMOVE))) == LCGRFMOVE+".QPR"
	DEFINE WINDOW (lcgrfmove) ;
		AT 2.250, 0.625 ;
		SIZE 22.077,54.200 ;
		FONT "MS Sans Serif", 8 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		&lcIcon ;
		IN WINDOW (LCGRPHSCR)
ENDIF

IF NOT WEXIST("_1sr0w3hem")
	DEFINE WINDOW _1sr0w3hem ;
		AT 25.000, 0.625 ;
		SIZE 2.846,95.800 ;
		FONT "MS Sans Serif", 8 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		NONE ;
		&lcIcon ;
		IN WINDOW (LCGRPHSCR)
ENDIF

IF NOT WEXIST((lcgrfdisp)) ;   
	OR UPPER(WTITLE((LCGRFDISP))) == LCGRFDISP+".PJX";
	OR UPPER(WTITLE((LCGRFDISP))) == LCGRFDISP+".SCX";      
	OR UPPER(WTITLE((LCGRFDISP))) == LCGRFDISP+".MNX";
	OR UPPER(WTITLE((LCGRFDISP))) == LCGRFDISP+".PRG";
	OR UPPER(WTITLE((LCGRFDISP))) == LCGRFDISP+".FRX";
	OR UPPER(WTITLE((LCGRFDISP))) == LCGRFDISP+".QPR"
	DEFINE WINDOW (lcgrfdisp) ;
		AT 0.000, 0.000 ;
		SIZE 20.000,60.000 ;
		FONT "MS Sans Serif", 8 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		&lcIcon
ENDIF

IF NOT WEXIST((lcgrfbtns)) ;   
	OR UPPER(WTITLE((LCGRFBTNS))) == LCGRFBTNS+".PJX";
	OR UPPER(WTITLE((LCGRFBTNS))) == LCGRFBTNS+".SCX";      
	OR UPPER(WTITLE((LCGRFBTNS))) == LCGRFBTNS+".MNX";
	OR UPPER(WTITLE((LCGRFBTNS))) == LCGRFBTNS+".PRG";
	OR UPPER(WTITLE((LCGRFBTNS))) == LCGRFBTNS+".FRX";
	OR UPPER(WTITLE((LCGRFBTNS))) == LCGRFBTNS+".QPR"
	DEFINE WINDOW (lcgrfbtns) ;
		AT 1.917, 0.625 ;
		SIZE 13.077,10.400 ;
		FONT "MS Sans Serif", 8 ;
		NOFLOAT ;
		NOCLOSE ;
		NOMINIMIZE ;
		&lcIcon ;
		IN WINDOW (LCGRPHSCR)
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                SYUSRGRF/Windows Setup Code - SECTION 2         
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
DO WHILE !llTerminate
  lcFuncToProc = ''


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                SYUSGRF1/Windows Setup Code - SECTION 2         
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                SYUSGRF4/Windows Setup Code - SECTION 2         
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 7

lcGrfBmp1  = gcBmpHome + 'GRAPH1.BMP'
lcGrfBmp2  = gcBmpHome + 'GRAPH2.BMP'
lcGrfBmp3  = gcBmpHome + 'GRAPH3.BMP'
lcGrfBmp4  = gcBmpHome + 'GRAPH4.BMP'
lcGrfBmp5  = gcBmpHome + 'GRAPH5.BMP'
lcGrfBmp6  = gcBmpHome + 'GRAPH6.BMP'
lcGrfBmp7  = gcBmpHome + 'GRAPH7.BMP'
lcGrfBmp8  = gcBmpHome + 'GRAPH8.BMP'
lcGrfBmp9  = gcBmpHome + 'GRAPH9.BMP'
lcGrfBmp10 = gcBmpHome + 'GRAPH10.BMP'
lcGrfBmp11 = gcBmpHome + 'GRAPH11.BMP'
lcGrfBmp12 = gcBmpHome + 'GRAPH12.BMP'
lcGrfBmp13 = gcBmpHome + 'GRAPH13.BMP'
lcGrfBmp14 = gcBmpHome + 'GRAPH14.BMP'

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SYUSRGRF/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE((lcgrphscr))   
	ACTIVATE WINDOW (lcgrphscr) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcgrphscr) NOSHOW
    llSayCnt=.T.   
ENDIF

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SYUSGRF1/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2
IF WVISIBLE((lcdispgrf))   
	ACTIVATE WINDOW (lcdispgrf) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcdispgrf) NOSHOW
    llSayCnt=.T.   
ENDIF

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SYUSGRF2/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 3
IF WVISIBLE((lcgrfcntr))   
	ACTIVATE WINDOW (lcgrfcntr) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcgrfcntr) NOSHOW
    llSayCnt=.T.   
ENDIF

  @ 0.000,12.000 GET pbGrphtyp ;
	  PICTURE "@*BHN " + ;
		  lcPrompt ;
	  SIZE 1.923,7.400,0.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8

  @ 0.000,19.200 GET pbPopGrf ;
	  PICTURE "@*BHN " + ;
		  (LOCFILE("bmps\down.bmp","BMP|ICO","Where is down?")) ;
	  SIZE 1.923,3.200,0.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	  VALID lfActGrfPop()

  @ 0.000,23.800 GET cbByCol ;
	  PICTURE "@*CB " + ;
		  (LOCFILE("bmps\bycol.bmp","BMP|ICO","Where is bycol?")) ;
	  SIZE 1.923,5.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfByRow() ;
	MESSAGE "By Column"

  @ 0.000,30.000 GET cbByrow ;
	  PICTURE "@*CB " + ;
		  (LOCFILE("bmps\byrow.bmp","BMP|ICO","Where is byrow?")) ;
	  SIZE 1.923,5.800 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfByRow() ;
	MESSAGE "By Row"

  @ 0.000,38.400 GET pbsave ;
	  PICTURE "@*BHN " + ;
		  (LOCFILE("bmps\save1.bmp","BMP|ICO","Where is save1?")) ;
	  SIZE 1.923,5.800,0.800 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	  VALID _1sr0w3hl7()

  @ 0.000,0.800 GET pbFilter ;
	  PICTURE "@*HN Filter..." ;
	  SIZE 1.769,7.833,0.667 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID _1sr0w3hlr()

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SYUSGRF5/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 4
IF WVISIBLE((lcgrfmove))   
	ACTIVATE WINDOW (lcgrfmove) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcgrfmove) NOSHOW
    llSayCnt=.T.   
ENDIF

  @ 1.000,2.200 GET pusource ;
 	  PICTURE "@&N" ;
	  FROM laSource ;
	  SIZE 12.692,21.400 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	  VALID lfvMove()

  @ 0.846,1.800 TO 0.846,24.200 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 13.846,2.000 TO 13.846,24.200 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.923,1.800 TO 13.923,1.800 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.923,23.800 TO 13.923,23.800 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 1.000,31.000 GET puTarget ;
 	  PICTURE "@&N" ;
	  FROM laTarget ;
	  SIZE 12.692,21.400 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	  VALID lfvRemove()

  @ 0.846,30.600 TO 0.846,52.800 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 13.846,30.800 TO 13.846,52.800 ;
    PEN 2, 8 ;
	 STYLE "1" ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.923,30.600 TO 13.923,30.600 ;
    PEN 2, 8 ;
	  COLOR RGB(128,128,128,128,128,128)

  @ 0.923,52.600 TO 13.923,52.600 ;
    PEN 2, 8 ;
	  COLOR RGB(255,255,255,255,255,255)

  @ 0.154,0.600 TO 21.769,53.800 ;
    PEN 1, 8

  @ 0.231,0.800 TO 21.846,54.000 ;
    PEN 1, 8 ;
	  COLOR RGB(255,255,255,,,,)

  @ 15.769,5.400 GET pbMove ;
	  PICTURE "@*VN \<Move" ;
	  SIZE 1.769,12.500,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 9 ;
	 STYLE "B" ;
	  VALID lfvMove()

  @ 15.769,34.400 GET pbAll ;
	  PICTURE "@*VN Move \<all" ;
	  SIZE 1.769,12.500,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvMove(.T.)

  @ 18.538,34.400 GET pbRAll ;
	  PICTURE "@*VN Rem\<ove all" ;
	  SIZE 1.769,12.500,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvRemove(.T.)

  @ 18.538,5.400 GET pbRemove ;
	  PICTURE "@*VN \<Remove" ;
	  SIZE 1.769,12.500,1.000 ;
	  DEFAULT 1 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "B" ;
	  VALID lfvRemove()

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SYUSGRF3/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 5
IF WVISIBLE("_1sr0w3hem")
	ACTIVATE WINDOW _1sr0w3hem SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW _1sr0w3hem NOSHOW
    llSayCnt=.T.   
ENDIF

IF lcGraphVr='SCREEN'
    @ 0.000,21.600 GET PBOK ;
	    PICTURE "@*BHT " + ;
		    (LOCFILE("bmps\ok.bmp","BMP|ICO","Where is ok?")) ;
	    SIZE 2.615,15.200,0.800 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	    VALID lfClsGraph()
ENDIF

IF lcGraphVr='SCREEN'
    @ 0.077,52.800 GET PBCANCEL ;
	    PICTURE "@*BHT " + ;
		    (LOCFILE("bmps\can.bmp","BMP|ICO","Where is can?")) ;
	    SIZE 2.615,15.200,0.800 ;
	    DEFAULT 1 ;
	  FONT "MS Sans Serif", 8 ;
	    VALID _1sr0w3hom()
ENDIF

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    GRFDISP1/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 6
IF WVISIBLE((lcgrfdisp))   
	ACTIVATE WINDOW (lcgrfdisp) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcgrfdisp) NOSHOW
    llSayCnt=.T.   
ENDIF

lcWindNoGr = ''




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                    SYUSGRF4/Windows Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 7
IF WVISIBLE((lcgrfbtns))   
	ACTIVATE WINDOW (lcgrfbtns) SAME
    llSayCnt=.F.
ELSE
	ACTIVATE WINDOW (lcgrfbtns) NOSHOW
    llSayCnt=.T.   
ENDIF

  @ 0.000,0.000 GET CBGRF1 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp1 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 0.000,5.200 GET CBGRF7 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp7 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 1.846,0.000 GET CBGRF2 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp2 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 1.846,5.200 GET CBGRF8 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp8 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 3.692,0.000 GET CBGRF3 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp3 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 3.692,5.200 GET CBGRF9 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp9 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 5.538,0.000 GET CBGRF4 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp4 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 5.538,5.200 GET CBGRF10 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp10 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 7.385,0.000 GET CBGRF5 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp5 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 7.385,5.200 GET CBGRF11 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp11 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 9.231,0.000 GET CBGRF6 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp6 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 9.231,5.200 GET CBGRF12 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp12 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 11.154,0.000 GET CBGRF13 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp13 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

  @ 11.154,5.200 GET CBGRF14 ;
	  PICTURE "@*CB " + ;
		  lcGrfBmp14 ;
	  SIZE 1.923,5.200 ;
	  DEFAULT 0 ;
	FONT "MS Sans Serif", 8 ;
	 STYLE "T" ;
	  VALID lfGrfType()

lcWindNoGr = ''

IF NOT WVISIBLE((lcgrfbtns))
	ACTIVATE WINDOW (lcgrfbtns) NOSHOW
ENDIF
IF NOT WVISIBLE((lcgrfdisp))
	ACTIVATE WINDOW (lcgrfdisp) NOSHOW
ENDIF
IF NOT WVISIBLE("_1sr0w3hem")
	ACTIVATE WINDOW _1sr0w3hem 
ENDIF
IF NOT WVISIBLE((lcgrfmove))
	ACTIVATE WINDOW (lcgrfmove) 
ENDIF
IF NOT WVISIBLE((lcgrfcntr))
	ACTIVATE WINDOW (lcgrfcntr) 
ENDIF
IF NOT WVISIBLE((lcdispgrf))
	ACTIVATE WINDOW (lcdispgrf) 
ENDIF
IF NOT WVISIBLE((lcgrphscr))
  MODIFY WINDOW  (lcgrphscr) NOGROW              
	ACTIVATE WINDOW (lcgrphscr) 
ENDIF



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*           WindowsREAD contains clauses from SCREEN syusrgrf    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

READ CYCLE MODAL ;
	ACTIVATE lfAriaAct() ;
	SHOW lfGraphShow() ;
	&LCGRFREAD

IF llTerminate
  RELEASE WINDOW _1sr0w3hem
  RELEASE WINDOW (lcdispgrf)
  RELEASE WINDOW (lcgrfbtns)
  RELEASE WINDOW (lcgrfcntr)
  RELEASE WINDOW (lcgrfdisp)
  RELEASE WINDOW (lcgrfmove)
  RELEASE WINDOW (lcgrphscr)
ENDIF &&llTerminate

#REGION 0

SET READBORDER &rborder

IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     SYUSRGRF/Windows Cleanup Code              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
  IF !EMPTY(lcFuncToProc)
    DO &lcFuncToProc
    lcFuncToProc = ''
  ENDIF
ENDDO

RELEASE WINDOW (lcGrfDisp)
IF USED(lcGraphFile)
  USE IN (lcGraphFile)
ENDIF
ERASE (gcWorkDir+lcGraphFile+'.DBF')
ERASE (gcWorkDir+lcGraphFile+'.FPT')



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*         SYUSRGRF/Windows Supporting Procedures and Functions   
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
FUNCTION lfGrfType
lnBtnNum = STRTRAN(VARREAD(),'CBGRF')
_CUROBJ = 1
HIDE WINDOW (lcGrfBtns)
IF VAL(lnBtnNum) <> lnGraph
  lcvarName = 'CBGRF'+ALLT(STR(lnGraph))
  &lcvarName = .F.
  SHOW GET (lcvarName)
  lnGraph = VAL(lnBtnNum)
  SHOW GET pbGrphtyp,1 PROMPT 'GRAPH'+ALLT(STR(lnGraph))+'.BMP'
   =lfGraphShow()
ELSE
  lcvarName = 'CBGRF'+lnBtnNum
  &lcvarName = .T.
  SHOW GET (lcvarName)
ENDIF


FUNCTION lfByRow
IF EVAL(VARREAD()) = .F.
  lcVarName = VARREAD()
  &lcVarName = .T.
  SHOW GET (lcVarName)
ELSE
  IF VARREAD() = 'CBBYROW'
    llByRow = .T.
  ELSE
    llByRow = .F.
  ENDIF
  cbByRow = llByRow
  cbByCol = !llByRow
  SHOW GET cbByRow
  SHOW GET cbByCOL
  =lfGraphShow()
ENDIF

FUNCTION lfActGrfPop
lcVarName = 'CBGRF'+ALLT(STR(lnGraph))
_CUROBJ = OBJNUM(&lcVarName)

FUNCTION lfClsGraph
llRow = llByRow
lnTypGraph = lnGraph
lcFieldsGrf = lcFields
llReturn = .T.
llTerminate = .T.


FUNCTION lfGraphShow
PRIVATE lnAlisNum
IF !EMPTY(lcFields)
  lnAlisNum = SELECT()
  SELECT (ALLT(lcGraphAlis))
  RELEASE WINDOW (lcGraphFile+'.OLEGRAPH')
  =GETGRF(gcWorkDir+lcGraphFile,lnGraph,lcFields,llByRow)
  MODIFY GENERAL &lcGraphFile..OLEGRAPH NOMODIFY NOWAIT WINDOW (lcGrfDisp) IN WINDOW (lcDispGrf)
  SELECT (lnAlisNum)
ELSE
    RELEASE WINDOW (lcGraphFile+'.OLEGRAPH')
ENDIF

FUNCTION lfvMove
PARAMETERS llAll
PRIVATE llAll,lnCount
llAll = IIF(TYPE('llAll')#'L',.F.,llAll)
IF llAll
    FOR lnCount = 1 TO ALEN(laSource)-1
      puSource = lnCount
      lcFldName = laSource[lnCount]
      IF lfASCAN(@laTarget,lcFldName)= 0
        PRIVATE lcFldName
        IF !EMPTY(lcFldName)
          IF !EMPTY(laTarget[1])
            DIMEN laTarget[ALEN(laTarget)+1]
          ENDIF
          laTarget[ALEN(laTarget)] = lcFldName
          SHOW GET PUTARGET
        ENDIF
      ENDIF
    ENDFOR
    =lfMakeField()
ELSE
  IF UPPER(laSource[puSource]) = 'EXPRESSION'
    PRIVATE laFldHed,laFldNm
    DIMEN laFldHed[1],laFldNm[1]
    =ACOPY(laSource,laFldHed)
    DIMEN laFldHed[ALEN(laFldHed)-1]
    DIMEN laFldNm[ALEN(laFldHed)]
    =ACOPY(laFldHed,laFldNm)
    lcFldName =GETEXPR('','','Graph Exp.','laFldHed',@laFldNm,.f.,'N')
    IF !EMPTY(lcFldName)
      lcDesc = ''
      DO SYEXPDSC.spr WITH lcFldName
      lcFldName = lcFldName + ' AS '+lcDesc
    ENDIF
  ELSE
    lcFldName = laSource[puSource]
  ENDIF
  IF lfASCAN(@laTarget,lcFldName)= 0
    PRIVATE lcFldName
    IF !EMPTY(lcFldName)
      IF !EMPTY(laTarget[1])
        DIMEN laTarget[ALEN(laTarget)+1]
      ENDIF
      laTarget[ALEN(laTarget)] = lcFldName
      SHOW GET PUTARGET
      =lfMakeField()
    ENDIF
  ENDIF
ENDIF

FUNCTION lfvRemove
PARAMETERS llAll
llAll = IIF(TYPE('llAll')#'L',.F.,llAll)
IF llAll
    DIMEN laTarget[1]
    laTarget[1] = ''
ELSE
  IF ALEN(laTarget) > 1
    =ADEL(laTarget,puTarget)
    DIMEN laTarget[ALEN(laTarget)-1]
  ELSE
    laTarget[1] = ''
  ENDIF
ENDIF
SHOW GET puTarget
=lfMakeField()


FUNCTION lfMakeField
lcFields = ''
IF !EMPTY(laTarget[1])
  lcFields = lcTxtField
  FOR lnCount = 1 TO ALEN(laTarget)
    lcFields = lcFields +','+ laTarget[lnCount]
  ENDFOR
ENDIF
=lfGraphShow()


FUNCTION lfAscan
PARAMETERS laArray,lcValue
PRIVATE lnFound,lnCount
lnFound = 0
FOR lnCount = 1 TO ALEN(laArray)
  IF laArray[lnCount] == lcValue
    lnFound = lnCount
    EXIT
  ENDIF
ENDFOR
RETURN lnFound


FUNCTION lfGrfSave
STORE .F. TO llOGRepFlt,llOGSetDef,llOGAccByAll
STORE '' TO lcOGFltDes,lcOGRepFlt

lcOGSelect=SELECT()

IF !USED('SYURPFLT')
  SELECT 0
  USE &gcSysHome.SYURPFLT ORDER 1
  llOGRepFlt=.T.
ELSE
  SELECT SYURPFLT
ENDIF
lcOGRepFlt = ''
IF !EMPTY(lcOGRepFlt)
  IF SEEK(ALLTRIM(lcGraphType)+gcUser_ID+lcOGRepFlt)
    lcOGFltDes=cFltr_Des
    llOGSetDef=lDefault
  ENDIF
ENDIF

DO syOGSave.spr

SELECT(lcOGSelect)
IF _DOS
  SHOW GETS OFF
ELSE
  SHOW GETS ONLY
ENDIF




FUNCTION lfvSave

IF (!EMPTY(lcOGRepFlt) AND !EMPTY(lcOGFltDes))
  llCanSeek=SEEK(ALLTRIM(lcGraphType)+PADR(gcUser_ID,LEN(CUSER_ID))+PADR(lcOGRepFlt,4))
  IF llCanSeek
    ** CONFIRM OVERWRITING
    IF gfModalGen("INM00254B00006",'ALERT') = 2
      _CUROBJ = OBJNUM(lcOGRepFlt)
      RETURN
    ENDIF
    IF llOGSetDef
      REPLACE ALL lDefault WITH .F.;
          FOR CREP_ID = lcGraphType;
            AND CUSER_ID = gcUser_ID
    ENDIF
    =SEEK(ALLTRIM(lcGraphType)+PADR(gcUser_ID,LEN(CUSER_ID))+PADR(lcOGRepFlt,4))
  ELSE
    IF llOGSetDef
      REPLACE ALL lDefault WITH .F.;
          FOR CREP_ID = lcGraphType;
            AND CUSER_ID = gcUser_ID
    ENDIF
    APPEND BLANK
  ENDIF
  REPLACE CREP_ID WITH lcGraphType;
          cUser_ID WITH gcUser_ID;
          cFltr_ID WITH lcOGRepFlt;
          lDefault WITH llOGSetDef;
          lAccByAll WITH llOGAccByAll;
          cfltr_des WITH lcOGFltDes;
          lSys_Data WITH .F.

    PRIVATE llGraphicR,lcGraphicF,lnGraphicType
    llGraphicR= llByRow
    lcGraphicF = lcFields
    lnGraphicT = lnGraph
    SAVE TO MEMO MUSRDVAR ALL LIKE L?GRAPHIC?
    SAVE TO MEMO MREPHDFLT ALL LIKE laGraphFlt
    CLEAR READ
ENDIF


FUNCTION lfOGSaveShow
IF (!EMPTY(lcOGRepFlt) AND !EMPTY(lcOGFltDes))
  SHOW GET pbSave ENABLE
ELSE
  SHOW GET pbSave DISABLE
ENDIF


FUNCTION lfGetFlt
PRIVATE laFldHed,laFldNm
DIMEN laFldHed[1],laFldNm[1]
=ACOPY(laSource,laFldHed)
=AINS(laFldHed,1)
laFldHed[1] = lcTxtField
FOR lnCount = 1 TO ALEN(laFldHed)
  laFldHed[lnCount] = UPPER(laFldHed[lnCount])
ENDFOR
*DIMEN laFldHed[ALEN(laFldHed)-1]
DIMEN laFldNm[ALEN(laFldHed)]
=ACOPY(laFldHed,laFldNm)
PRIVATE lnAlisNum,lcCursName,laFldStru
lnAlisNum = SELECT()
lcCursName = 'X'+RIGHT(SYS(3),7)
USE (gcSysHome+'SYREPUVR') AGAIN ALIAS (lcCursName) IN 0
SELECT (lcCursName)
=AFIELDS(laFldStru)
USE IN (lcCursName)
CREATE CURSOR &lcCursName FROM ARRAY laFldStru
INDEX ON ALLTRIM(crep_id) TAG CREP_ID

SELECT (ALLT(lcGraphAlis))
=AFIELDS(laFldStru)
SELECT (lcCursName)
FOR lnCount = 1 TO ALEN(laFldStru,1)
  APPEND BLANK
  REPLACE CREP_ID WITH lcGraphType,;
          mfld_name WITH UPPER(laFldStru[lnCount,1]),;
          cdata_typ WITH laFldStru[lnCount,2],;
          nfld_dec WITH laFldStru[lnCount,4],;
          nfld_wdth WITH laFldStru[lnCount,3],;
          CFLD_HEAD WITH laFldStru[lnCount,1]
ENDFOR
PRIVATE laScrMode
DIMEN laScrMode[5]
laScrMode[3] = .T.
=gfbfiltr('laGraphFlt',@laFldHed,@laFldNm,'R',lcGraphType,lcCursName)
USE IN (lcCursName)
SELECT (lnAlisNum)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1SR0W3HL7           pbsave VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SYUSGRF2,     Record Number:    6  
*        Variable:            pbsave                             
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1sr0w3hl7     &&  pbsave VALID
#REGION 3
lcFuncToProc='lfGrfSave'
CLEAR READ

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1SR0W3HLR           pbFilter VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SYUSGRF2,     Record Number:    7  
*        Variable:            pbFilter                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1sr0w3hlr     &&  pbFilter VALID
#REGION 3
lcFuncToProc='lfGetFlt'
CLEAR READ

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _1SR0W3HOM           PBCANCEL VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         SYUSGRF3,     Record Number:    3  
*        Variable:            PBCANCEL                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _1sr0w3hom     &&  PBCANCEL VALID
#REGION 5
llTerminate = .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFARIAACT           Read Level Activate                 
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         Multiple Screens                   
*        Called By:           READ Statement                     
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfAriaAct     && Read Level Activate
IF TYPE('lcWindNoGr') = 'C' AND !EMPTY(lcWindNoGr)
  DO CASE
    CASE WONTOP() $ lcWindNoGr
      MODIFY WINDOW (WONTOP()) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WONTOP())
    CASE WPARENT(WONTOP()) $ lcWindNoGr
      MODIFY WINDOW (WPARENT(WONTOP())) NOGROW
      lcWindNoGr = STRTRAN(lcWindNoGr,WPARENT(WONTOP()))
  ENDCASE
ENDIF

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        LFVY2K           Valid 1900 year                        
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         Multiple Screens                   
*        Called By:           READ Statement                     
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION lfvY2K     && Valid 1900 year
PRIVATE lcY2kCent , ldY2kDate , lcY2kObj , lnY2kIncr , lnY2KNew , lcY2KAlias
lcY2KAlias = SELECT(0)
SELECT 0
IF TYPE(SYS(18)) = 'U'
  SELECT (lcY2KAlias)
ENDIF
IF YEAR(EVALUATE(VARREAD())) <= 1930
  lcY2KCent = SET('CENT')
  SET CENT ON
  lcY2KObj     = SYS(18)
  lnY2KIncr    = YEAR(EVALUATE(VARREAD())) 
  lnY2KNew     = 2000+(lnY2KIncr/100-int(lnY2KIncr/100))*100
  ldY2KDate    = DTOC(EVALUATE(VARREAD()))
  ldY2KDate    = STRTRAN(ldY2KDate , ALLTRIM(STR(YEAR(EVALUATE(VARREAD())))) , ALLTRIM(STR(lnY2KNew)))
  ldY2KDate    = CTOD(ldY2KDate)
  &lcY2KObj    = ldY2KDate
  SET CENT &lcY2KCent
ENDIF
SELECT (lcY2KAlias)